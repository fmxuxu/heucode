2023-07-10 11:50:21 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='$home_dir/spanCL/data/datasets/$data_name', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_large_uncased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_large_uncased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers='384 384', n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 11:51:45 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='$home_dir/spanCL/data/datasets/$data_name', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_large_uncased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_large_uncased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers='384 384', n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 11:59:55 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='$home_dir/spanCL/data/datasets/$data_name', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_large_uncased_flair.emb.pkl', ent_lm_emb_path='ACE04.ent_bert_large_uncased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers='384 384', n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 12:24:56 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='$home_dir/spanCL/data/datasets/$data_name', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_large_uncased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_large_uncased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers='384 384', n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 12:25:41 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='$home_dir/spanCL/data/datasets/$data_name', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers='384 384', n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 12:27:46 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='$home_dir/spanCL/data/datasets/$data_name', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers='384 384', n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 18:31:07 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='$home_dir/spanCL/data/datasets/$data_name', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers='384 384', n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 18:36:10 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers='384 384', n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 18:36:12 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-10 18:36:12 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-10 18:36:12 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-10 18:36:12 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-10 18:37:26 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-10 18:38:25 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-10 18:38:26 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-10 18:41:34 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-10 18:41:34 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-10 18:56:18 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers='384 384', n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 18:56:19 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-10 18:56:19 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-10 18:56:19 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-10 18:56:19 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-10 18:57:23 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-10 18:58:22 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-10 18:58:24 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-10 18:59:34 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-10 18:59:34 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-10 19:00:26 | INFO | train | Using char encoder (char ids):   [Train] total=583519 unk=0 ratio=0.0%  [Valid] total=71514 unk=2 ratio=0.0%  [Test] total=79342 unk=0 ratio=0.0%
2023-07-10 19:00:27 | INFO | train | Using word encoder (word ids):   [Train] total=139524 unk=515 ratio=0.37%  [Valid] total=17150 unk=64 ratio=0.37%  [Test] total=18720 unk=69 ratio=0.37%
2023-07-10 19:05:49 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers='384 384', n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 19:05:55 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-10 19:05:55 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-10 19:05:55 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-10 19:05:55 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-10 19:05:55 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-10 19:05:55 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-10 19:05:55 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-10 19:05:59 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-10 19:05:59 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-10 19:06:15 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-10 19:06:16 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-10 19:14:22 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 19:14:23 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-10 19:14:23 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-10 19:14:23 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-10 19:14:23 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-10 19:14:23 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-10 19:14:23 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-10 19:14:23 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-10 19:14:24 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-10 19:14:24 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-10 19:14:35 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-10 19:14:36 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-10 19:14:39 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 19:14:39
2023-07-10 20:10:41 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 20:11:05 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 20:13:14 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 20:15:38 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 20:19:33 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace05/ACE05.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace05/ACE05.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace05/ACE05.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace05', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace05/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 20:21:23 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace05/ACE05.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace05/ACE05.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace05/ACE05.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace05', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace05/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 20:22:51 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 20:22:51 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 20:22:51 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 20:22:51 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 20:22:51 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 20:22:51 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 20:22:51 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 20:23:55 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 20:23:57 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 20:32:25 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 20:32:39 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=8 ratio=0.59%  [Valid] total=119 unk=6 ratio=5.04%  [Test] total=226 unk=1 ratio=0.44%
2023-07-10 20:36:48 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/41_18 2023-07-10 20:36:47
2023-07-10 20:43:09 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace05/ACE05.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace05/ACE05.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace05/ACE05.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace05', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace05/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 20:43:10 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 20:43:10 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 20:43:10 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 20:43:10 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 20:43:10 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 20:43:10 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 20:43:10 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 20:43:11 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 20:43:11 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 20:43:21 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 20:43:22 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=8 ratio=0.59%  [Valid] total=119 unk=6 ratio=5.04%  [Test] total=226 unk=1 ratio=0.44%
2023-07-10 20:43:25 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/41_18 2023-07-10 20:43:25
2023-07-10 20:52:18 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace05/ACE05.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace05/ACE05.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace05/ACE05.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace05', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace05/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 20:52:19 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 20:52:19 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 20:52:19 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 20:52:19 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 20:52:19 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 20:52:19 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 20:52:20 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 20:52:20 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 20:52:20 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 20:52:30 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 20:52:31 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=8 ratio=0.59%  [Valid] total=119 unk=6 ratio=5.04%  [Test] total=226 unk=1 ratio=0.44%
2023-07-10 20:52:34 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace05/nner_slg/41_18 2023-07-10 20:52:34
2023-07-10 20:54:05 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 20:59:57 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 20:59:57 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 20:59:57 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 20:59:57 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 20:59:57 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 20:59:57 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 20:59:57 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 20:59:57 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 20:59:58 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 20:59:58 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 21:00:09 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 21:00:10 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=157 ratio=11.53%  [Valid] total=119 unk=19 ratio=15.97%  [Test] total=226 unk=22 ratio=9.73%
2023-07-10 21:00:13 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 21:00:13
2023-07-10 21:03:07 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 21:03:08 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 21:03:08 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 21:03:08 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 21:03:08 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 21:03:08 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 21:03:08 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 21:03:08 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 21:03:08 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 21:03:08 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 21:03:19 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 21:03:20 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=157 ratio=11.53%  [Valid] total=119 unk=19 ratio=15.97%  [Test] total=226 unk=22 ratio=9.73%
2023-07-10 21:03:23 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 21:03:23
2023-07-10 21:05:50 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 21:05:50 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 21:05:50 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 21:05:50 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 21:05:50 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 21:05:50 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 21:05:50 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 21:05:50 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 21:05:51 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 21:05:51 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 21:06:02 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 21:06:03 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=157 ratio=11.53%  [Valid] total=119 unk=19 ratio=15.97%  [Test] total=226 unk=22 ratio=9.73%
2023-07-10 21:06:05 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 21:06:05
2023-07-10 21:11:08 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 21:11:09 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 21:11:09 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 21:11:09 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 21:11:09 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 21:11:09 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 21:11:09 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 21:11:09 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 21:11:09 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 21:11:09 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 21:11:21 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 21:11:21 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=157 ratio=11.53%  [Valid] total=119 unk=19 ratio=15.97%  [Test] total=226 unk=22 ratio=9.73%
2023-07-10 21:11:24 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 21:11:24
2023-07-10 21:12:29 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 21:12:43 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 21:12:43 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 21:12:43 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 21:12:43 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 21:12:43 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 21:12:43 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 21:12:43 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 21:12:58 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 21:12:58 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 21:13:29 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 21:13:32 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=157 ratio=11.53%  [Valid] total=119 unk=19 ratio=15.97%  [Test] total=226 unk=22 ratio=9.73%
2023-07-10 21:14:13 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 21:14:13
2023-07-10 21:26:26 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 21:26:27 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph/nodes.json ...
2023-07-10 21:26:27 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache/nodes.pkl ...
2023-07-10 21:26:27 | INFO | train | [Graph] entity-entity graph loads 10107 nodes.
2023-07-10 21:26:27 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph/edges.json ...
2023-07-10 21:27:45 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache/edges.pkl ...
2023-07-10 21:28:40 | INFO | train | [Graph] entity-entity graph loads 5650181 (one-way) edges.
2023-07-10 21:28:41 | INFO | train | [Graph] entity-entity graph keeps 42436 (bi-way) edges.
2023-07-10 21:31:29 | INFO | train | [Graph] span-entity graph loads 13230017 (one-way) edges.
2023-07-10 21:31:29 | INFO | train | [Graph] span-entity graph keeps 92019 (one-way) edges.
2023-07-10 21:32:20 | INFO | train | Using char encoder (char ids):   [Train] total=587510 unk=0 ratio=0.0%  [Valid] total=77564 unk=0 ratio=0.0%  [Test] total=75603 unk=0 ratio=0.0%
2023-07-10 21:32:20 | INFO | train | Using word encoder (word ids):   [Train] total=138196 unk=15330 ratio=11.09%  [Valid] total=18341 unk=1867 ratio=10.18%  [Test] total=18005 unk=1987 ratio=11.04%
2023-07-10 21:32:23 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 21:32:23
2023-07-10 21:34:00 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 21:34:01 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph/nodes.json ...
2023-07-10 21:34:01 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache/nodes.pkl ...
2023-07-10 21:34:01 | INFO | train | [Graph] entity-entity graph loads 10107 nodes.
2023-07-10 21:34:01 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph/edges.json ...
2023-07-10 21:35:09 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache/edges.pkl ...
2023-07-10 21:36:04 | INFO | train | [Graph] entity-entity graph loads 5650181 (one-way) edges.
2023-07-10 21:36:06 | INFO | train | [Graph] entity-entity graph keeps 42436 (bi-way) edges.
2023-07-10 21:36:21 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 21:36:21 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 21:36:21 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 21:36:21 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 21:36:21 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 21:36:21 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 21:36:21 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 21:36:21 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 21:36:22 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 21:36:22 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 21:36:33 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 21:36:34 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=157 ratio=11.53%  [Valid] total=119 unk=19 ratio=15.97%  [Test] total=226 unk=22 ratio=9.73%
2023-07-10 21:36:37 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 21:36:37
2023-07-10 21:40:40 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 21:40:41 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 21:40:41 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 21:40:41 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 21:40:41 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 21:40:41 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 21:40:41 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 21:40:41 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 21:40:41 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 21:40:41 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 21:40:53 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 21:40:54 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=157 ratio=11.53%  [Valid] total=119 unk=19 ratio=15.97%  [Test] total=226 unk=22 ratio=9.73%
2023-07-10 21:40:57 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 21:40:57
2023-07-10 21:56:40 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 21:56:41 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 21:56:41 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 21:56:41 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 21:56:41 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 21:56:41 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 21:56:41 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 21:56:41 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 21:56:41 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 21:56:41 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 21:56:53 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 21:56:54 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=157 ratio=11.53%  [Valid] total=119 unk=19 ratio=15.97%  [Test] total=226 unk=22 ratio=9.73%
2023-07-10 21:56:57 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 21:56:57
2023-07-10 22:00:05 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 22:00:07 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 22:00:07 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 22:00:07 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 22:00:07 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 22:00:07 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 22:00:07 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 22:00:07 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 22:00:07 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 22:00:07 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 22:00:15 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 22:00:16 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 22:00:16 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 22:00:16 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 22:00:16 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 22:00:16 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 22:00:16 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 22:00:16 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 22:00:16 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 22:00:16 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 22:00:28 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 22:00:28 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=157 ratio=11.53%  [Valid] total=119 unk=19 ratio=15.97%  [Test] total=226 unk=22 ratio=9.73%
2023-07-10 22:00:31 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 22:00:31
2023-07-10 22:02:04 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace05', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=104, max_ent_n_word=50, max_word_len=59, archi='nner_slg_ace05', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=134, wc_lstm_layers=1, test_n_words=17909, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 22:02:05 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/nodes.json ...
2023-07-10 22:02:05 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/nodes.pkl ...
2023-07-10 22:02:05 | INFO | train | [Graph] entity-entity graph loads 176 nodes.
2023-07-10 22:02:05 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace05/Graph-debug/edges.json ...
2023-07-10 22:02:05 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace05/cache-debug/edges.pkl ...
2023-07-10 22:02:05 | INFO | train | [Graph] entity-entity graph loads 838 (one-way) edges.
2023-07-10 22:02:05 | INFO | train | [Graph] entity-entity graph keeps 104 (bi-way) edges.
2023-07-10 22:02:05 | INFO | train | [Graph] span-entity graph loads 83691 (one-way) edges.
2023-07-10 22:02:05 | INFO | train | [Graph] span-entity graph keeps 329 (one-way) edges.
2023-07-10 22:02:17 | INFO | train | Using char encoder (char ids):   [Train] total=5773 unk=0 ratio=0.0%  [Valid] total=482 unk=0 ratio=0.0%  [Test] total=936 unk=11 ratio=1.18%
2023-07-10 22:02:17 | INFO | train | Using word encoder (word ids):   [Train] total=1362 unk=157 ratio=11.53%  [Valid] total=119 unk=19 ratio=15.97%  [Test] total=226 unk=22 ratio=9.73%
2023-07-10 22:02:20 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 22:02:20
2023-07-10 22:03:03 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 22:03:04 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-10 22:03:04 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-10 22:03:04 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-10 22:03:04 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-10 22:03:04 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-10 22:03:04 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-10 22:03:04 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-10 22:03:05 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-10 22:03:05 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-10 22:03:16 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-10 22:03:16 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-10 22:03:19 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 22:03:19
2023-07-10 22:04:11 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 22:04:11 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-10 22:04:11 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-10 22:04:11 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-10 22:04:11 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-10 22:04:11 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-10 22:04:11 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-10 22:04:11 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-10 22:04:12 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-10 22:04:12 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-10 22:04:24 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-10 22:04:24 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-10 22:04:27 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 22:04:27
2023-07-10 22:05:42 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 22:05:43 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-10 22:05:43 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-10 22:05:43 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-10 22:05:43 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-10 22:05:43 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-10 22:05:43 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-10 22:05:43 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-10 22:05:44 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-10 22:05:44 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-10 22:05:55 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-10 22:05:56 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-10 22:05:59 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-10 22:05:59
2023-07-10 23:49:51 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-10 23:50:01 | WARNING | huggingface_hub.utils._http | 'HTTPSConnectionPool(host='huggingface.co', port=443): Read timed out. (read timeout=10)' thrown while requesting HEAD https://huggingface.co/bert-base-cased/resolve/main/vocab.txt
2023-07-11 16:11:37 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-11 16:11:38 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-11 16:11:38 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-11 16:11:38 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-11 16:11:38 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-11 16:11:38 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-11 16:11:38 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-11 16:11:38 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-11 16:11:38 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-11 16:11:38 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-11 16:11:50 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-11 16:13:02 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-11 16:13:03 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-11 16:13:03 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-11 16:13:03 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-11 16:13:03 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-11 16:13:03 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-11 16:13:03 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-11 16:13:03 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-11 16:13:04 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-11 16:13:04 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-11 16:13:15 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-11 16:13:49 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-11 16:13:50 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-11 16:13:50 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-11 16:13:50 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-11 16:13:50 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-11 16:13:50 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-11 16:13:50 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-11 16:13:50 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-11 16:13:51 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-11 16:13:51 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-11 16:14:03 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-11 16:14:03 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-11 16:14:06 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-11 16:14:06
2023-07-11 16:20:02 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-11 16:20:02 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-11 16:20:02 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-11 16:20:02 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-11 16:20:02 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-11 16:20:02 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-11 16:20:02 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-11 16:20:02 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-11 16:20:03 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-11 16:20:03 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-11 16:37:31 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-11 16:37:32 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-11 16:37:32 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-11 16:37:32 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-11 16:37:32 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-11 16:37:32 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-11 16:37:32 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-11 16:37:32 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-11 16:37:33 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-11 16:37:33 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-11 16:37:45 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-11 16:37:45 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-11 16:37:48 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-11 16:37:48
2023-07-11 16:38:05 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-11 16:38:06 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-11 16:38:06 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-11 16:38:06 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-11 16:38:06 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-11 16:38:06 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-11 16:38:06 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-11 16:38:06 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-11 16:38:07 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-11 16:38:07 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-11 16:38:31 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-11 16:39:02 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-11 16:39:54 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-11 16:40:35 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-11 16:40:43 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-11 16:42:21 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-11 16:42:22 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-11 16:45:06 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-11 17:42:28 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-11 17:42:45 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-11 18:00:30 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-11 18:00:31 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-11 18:00:35 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-11 18:00:35
2023-07-11 18:01:56 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[384, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-11 18:02:03 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-11 18:02:03 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-11 18:02:03 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-11 18:02:03 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-11 18:02:03 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-11 18:02:03 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-11 18:02:08 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-11 18:02:08 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-11 18:02:08 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-11 20:15:46 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-11 20:21:44 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-11 20:36:48 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-11 20:32:43
2023-07-12 13:46:54 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 13:46:55 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-12 13:46:55 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-12 13:46:55 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-12 13:46:55 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-12 13:46:55 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-12 13:46:55 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-12 13:46:55 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-12 13:46:56 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-12 13:46:56 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-12 13:47:14 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-12 13:47:15 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-12 13:47:18 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-12 13:47:18
2023-07-12 14:25:49 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 14:25:50 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-12 14:25:50 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-12 14:25:50 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-12 14:25:50 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-12 14:25:50 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-12 14:25:50 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-12 14:25:50 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-12 14:25:51 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-12 14:25:51 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-12 14:26:10 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-12 14:26:11 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-12 14:26:18 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-12 14:26:18
2023-07-12 15:18:18 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 15:18:19 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-12 15:18:19 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-12 15:18:19 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-12 15:18:19 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-12 15:18:19 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-12 15:18:19 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-12 15:18:19 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-12 15:18:19 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-12 15:18:19 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-12 15:18:31 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-12 15:18:31 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-12 15:18:35 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-12 15:18:35
2023-07-12 15:19:05 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 15:19:06 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-12 15:19:06 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-12 15:19:06 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-12 15:19:06 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-12 15:19:06 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-12 15:19:06 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-12 15:19:06 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-12 15:19:07 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-12 15:19:07 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-12 15:19:24 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-12 15:19:24 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-12 15:19:28 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-12 15:19:28
2023-07-12 15:28:13 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 15:28:14 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-12 15:28:14 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-12 15:28:14 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-12 15:28:14 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-12 15:28:14 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-12 15:28:14 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-12 15:28:14 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-12 15:28:15 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-12 15:28:15 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-12 15:28:26 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-12 15:28:27 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-12 15:28:31 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log 2023-07-12 15:28:31
2023-07-12 15:31:33 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 15:31:34 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-12 15:31:34 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-12 15:31:34 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-12 15:31:34 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-12 15:31:34 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-12 15:31:34 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-12 15:31:34 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-12 15:31:35 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-12 15:31:35 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-12 15:31:52 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-12 15:31:52 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-12 15:31:56 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log 2023-07-12 15:31:56
2023-07-12 15:32:06 | INFO | train | saving log: valid_1_8.json
2023-07-12 15:32:09 | INFO | train | saving log: test_1_8.json
2023-07-12 15:32:09 | INFO | jlogger | Epoch=1 upd=8/400 
[train] loss=60.0612 loss_span=41.2375 loss_node=188.2372 
[valid] loss=10.7002 loss_span=4.0529 loss_node=66.4723 p=58.33 r=17.95 f=27.45 
[test]  loss=6.3243 loss_span=3.9385 loss_node=23.8580 p=28.57 r=4.35 f=7.55 
lr=1.98e-05 gn=5.00 time=13s. 

2023-07-12 15:32:18 | INFO | train | saving log: valid_2_16.json
2023-07-12 15:32:20 | INFO | train | saving log: test_2_16.json
2023-07-12 15:32:20 | INFO | jlogger | Epoch=2 upd=16/400 
[train] loss=32.1232 loss_span=16.6395 loss_node=154.8370 
[valid] loss=7.6962 loss_span=2.1754 loss_node=55.2084 p=58.33 r=17.95 f=27.45 
[test]  loss=3.9316 loss_span=2.0064 loss_node=19.2529 p=28.57 r=4.35 f=7.55 
lr=1.94e-05 gn=3.69 time=11s. 

2023-07-12 15:32:30 | INFO | train | saving log: valid_3_24.json
2023-07-12 15:32:33 | INFO | train | saving log: test_3_24.json
2023-07-12 15:32:33 | INFO | jlogger | Epoch=3 upd=24/400 
[train] loss=23.3821 loss_span=10.9269 loss_node=124.5526 
[valid] loss=6.2270 loss_span=1.8597 loss_node=43.6727 p=58.33 r=17.95 f=27.45 
[test]  loss=3.3450 loss_span=1.8585 loss_node=14.8647 p=28.57 r=4.35 f=7.55 
lr=1.90e-05 gn=3.12 time=12s. 

2023-07-12 15:32:42 | INFO | train | saving log: valid_4_32.json
2023-07-12 15:32:44 | INFO | train | saving log: test_4_32.json
2023-07-12 15:32:44 | INFO | jlogger | Epoch=4 upd=32/400 
[train] loss=20.3487 loss_span=9.9823 loss_node=103.6641 
[valid] loss=5.0351 loss_span=1.7149 loss_node=33.2026 p=50.00 r=15.38 f=23.53 
[test]  loss=2.9754 loss_span=1.8472 loss_node=11.2815 p=28.57 r=4.35 f=7.55 
lr=1.86e-05 gn=3.50 time=12s. 

2023-07-12 15:32:54 | INFO | train | saving log: valid_5_40.json
2023-07-12 15:32:57 | INFO | train | saving log: test_5_40.json
2023-07-12 15:32:57 | INFO | jlogger | Epoch=5 upd=40/400 
[train] loss=15.7389 loss_span=8.6233 loss_node=71.1563 
[valid] loss=4.0384 loss_span=1.5525 loss_node=24.8586 p=50.00 r=15.38 f=23.53 
[test]  loss=2.5388 loss_span=1.7184 loss_node=8.2039 p=28.57 r=4.35 f=7.55 
lr=1.82e-05 gn=1.35 time=12s. 

2023-07-12 15:33:06 | INFO | train | saving log: valid_6_48.json
2023-07-12 15:33:08 | INFO | train | saving log: test_6_48.json
2023-07-12 15:33:08 | INFO | jlogger | Epoch=6 upd=48/400 
[train] loss=13.8289 loss_span=7.6578 loss_node=61.7113 
[valid] loss=3.2329 loss_span=1.4558 loss_node=17.7713 p=50.00 r=15.38 f=23.53 
[test]  loss=2.2060 loss_span=1.6199 loss_node=5.8609 p=37.50 r=6.52 f=11.11 
lr=1.78e-05 gn=1.85 time=11s. 

2023-07-12 15:33:17 | INFO | train | saving log: valid_7_56.json
2023-07-12 15:33:19 | INFO | train | saving log: test_7_56.json
2023-07-12 15:33:19 | INFO | jlogger | Epoch=7 upd=56/400 
[train] loss=11.5412 loss_span=7.0706 loss_node=44.7057 
[valid] loss=2.6231 loss_span=1.3332 loss_node=12.8986 p=66.67 r=20.51 f=31.37 
[test]  loss=1.9636 loss_span=1.4988 loss_node=4.6482 p=37.50 r=6.52 f=11.11 
lr=1.74e-05 gn=1.09 time=11s. 

2023-07-12 15:33:28 | INFO | train | saving log: valid_8_64.json
2023-07-12 15:33:31 | INFO | train | saving log: test_8_64.json
2023-07-12 15:33:31 | INFO | jlogger | Epoch=8 upd=64/400 
[train] loss=10.2093 loss_span=6.6309 loss_node=35.7839 
[valid] loss=2.2385 loss_span=1.2169 loss_node=10.2163 p=66.67 r=20.51 f=31.37 
[test]  loss=1.8323 loss_span=1.4026 loss_node=4.2971 p=28.57 r=4.35 f=7.55 
lr=1.70e-05 gn=1.52 time=11s. 

2023-07-12 15:33:40 | INFO | train | saving log: valid_9_72.json
2023-07-12 15:33:42 | INFO | train | saving log: test_9_72.json
2023-07-12 15:33:42 | INFO | jlogger | Epoch=9 upd=72/400 
[train] loss=9.6689 loss_span=6.1551 loss_node=35.1378 
[valid] loss=2.0320 loss_span=1.2421 loss_node=7.8993 p=50.00 r=10.26 f=17.02 
[test]  loss=1.7678 loss_span=1.3444 loss_node=4.2341 p=40.00 r=4.35 f=7.84 
lr=1.66e-05 gn=1.83 time=11s. 

2023-07-12 15:33:51 | INFO | train | saving log: valid_10_80.json
2023-07-12 15:33:54 | INFO | train | saving log: test_10_80.json
2023-07-12 15:33:54 | INFO | jlogger | Epoch=10 upd=80/400 
[train] loss=8.4586 loss_span=5.5035 loss_node=29.5510 
[valid] loss=1.7112 loss_span=1.0698 loss_node=6.4146 p=63.64 r=17.95 f=28.00 
[test]  loss=1.7138 loss_span=1.2918 loss_node=4.2197 p=28.57 r=4.35 f=7.55 
lr=1.62e-05 gn=1.75 time=11s. 

2023-07-12 15:34:02 | INFO | train | saving log: valid_11_88.json
2023-07-12 15:34:05 | INFO | train | saving log: test_11_88.json
2023-07-12 15:34:05 | INFO | jlogger | Epoch=11 upd=88/400 
[train] loss=8.1868 loss_span=5.1940 loss_node=29.9289 
[valid] loss=1.6441 loss_span=1.0853 loss_node=5.5884 p=60.00 r=15.38 f=24.49 
[test]  loss=1.7072 loss_span=1.2841 loss_node=4.2317 p=40.00 r=4.35 f=7.84 
lr=1.58e-05 gn=2.05 time=11s. 

2023-07-12 15:34:13 | INFO | train | saving log: valid_12_96.json
2023-07-12 15:34:16 | INFO | train | saving log: test_12_96.json
2023-07-12 15:34:16 | INFO | jlogger | Epoch=12 upd=96/400 
[train] loss=7.7676 loss_span=4.7581 loss_node=30.0947 
[valid] loss=1.6173 loss_span=1.0814 loss_node=5.3588 p=55.56 r=12.82 f=20.83 
[test]  loss=1.7256 loss_span=1.2990 loss_node=4.2663 p=50.00 r=4.35 f=8.00 
lr=1.54e-05 gn=2.12 time=11s. 

2023-07-12 15:34:24 | INFO | train | saving log: valid_13_104.json
2023-07-12 15:34:27 | INFO | train | saving log: test_13_104.json
2023-07-12 15:34:27 | INFO | jlogger | Epoch=13 upd=104/400 
[train] loss=7.2011 loss_span=4.2987 loss_node=29.0235 
[valid] loss=1.5981 loss_span=1.0801 loss_node=5.1798 p=71.43 r=12.82 f=21.74 
[test]  loss=1.6999 loss_span=1.2784 loss_node=4.2157 p=33.33 r=2.17 f=4.08 
lr=1.49e-05 gn=1.85 time=11s. 

2023-07-12 15:34:36 | INFO | train | saving log: valid_14_112.json
2023-07-12 15:34:38 | INFO | train | saving log: test_14_112.json
2023-07-12 15:34:38 | INFO | jlogger | Epoch=14 upd=112/400 
[train] loss=6.9738 loss_span=4.0539 loss_node=29.1994 
[valid] loss=1.4883 loss_span=0.9862 loss_node=5.0202 p=70.00 r=17.95 f=28.57 
[test]  loss=1.6598 loss_span=1.2451 loss_node=4.1474 p=0.00 r=0.00 f=0.00 
lr=1.45e-05 gn=3.13 time=11s. 

2023-07-12 15:34:47 | INFO | train | saving log: valid_15_120.json
2023-07-12 15:34:50 | INFO | train | saving log: test_15_120.json
2023-07-12 15:34:50 | INFO | jlogger | Epoch=15 upd=120/400 
[train] loss=6.4735 loss_span=3.7740 loss_node=26.9949 
[valid] loss=1.5316 loss_span=1.0448 loss_node=4.8680 p=85.71 r=15.38 f=26.09 
[test]  loss=1.6752 loss_span=1.2653 loss_node=4.0987 p=0.00 r=0.00 f=0.00 
lr=1.41e-05 gn=1.74 time=11s. 

2023-07-12 15:34:59 | INFO | train | saving log: valid_16_128.json
2023-07-12 15:35:01 | INFO | train | saving log: test_16_128.json
2023-07-12 15:35:01 | INFO | jlogger | Epoch=16 upd=128/400 
[train] loss=6.5229 loss_span=3.7066 loss_node=28.1633 
[valid] loss=1.3975 loss_span=0.9180 loss_node=4.7949 p=68.75 r=28.21 f=40.00 
[test]  loss=1.5166 loss_span=1.1075 loss_node=4.0909 p=28.57 r=4.35 f=7.55 
lr=1.37e-05 gn=4.26 time=11s. 

2023-07-12 15:35:10 | INFO | train | saving log: valid_17_136.json
2023-07-12 15:35:12 | INFO | train | saving log: test_17_136.json
2023-07-12 15:35:12 | INFO | jlogger | Epoch=17 upd=136/400 
[train] loss=6.3439 loss_span=3.5651 loss_node=27.7882 
[valid] loss=1.3632 loss_span=0.8876 loss_node=4.7557 p=41.94 r=33.33 f=37.14 
[test]  loss=1.5198 loss_span=1.1127 loss_node=4.0707 p=27.78 r=10.87 f=15.62 
lr=1.33e-05 gn=2.47 time=11s. 

2023-07-12 15:35:22 | INFO | train | saving log: valid_18_144.json
2023-07-12 15:35:24 | INFO | train | saving log: test_18_144.json
2023-07-12 15:35:24 | INFO | jlogger | Epoch=18 upd=144/400 
[train] loss=6.1102 loss_span=3.5046 loss_node=26.0560 
[valid] loss=1.3419 loss_span=0.8749 loss_node=4.6699 p=62.50 r=25.64 f=36.36 
[test]  loss=1.5573 loss_span=1.1551 loss_node=4.0221 p=0.00 r=0.00 f=0.00 
lr=1.29e-05 gn=2.07 time=12s. 

2023-07-12 15:35:33 | INFO | train | saving log: valid_19_152.json
2023-07-12 15:35:36 | INFO | train | saving log: test_19_152.json
2023-07-12 15:35:36 | INFO | jlogger | Epoch=19 upd=152/400 
[train] loss=5.8356 loss_span=3.1159 loss_node=27.1971 
[valid] loss=1.2296 loss_span=0.7727 loss_node=4.5685 p=54.17 r=33.33 f=41.27 
[test]  loss=1.5824 loss_span=1.1840 loss_node=3.9842 p=30.00 r=6.52 f=10.71 
lr=1.25e-05 gn=4.43 time=12s. 

2023-07-12 15:35:45 | INFO | train | saving log: valid_20_160.json
2023-07-12 15:35:48 | INFO | train | saving log: test_20_160.json
2023-07-12 15:35:48 | INFO | jlogger | Epoch=20 upd=160/400 
[train] loss=5.5815 loss_span=2.9362 loss_node=26.4529 
[valid] loss=1.3030 loss_span=0.8515 loss_node=4.5141 p=41.38 r=30.77 f=35.29 
[test]  loss=1.5213 loss_span=1.1230 loss_node=3.9830 p=25.00 r=6.52 f=10.34 
lr=1.21e-05 gn=1.62 time=12s. 

2023-07-12 15:35:57 | INFO | train | saving log: valid_21_168.json
2023-07-12 15:36:00 | INFO | train | saving log: test_21_168.json
2023-07-12 15:36:00 | INFO | jlogger | Epoch=21 upd=168/400 
[train] loss=5.6840 loss_span=2.8328 loss_node=28.5121 
[valid] loss=1.3068 loss_span=0.8542 loss_node=4.5257 p=39.39 r=33.33 f=36.11 
[test]  loss=1.5135 loss_span=1.1120 loss_node=4.0159 p=25.00 r=8.70 f=12.90 
lr=1.17e-05 gn=1.54 time=12s. 

2023-07-12 15:36:10 | INFO | train | saving log: valid_22_176.json
2023-07-12 15:36:12 | INFO | train | saving log: test_22_176.json
2023-07-12 15:36:12 | INFO | jlogger | Epoch=22 upd=176/400 
[train] loss=5.3145 loss_span=2.6540 loss_node=26.6048 
[valid] loss=1.1946 loss_span=0.7482 loss_node=4.4638 p=48.48 r=41.03 f=44.44 
[test]  loss=1.4981 loss_span=1.1005 loss_node=3.9758 p=27.27 r=13.04 f=17.65 
lr=1.13e-05 gn=1.56 time=12s. 

2023-07-12 15:36:21 | INFO | train | saving log: valid_23_184.json
2023-07-12 15:36:24 | INFO | train | saving log: test_23_184.json
2023-07-12 15:36:24 | INFO | jlogger | Epoch=23 upd=184/400 
[train] loss=5.1024 loss_span=2.4522 loss_node=26.5023 
[valid] loss=1.1763 loss_span=0.7397 loss_node=4.3666 p=47.06 r=41.03 f=43.84 
[test]  loss=1.5267 loss_span=1.1343 loss_node=3.9233 p=25.00 r=15.22 f=18.92 
lr=1.09e-05 gn=1.60 time=12s. 

2023-07-12 15:36:33 | INFO | train | saving log: valid_24_192.json
2023-07-12 15:36:36 | INFO | train | saving log: test_24_192.json
2023-07-12 15:36:36 | INFO | jlogger | Epoch=24 upd=192/400 
[train] loss=4.9189 loss_span=2.3270 loss_node=25.9188 
[valid] loss=1.1885 loss_span=0.7597 loss_node=4.2877 p=51.85 r=35.90 f=42.42 
[test]  loss=1.5146 loss_span=1.1264 loss_node=3.8825 p=16.67 r=4.35 f=6.90 
lr=1.05e-05 gn=2.11 time=12s. 

2023-07-12 15:36:46 | INFO | train | saving log: valid_25_200.json
2023-07-12 15:36:48 | INFO | train | saving log: test_25_200.json
2023-07-12 15:36:48 | INFO | jlogger | Epoch=25 upd=200/400 
[train] loss=4.8765 loss_span=2.2303 loss_node=26.4626 
[valid] loss=1.1520 loss_span=0.7242 loss_node=4.2776 p=53.33 r=41.03 f=46.38 
[test]  loss=1.4545 loss_span=1.0637 loss_node=3.9080 p=40.91 r=19.57 f=26.47 
lr=1.01e-05 gn=1.95 time=12s. 

2023-07-12 15:36:57 | INFO | train | saving log: valid_26_208.json
2023-07-12 15:37:00 | INFO | train | saving log: test_26_208.json
2023-07-12 15:37:00 | INFO | jlogger | Epoch=26 upd=208/400 
[train] loss=4.7123 loss_span=2.0357 loss_node=26.7653 
[valid] loss=1.1708 loss_span=0.7448 loss_node=4.2603 p=46.88 r=38.46 f=42.25 
[test]  loss=1.4502 loss_span=1.0588 loss_node=3.9142 p=32.14 r=19.57 f=24.32 
lr=9.70e-06 gn=1.63 time=12s. 

2023-07-12 15:37:08 | INFO | train | saving log: valid_27_216.json
2023-07-12 15:37:11 | INFO | train | saving log: test_27_216.json
2023-07-12 15:37:11 | INFO | jlogger | Epoch=27 upd=216/400 
[train] loss=4.6493 loss_span=2.0363 loss_node=26.1304 
[valid] loss=1.1205 loss_span=0.6970 loss_node=4.2353 p=57.14 r=41.03 f=47.76 
[test]  loss=1.4132 loss_span=1.0227 loss_node=3.9044 p=36.84 r=15.22 f=21.54 
lr=9.29e-06 gn=2.74 time=11s. 

2023-07-12 15:37:20 | INFO | train | saving log: valid_28_224.json
2023-07-12 15:37:22 | INFO | train | saving log: test_28_224.json
2023-07-12 15:37:22 | INFO | jlogger | Epoch=28 upd=224/400 
[train] loss=4.5094 loss_span=1.9257 loss_node=25.8366 
[valid] loss=1.0794 loss_span=0.6570 loss_node=4.2238 p=54.84 r=43.59 f=48.57 
[test]  loss=1.4165 loss_span=1.0268 loss_node=3.8970 p=25.93 r=15.22 f=19.18 
lr=8.89e-06 gn=2.60 time=11s. 

2023-07-12 15:37:31 | INFO | train | saving log: valid_29_232.json
2023-07-12 15:37:34 | INFO | train | saving log: test_29_232.json
2023-07-12 15:37:34 | INFO | jlogger | Epoch=29 upd=232/400 
[train] loss=4.2922 loss_span=1.8205 loss_node=24.7164 
[valid] loss=1.1214 loss_span=0.7012 loss_node=4.2020 p=55.17 r=41.03 f=47.06 
[test]  loss=1.4467 loss_span=1.0568 loss_node=3.8995 p=33.33 r=15.22 f=20.90 
lr=8.48e-06 gn=3.15 time=11s. 

2023-07-12 15:37:43 | INFO | train | saving log: valid_30_240.json
2023-07-12 15:37:45 | INFO | train | saving log: test_30_240.json
2023-07-12 15:37:45 | INFO | jlogger | Epoch=30 upd=240/400 
[train] loss=4.4475 loss_span=1.7916 loss_node=26.5592 
[valid] loss=1.1151 loss_span=0.6961 loss_node=4.1900 p=55.17 r=41.03 f=47.06 
[test]  loss=1.4680 loss_span=1.0783 loss_node=3.8975 p=36.36 r=17.39 f=23.53 
lr=8.08e-06 gn=3.33 time=11s. 

2023-07-12 15:37:54 | INFO | train | saving log: valid_31_248.json
2023-07-12 15:37:56 | INFO | train | saving log: test_31_248.json
2023-07-12 15:37:56 | INFO | jlogger | Epoch=31 upd=248/400 
[train] loss=4.3034 loss_span=1.7170 loss_node=25.8632 
[valid] loss=1.1058 loss_span=0.6907 loss_node=4.1504 p=48.57 r=43.59 f=45.95 
[test]  loss=1.4401 loss_span=1.0535 loss_node=3.8659 p=23.53 r=17.39 f=20.00 
lr=7.68e-06 gn=2.53 time=11s. 

2023-07-12 15:38:05 | INFO | train | saving log: valid_32_256.json
2023-07-12 15:38:07 | INFO | train | saving log: test_32_256.json
2023-07-12 15:38:07 | INFO | jlogger | Epoch=32 upd=256/400 
[train] loss=4.1170 loss_span=1.6738 loss_node=24.4321 
[valid] loss=1.1276 loss_span=0.7184 loss_node=4.0920 p=57.69 r=38.46 f=46.15 
[test]  loss=1.4490 loss_span=1.0665 loss_node=3.8252 p=43.75 r=15.22 f=22.58 
lr=7.27e-06 gn=1.49 time=11s. 

2023-07-12 15:38:16 | INFO | train | saving log: valid_33_264.json
2023-07-12 15:38:19 | INFO | train | saving log: test_33_264.json
2023-07-12 15:38:19 | INFO | jlogger | Epoch=33 upd=264/400 
[train] loss=4.1986 loss_span=1.6047 loss_node=25.9391 
[valid] loss=1.0638 loss_span=0.6557 loss_node=4.0811 p=53.12 r=43.59 f=47.89 
[test]  loss=1.4102 loss_span=1.0281 loss_node=3.8210 p=23.33 r=15.22 f=18.42 
lr=6.87e-06 gn=2.87 time=11s. 

2023-07-12 15:38:28 | INFO | train | saving log: valid_34_272.json
2023-07-12 15:38:30 | INFO | train | saving log: test_34_272.json
2023-07-12 15:38:30 | INFO | jlogger | Epoch=34 upd=272/400 
[train] loss=3.9953 loss_span=1.5130 loss_node=24.8236 
[valid] loss=1.0735 loss_span=0.6645 loss_node=4.0901 p=54.84 r=43.59 f=48.57 
[test]  loss=1.4588 loss_span=1.0748 loss_node=3.8399 p=28.57 r=13.04 f=17.91 
lr=6.46e-06 gn=1.78 time=11s. 

2023-07-12 15:38:39 | INFO | train | saving log: valid_35_280.json
2023-07-12 15:38:41 | INFO | train | saving log: test_35_280.json
2023-07-12 15:38:41 | INFO | jlogger | Epoch=35 upd=280/400 
[train] loss=3.9687 loss_span=1.4459 loss_node=25.2279 
[valid] loss=1.0587 loss_span=0.6489 loss_node=4.0976 p=56.67 r=43.59 f=49.28 
[test]  loss=1.4059 loss_span=1.0202 loss_node=3.8575 p=32.00 r=17.39 f=22.54 
lr=6.06e-06 gn=1.74 time=11s. 

2023-07-12 15:38:50 | INFO | train | saving log: valid_36_288.json
2023-07-12 15:38:52 | INFO | train | saving log: test_36_288.json
2023-07-12 15:38:52 | INFO | jlogger | Epoch=36 upd=288/400 
[train] loss=3.8955 loss_span=1.4143 loss_node=24.8115 
[valid] loss=1.0718 loss_span=0.6630 loss_node=4.0885 p=50.00 r=41.03 f=45.07 
[test]  loss=1.4182 loss_span=1.0315 loss_node=3.8668 p=25.93 r=15.22 f=19.18 
lr=5.66e-06 gn=1.32 time=11s. 

2023-07-12 15:39:01 | INFO | train | saving log: valid_37_296.json
2023-07-12 15:39:04 | INFO | train | saving log: test_37_296.json
2023-07-12 15:39:04 | INFO | jlogger | Epoch=37 upd=296/400 
[train] loss=3.8492 loss_span=1.4485 loss_node=24.0067 
[valid] loss=1.0753 loss_span=0.6678 loss_node=4.0753 p=53.12 r=43.59 f=47.89 
[test]  loss=1.4410 loss_span=1.0541 loss_node=3.8687 p=20.00 r=10.87 f=14.08 
lr=5.25e-06 gn=1.99 time=11s. 

2023-07-12 15:39:13 | INFO | train | saving log: valid_38_304.json
2023-07-12 15:39:15 | INFO | train | saving log: test_38_304.json
2023-07-12 15:39:15 | INFO | jlogger | Epoch=38 upd=304/400 
[train] loss=3.8312 loss_span=1.4097 loss_node=24.2154 
[valid] loss=1.0407 loss_span=0.6353 loss_node=4.0539 p=54.55 r=46.15 f=50.00 
[test]  loss=1.4044 loss_span=1.0181 loss_node=3.8623 p=25.00 r=15.22 f=18.92 
lr=4.85e-06 gn=2.27 time=11s. 

2023-07-12 15:39:24 | INFO | train | saving log: valid_39_312.json
2023-07-12 15:39:26 | INFO | train | saving log: test_39_312.json
2023-07-12 15:39:27 | INFO | jlogger | Epoch=39 upd=312/400 
[train] loss=3.8557 loss_span=1.3666 loss_node=24.8907 
[valid] loss=1.0261 loss_span=0.6220 loss_node=4.0413 p=54.55 r=46.15 f=50.00 
[test]  loss=1.4228 loss_span=1.0364 loss_node=3.8634 p=31.82 r=15.22 f=20.59 
lr=4.44e-06 gn=1.51 time=12s. 

2023-07-12 15:39:36 | INFO | train | saving log: valid_40_320.json
2023-07-12 15:39:39 | INFO | train | saving log: test_40_320.json
2023-07-12 15:39:39 | INFO | jlogger | Epoch=40 upd=320/400 
[train] loss=3.7508 loss_span=1.3396 loss_node=24.1125 
[valid] loss=1.0081 loss_span=0.6062 loss_node=4.0190 p=56.25 r=46.15 f=50.70 
[test]  loss=1.3796 loss_span=0.9935 loss_node=3.8604 p=20.83 r=10.87 f=14.29 
lr=4.04e-06 gn=1.79 time=12s. 

2023-07-12 15:39:48 | INFO | train | saving log: valid_41_328.json
2023-07-12 15:39:50 | INFO | train | saving log: test_41_328.json
2023-07-12 15:39:50 | INFO | jlogger | Epoch=41 upd=328/400 
[train] loss=3.7492 loss_span=1.2976 loss_node=24.5165 
[valid] loss=1.0002 loss_span=0.6012 loss_node=3.9900 p=56.25 r=46.15 f=50.70 
[test]  loss=1.4016 loss_span=1.0173 loss_node=3.8428 p=21.43 r=13.04 f=16.22 
lr=3.64e-06 gn=1.36 time=12s. 

2023-07-12 15:40:00 | INFO | train | saving log: valid_42_336.json
2023-07-12 15:40:02 | INFO | train | saving log: test_42_336.json
2023-07-12 15:40:02 | INFO | jlogger | Epoch=42 upd=336/400 
[train] loss=3.8911 loss_span=1.3070 loss_node=25.8415 
[valid] loss=1.0066 loss_span=0.6101 loss_node=3.9646 p=56.25 r=46.15 f=50.70 
[test]  loss=1.4094 loss_span=1.0275 loss_node=3.8181 p=32.00 r=17.39 f=22.54 
lr=3.23e-06 gn=1.99 time=12s. 

2023-07-12 15:40:12 | INFO | train | saving log: valid_43_344.json
2023-07-12 15:40:14 | INFO | train | saving log: test_43_344.json
2023-07-12 15:40:14 | INFO | jlogger | Epoch=43 upd=344/400 
[train] loss=3.7379 loss_span=1.2723 loss_node=24.6566 
[valid] loss=1.0018 loss_span=0.6071 loss_node=3.9471 p=56.25 r=46.15 f=50.70 
[test]  loss=1.3910 loss_span=1.0112 loss_node=3.7988 p=28.00 r=15.22 f=19.72 
lr=2.83e-06 gn=1.89 time=12s. 

2023-07-12 15:40:24 | INFO | train | saving log: valid_44_352.json
2023-07-12 15:40:26 | INFO | train | saving log: test_44_352.json
2023-07-12 15:40:26 | INFO | jlogger | Epoch=44 upd=352/400 
[train] loss=3.6325 loss_span=1.2200 loss_node=24.1241 
[valid] loss=1.0035 loss_span=0.6099 loss_node=3.9363 p=56.25 r=46.15 f=50.70 
[test]  loss=1.4151 loss_span=1.0361 loss_node=3.7899 p=25.93 r=15.22 f=19.18 
lr=2.42e-06 gn=1.41 time=12s. 

2023-07-12 15:40:36 | INFO | train | saving log: valid_45_360.json
2023-07-12 15:40:38 | INFO | train | saving log: test_45_360.json
2023-07-12 15:40:38 | INFO | jlogger | Epoch=45 upd=360/400 
[train] loss=3.6157 loss_span=1.2226 loss_node=23.9309 
[valid] loss=1.0028 loss_span=0.6105 loss_node=3.9232 p=56.25 r=46.15 f=50.70 
[test]  loss=1.4280 loss_span=1.0495 loss_node=3.7847 p=32.00 r=17.39 f=22.54 
lr=2.02e-06 gn=1.65 time=12s. 

2023-07-12 15:40:47 | INFO | train | saving log: valid_46_368.json
2023-07-12 15:40:50 | INFO | train | saving log: test_46_368.json
2023-07-12 15:40:50 | INFO | jlogger | Epoch=46 upd=368/400 
[train] loss=3.7448 loss_span=1.2608 loss_node=24.8398 
[valid] loss=0.9960 loss_span=0.6035 loss_node=3.9246 p=56.25 r=46.15 f=50.70 
[test]  loss=1.4076 loss_span=1.0288 loss_node=3.7880 p=30.43 r=15.22 f=20.29 
lr=1.62e-06 gn=2.32 time=11s. 

2023-07-12 15:40:58 | INFO | train | saving log: valid_47_376.json
2023-07-12 15:41:01 | INFO | train | saving log: test_47_376.json
2023-07-12 15:41:01 | INFO | jlogger | Epoch=47 upd=376/400 
[train] loss=3.6631 loss_span=1.2304 loss_node=24.3274 
[valid] loss=1.0015 loss_span=0.6084 loss_node=3.9312 p=56.25 r=46.15 f=50.70 
[test]  loss=1.4037 loss_span=1.0244 loss_node=3.7927 p=17.39 r=8.70 f=11.59 
lr=1.21e-06 gn=1.57 time=11s. 

2023-07-12 15:41:10 | INFO | train | saving log: valid_48_384.json
2023-07-12 15:41:12 | INFO | train | saving log: test_48_384.json
2023-07-12 15:41:12 | INFO | jlogger | Epoch=48 upd=384/400 
[train] loss=3.6663 loss_span=1.2425 loss_node=24.2385 
[valid] loss=0.9998 loss_span=0.6066 loss_node=3.9314 p=56.25 r=46.15 f=50.70 
[test]  loss=1.3976 loss_span=1.0184 loss_node=3.7913 p=25.93 r=15.22 f=19.18 
lr=8.08e-07 gn=1.23 time=11s. 

2023-07-12 15:41:21 | INFO | train | saving log: valid_49_392.json
2023-07-12 15:41:23 | INFO | train | saving log: test_49_392.json
2023-07-12 15:41:23 | INFO | jlogger | Epoch=49 upd=392/400 
[train] loss=3.5759 loss_span=1.1938 loss_node=23.8207 
[valid] loss=0.9972 loss_span=0.6043 loss_node=3.9289 p=54.55 r=46.15 f=50.00 
[test]  loss=1.3971 loss_span=1.0182 loss_node=3.7891 p=25.00 r=15.22 f=18.92 
lr=4.04e-07 gn=1.25 time=11s. 

2023-07-12 15:41:32 | INFO | train | saving log: valid_50_400.json
2023-07-12 15:41:35 | INFO | train | saving log: test_50_400.json
2023-07-12 15:41:35 | INFO | jlogger | Epoch=50 upd=400/400 
[train] loss=3.6384 loss_span=1.1640 loss_node=24.7447 
[valid] loss=0.9968 loss_span=0.6040 loss_node=3.9284 p=56.25 r=46.15 f=50.70 
[test]  loss=1.3987 loss_span=1.0199 loss_node=3.7885 p=28.57 r=17.39 f=21.62 
lr=0.00e+00 gn=1.68 time=11s. 

2023-07-12 15:41:35 | INFO | jlogger | 
Best valid scores: p=56.25 r=46.15 f=50.7 
Best test scores by valid: p=20.83 r=10.87 f=14.29 
Best test scores: p=40.91 r=19.57 f=26.47 

2023-07-12 16:05:48 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 16:05:49 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-12 16:05:49 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-12 16:05:49 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-12 16:05:49 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-12 16:07:31 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 16:07:32 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-12 16:07:32 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-12 16:07:32 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-12 16:07:32 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-12 16:09:39 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 16:09:41 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-12 16:09:41 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-12 16:09:41 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-12 16:09:41 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-12 17:45:04 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 17:45:05 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-12 17:45:05 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-12 17:45:05 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-12 17:45:05 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-12 17:45:05 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-12 17:45:05 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-12 17:45:05 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-12 17:45:06 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-12 17:45:06 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-12 17:45:20 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-12 17:45:20 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-12 17:45:24 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log 2023-07-12 17:45:24
2023-07-12 17:45:35 | INFO | train | saving log: valid_1_8.json
2023-07-12 17:45:37 | INFO | train | saving log: test_1_8.json
2023-07-12 17:45:37 | INFO | jlogger | Epoch=1 upd=8/400 
[train] loss=58.3154 loss_span=39.7838 loss_node=185.3165 
[valid] loss=9.8999 loss_span=3.3564 loss_node=65.4347 p=58.33 r=17.95 f=27.45 
[test]  loss=5.3923 loss_span=3.0583 loss_node=23.3404 p=28.57 r=4.35 f=7.55 
lr=1.98e-05 gn=5.00 time=13s. 

2023-07-12 17:45:46 | INFO | train | saving log: valid_2_16.json
2023-07-12 17:45:49 | INFO | train | saving log: test_2_16.json
2023-07-12 17:45:49 | INFO | jlogger | Epoch=2 upd=16/400 
[train] loss=29.6204 loss_span=14.5041 loss_node=151.1627 
[valid] loss=7.4410 loss_span=2.0737 loss_node=53.6735 p=58.33 r=17.95 f=27.45 
[test]  loss=3.8007 loss_span=1.9537 loss_node=18.4698 p=28.57 r=4.35 f=7.55 
lr=1.94e-05 gn=3.58 time=12s. 

2023-07-12 17:45:58 | INFO | train | saving log: valid_3_24.json
2023-07-12 17:46:00 | INFO | train | saving log: test_3_24.json
2023-07-12 17:46:00 | INFO | jlogger | Epoch=3 upd=24/400 
[train] loss=22.3504 loss_span=10.3394 loss_node=120.1104 
[valid] loss=5.9981 loss_span=1.7599 loss_node=42.3819 p=58.33 r=17.95 f=27.45 
[test]  loss=3.2127 loss_span=1.7973 loss_node=14.1541 p=28.57 r=4.35 f=7.55 
lr=1.90e-05 gn=2.89 time=11s. 

2023-07-12 17:46:09 | INFO | train | saving log: valid_4_32.json
2023-07-12 17:46:12 | INFO | train | saving log: test_4_32.json
2023-07-12 17:46:12 | INFO | jlogger | Epoch=4 upd=32/400 
[train] loss=19.3594 loss_span=9.4087 loss_node=99.5071 
[valid] loss=4.8122 loss_span=1.6120 loss_node=32.0015 p=50.00 r=15.38 f=23.53 
[test]  loss=2.8424 loss_span=1.7762 loss_node=10.6617 p=28.57 r=4.35 f=7.55 
lr=1.86e-05 gn=2.50 time=11s. 

2023-07-12 17:46:21 | INFO | train | saving log: valid_5_40.json
2023-07-12 17:46:23 | INFO | train | saving log: test_5_40.json
2023-07-12 17:46:23 | INFO | jlogger | Epoch=5 upd=40/400 
[train] loss=15.1505 loss_span=8.3145 loss_node=68.3600 
[valid] loss=3.9306 loss_span=1.5280 loss_node=24.0263 p=50.00 r=15.38 f=23.53 
[test]  loss=2.5222 loss_span=1.7410 loss_node=7.8124 p=37.50 r=6.52 f=11.11 
lr=1.82e-05 gn=3.89 time=11s. 

2023-07-12 17:46:32 | INFO | train | saving log: valid_6_48.json
2023-07-12 17:46:34 | INFO | train | saving log: test_6_48.json
2023-07-12 17:46:34 | INFO | jlogger | Epoch=6 upd=48/400 
[train] loss=13.6183 loss_span=7.5909 loss_node=60.2742 
[valid] loss=3.1634 loss_span=1.4083 loss_node=17.5503 p=66.67 r=20.51 f=31.37 
[test]  loss=2.1323 loss_span=1.5615 loss_node=5.7074 p=37.50 r=6.52 f=11.11 
lr=1.78e-05 gn=5.00 time=11s. 

2023-07-12 17:46:43 | INFO | train | saving log: valid_7_56.json
2023-07-12 17:46:45 | INFO | train | saving log: test_7_56.json
2023-07-12 17:46:45 | INFO | jlogger | Epoch=7 upd=56/400 
[train] loss=11.3230 loss_span=6.8170 loss_node=45.0595 
[valid] loss=2.6885 loss_span=1.3776 loss_node=13.1094 p=66.67 r=20.51 f=31.37 
[test]  loss=1.9908 loss_span=1.5247 loss_node=4.6611 p=28.57 r=4.35 f=7.55 
lr=1.74e-05 gn=1.80 time=11s. 

2023-07-12 17:46:54 | INFO | train | saving log: valid_8_64.json
2023-07-12 17:46:57 | INFO | train | saving log: test_8_64.json
2023-07-12 17:46:57 | INFO | jlogger | Epoch=8 upd=64/400 
[train] loss=10.0307 loss_span=6.3957 loss_node=36.3500 
[valid] loss=2.3520 loss_span=1.3028 loss_node=10.4927 p=54.55 r=15.38 f=24.00 
[test]  loss=1.8954 loss_span=1.4643 loss_node=4.3115 p=37.50 r=6.52 f=11.11 
lr=1.70e-05 gn=1.61 time=12s. 

2023-07-12 17:47:06 | INFO | train | saving log: valid_9_72.json
2023-07-12 17:47:08 | INFO | train | saving log: test_9_72.json
2023-07-12 17:47:08 | INFO | jlogger | Epoch=9 upd=72/400 
[train] loss=9.5304 loss_span=5.9364 loss_node=35.9399 
[valid] loss=2.0396 loss_span=1.2037 loss_node=8.3590 p=60.00 r=15.38 f=24.49 
[test]  loss=1.8072 loss_span=1.3854 loss_node=4.2172 p=25.00 r=4.35 f=7.41 
lr=1.66e-05 gn=1.35 time=11s. 

2023-07-12 17:47:17 | INFO | train | saving log: valid_10_80.json
2023-07-12 17:47:20 | INFO | train | saving log: test_10_80.json
2023-07-12 17:47:20 | INFO | jlogger | Epoch=10 upd=80/400 
[train] loss=8.3509 loss_span=5.3469 loss_node=30.0399 
[valid] loss=1.7934 loss_span=1.1161 loss_node=6.7732 p=60.00 r=15.38 f=24.49 
[test]  loss=1.7773 loss_span=1.3589 loss_node=4.1832 p=37.50 r=6.52 f=11.11 
lr=1.62e-05 gn=3.73 time=11s. 

2023-07-12 17:47:28 | INFO | train | saving log: valid_11_88.json
2023-07-12 17:47:31 | INFO | train | saving log: test_11_88.json
2023-07-12 17:47:31 | INFO | jlogger | Epoch=11 upd=88/400 
[train] loss=8.0437 loss_span=5.0206 loss_node=30.2302 
[valid] loss=1.6120 loss_span=1.0364 loss_node=5.7564 p=58.33 r=17.95 f=27.45 
[test]  loss=1.7492 loss_span=1.3292 loss_node=4.1994 p=22.22 r=4.35 f=7.27 
lr=1.58e-05 gn=3.22 time=11s. 

2023-07-12 17:47:39 | INFO | train | saving log: valid_12_96.json
2023-07-12 17:47:42 | INFO | train | saving log: test_12_96.json
2023-07-12 17:47:42 | INFO | jlogger | Epoch=12 upd=96/400 
[train] loss=7.9257 loss_span=4.9164 loss_node=30.0925 
[valid] loss=1.6861 loss_span=1.1432 loss_node=5.4292 p=50.00 r=23.08 f=31.58 
[test]  loss=1.9652 loss_span=1.5424 loss_node=4.2286 p=14.29 r=8.70 f=10.81 
lr=1.54e-05 gn=1.87 time=11s. 

2023-07-12 17:47:50 | INFO | train | saving log: valid_13_104.json
2023-07-12 17:47:53 | INFO | train | saving log: test_13_104.json
2023-07-12 17:47:53 | INFO | jlogger | Epoch=13 upd=104/400 
[train] loss=7.8225 loss_span=4.9268 loss_node=28.9572 
[valid] loss=1.4923 loss_span=0.9699 loss_node=5.2238 p=80.00 r=20.51 f=32.65 
[test]  loss=1.6947 loss_span=1.2757 loss_node=4.1892 p=20.00 r=2.17 f=3.92 
lr=1.49e-05 gn=5.00 time=11s. 

2023-07-12 17:48:02 | INFO | train | saving log: valid_14_112.json
2023-07-12 17:48:04 | INFO | train | saving log: test_14_112.json
2023-07-12 17:48:04 | INFO | jlogger | Epoch=14 upd=112/400 
[train] loss=7.4633 loss_span=4.5363 loss_node=29.2703 
[valid] loss=1.5854 loss_span=1.0811 loss_node=5.0430 p=77.78 r=17.95 f=29.17 
[test]  loss=1.7313 loss_span=1.3174 loss_node=4.1386 p=25.00 r=2.17 f=4.00 
lr=1.45e-05 gn=3.49 time=11s. 

2023-07-12 17:48:13 | INFO | train | saving log: valid_15_120.json
2023-07-12 17:48:15 | INFO | train | saving log: test_15_120.json
2023-07-12 17:48:15 | INFO | jlogger | Epoch=15 upd=120/400 
[train] loss=6.9152 loss_span=4.2061 loss_node=27.0911 
[valid] loss=1.5907 loss_span=1.1014 loss_node=4.8929 p=88.89 r=20.51 f=33.33 
[test]  loss=1.8231 loss_span=1.4120 loss_node=4.1111 p=25.00 r=2.17 f=4.00 
lr=1.41e-05 gn=2.28 time=11s. 

2023-07-12 17:48:24 | INFO | train | saving log: valid_16_128.json
2023-07-12 17:48:26 | INFO | train | saving log: test_16_128.json
2023-07-12 17:48:26 | INFO | jlogger | Epoch=16 upd=128/400 
[train] loss=6.8840 loss_span=4.0554 loss_node=28.2863 
[valid] loss=1.5144 loss_span=1.0330 loss_node=4.8138 p=60.00 r=23.08 f=33.33 
[test]  loss=1.6691 loss_span=1.2583 loss_node=4.1085 p=33.33 r=4.35 f=7.69 
lr=1.37e-05 gn=3.80 time=11s. 

2023-07-12 17:48:35 | INFO | train | saving log: valid_17_136.json
2023-07-12 17:48:37 | INFO | train | saving log: test_17_136.json
2023-07-12 17:48:37 | INFO | jlogger | Epoch=17 upd=136/400 
[train] loss=6.3848 loss_span=3.6001 loss_node=27.8474 
[valid] loss=1.5379 loss_span=1.0604 loss_node=4.7758 p=66.67 r=20.51 f=31.37 
[test]  loss=1.7433 loss_span=1.3344 loss_node=4.0891 p=33.33 r=6.52 f=10.91 
lr=1.33e-05 gn=2.75 time=11s. 

2023-07-12 17:48:46 | INFO | train | saving log: valid_18_144.json
2023-07-12 17:48:49 | INFO | train | saving log: test_18_144.json
2023-07-12 17:48:49 | INFO | jlogger | Epoch=18 upd=144/400 
[train] loss=5.9983 loss_span=3.3851 loss_node=26.1316 
[valid] loss=1.5802 loss_span=1.1115 loss_node=4.6866 p=75.00 r=23.08 f=35.29 
[test]  loss=1.6456 loss_span=1.2412 loss_node=4.0445 p=33.33 r=4.35 f=7.69 
lr=1.29e-05 gn=2.58 time=12s. 

2023-07-12 17:48:58 | INFO | train | saving log: valid_19_152.json
2023-07-12 17:49:00 | INFO | train | saving log: test_19_152.json
2023-07-12 17:49:00 | INFO | jlogger | Epoch=19 upd=152/400 
[train] loss=5.7818 loss_span=3.0598 loss_node=27.2199 
[valid] loss=1.5081 loss_span=1.0508 loss_node=4.5736 p=31.25 r=25.64 f=28.17 
[test]  loss=1.6940 loss_span=1.2942 loss_node=3.9983 p=25.93 r=15.22 f=19.18 
lr=1.25e-05 gn=2.71 time=11s. 

2023-07-12 17:49:09 | INFO | train | saving log: valid_20_160.json
2023-07-12 17:49:11 | INFO | train | saving log: test_20_160.json
2023-07-12 17:49:11 | INFO | jlogger | Epoch=20 upd=160/400 
[train] loss=5.4772 loss_span=2.8227 loss_node=26.5448 
[valid] loss=1.6365 loss_span=1.1850 loss_node=4.5147 p=25.00 r=23.08 f=24.00 
[test]  loss=1.6447 loss_span=1.2453 loss_node=3.9941 p=22.73 r=10.87 f=14.71 
lr=1.21e-05 gn=1.70 time=11s. 

2023-07-12 17:49:20 | INFO | train | saving log: valid_21_168.json
2023-07-12 17:49:22 | INFO | train | saving log: test_21_168.json
2023-07-12 17:49:22 | INFO | jlogger | Epoch=21 upd=168/400 
[train] loss=5.6108 loss_span=2.7473 loss_node=28.6352 
[valid] loss=1.4063 loss_span=0.9528 loss_node=4.5356 p=44.00 r=28.21 f=34.38 
[test]  loss=1.6325 loss_span=1.2301 loss_node=4.0237 p=42.86 r=19.57 f=26.87 
lr=1.17e-05 gn=2.41 time=11s. 

2023-07-12 17:49:31 | INFO | train | saving log: valid_22_176.json
2023-07-12 17:49:33 | INFO | train | saving log: test_22_176.json
2023-07-12 17:49:33 | INFO | jlogger | Epoch=22 upd=176/400 
[train] loss=5.1650 loss_span=2.4916 loss_node=26.7342 
[valid] loss=1.5659 loss_span=1.1179 loss_node=4.4802 p=36.00 r=23.08 f=28.12 
[test]  loss=1.6566 loss_span=1.2590 loss_node=3.9757 p=33.33 r=8.70 f=13.79 
lr=1.13e-05 gn=1.54 time=11s. 

2023-07-12 17:49:42 | INFO | train | saving log: valid_23_184.json
2023-07-12 17:49:45 | INFO | train | saving log: test_23_184.json
2023-07-12 17:49:45 | INFO | jlogger | Epoch=23 upd=184/400 
[train] loss=4.9751 loss_span=2.3239 loss_node=26.5116 
[valid] loss=1.3935 loss_span=0.9563 loss_node=4.3715 p=41.94 r=33.33 f=37.14 
[test]  loss=1.6219 loss_span=1.2301 loss_node=3.9176 p=42.31 r=23.91 f=30.56 
lr=1.09e-05 gn=1.67 time=12s. 

2023-07-12 17:49:53 | INFO | train | saving log: valid_24_192.json
2023-07-12 17:49:56 | INFO | train | saving log: test_24_192.json
2023-07-12 17:49:56 | INFO | jlogger | Epoch=24 upd=192/400 
[train] loss=4.8641 loss_span=2.2652 loss_node=25.9892 
[valid] loss=1.4079 loss_span=0.9790 loss_node=4.2895 p=50.00 r=30.77 f=38.10 
[test]  loss=1.5555 loss_span=1.1682 loss_node=3.8731 p=41.67 r=10.87 f=17.24 
lr=1.05e-05 gn=1.87 time=11s. 

2023-07-12 17:50:05 | INFO | train | saving log: valid_25_200.json
2023-07-12 17:50:07 | INFO | train | saving log: test_25_200.json
2023-07-12 17:50:07 | INFO | jlogger | Epoch=25 upd=200/400 
[train] loss=4.7431 loss_span=2.0952 loss_node=26.4795 
[valid] loss=1.3929 loss_span=0.9637 loss_node=4.2916 p=38.24 r=33.33 f=35.62 
[test]  loss=1.6070 loss_span=1.2167 loss_node=3.9027 p=43.33 r=28.26 f=34.21 
lr=1.01e-05 gn=1.93 time=11s. 

2023-07-12 17:50:16 | INFO | train | saving log: valid_26_208.json
2023-07-12 17:50:19 | INFO | train | saving log: test_26_208.json
2023-07-12 17:50:19 | INFO | jlogger | Epoch=26 upd=208/400 
[train] loss=4.6339 loss_span=1.9522 loss_node=26.8170 
[valid] loss=1.4583 loss_span=1.0293 loss_node=4.2899 p=44.83 r=33.33 f=38.24 
[test]  loss=1.5767 loss_span=1.1858 loss_node=3.9099 p=28.57 r=13.04 f=17.91 
lr=9.70e-06 gn=1.54 time=11s. 

2023-07-12 17:50:27 | INFO | train | saving log: valid_27_216.json
2023-07-12 17:50:30 | INFO | train | saving log: test_27_216.json
2023-07-12 17:50:30 | INFO | jlogger | Epoch=27 upd=216/400 
[train] loss=4.5184 loss_span=1.9031 loss_node=26.1523 
[valid] loss=1.2697 loss_span=0.8430 loss_node=4.2668 p=48.48 r=41.03 f=44.44 
[test]  loss=1.5446 loss_span=1.1547 loss_node=3.8983 p=37.14 r=28.26 f=32.10 
lr=9.29e-06 gn=1.47 time=11s. 

2023-07-12 17:50:39 | INFO | train | saving log: valid_28_224.json
2023-07-12 17:50:41 | INFO | train | saving log: test_28_224.json
2023-07-12 17:50:41 | INFO | jlogger | Epoch=28 upd=224/400 
[train] loss=4.5545 loss_span=1.9580 loss_node=25.9656 
[valid] loss=1.3617 loss_span=0.9371 loss_node=4.2464 p=43.75 r=35.90 f=39.44 
[test]  loss=1.5958 loss_span=1.2071 loss_node=3.8865 p=36.67 r=23.91 f=28.95 
lr=8.89e-06 gn=3.74 time=11s. 

2023-07-12 17:50:50 | INFO | train | saving log: valid_29_232.json
2023-07-12 17:50:52 | INFO | train | saving log: test_29_232.json
2023-07-12 17:50:52 | INFO | jlogger | Epoch=29 upd=232/400 
[train] loss=4.2936 loss_span=1.8104 loss_node=24.8321 
[valid] loss=1.3562 loss_span=0.9341 loss_node=4.2207 p=50.00 r=33.33 f=40.00 
[test]  loss=1.5315 loss_span=1.1429 loss_node=3.8858 p=22.22 r=8.70 f=12.50 
lr=8.48e-06 gn=1.90 time=11s. 

2023-07-12 17:51:01 | INFO | train | saving log: valid_30_240.json
2023-07-12 17:51:04 | INFO | train | saving log: test_30_240.json
2023-07-12 17:51:04 | INFO | jlogger | Epoch=30 upd=240/400 
[train] loss=4.4041 loss_span=1.7395 loss_node=26.6458 
[valid] loss=1.3180 loss_span=0.8976 loss_node=4.2044 p=41.18 r=35.90 f=38.36 
[test]  loss=1.5928 loss_span=1.2042 loss_node=3.8861 p=32.26 r=21.74 f=25.97 
lr=8.08e-06 gn=3.35 time=11s. 

2023-07-12 17:51:13 | INFO | train | saving log: valid_31_248.json
2023-07-12 17:51:15 | INFO | train | saving log: test_31_248.json
2023-07-12 17:51:15 | INFO | jlogger | Epoch=31 upd=248/400 
[train] loss=4.1960 loss_span=1.5973 loss_node=25.9872 
[valid] loss=1.3300 loss_span=0.9139 loss_node=4.1611 p=41.18 r=35.90 f=38.36 
[test]  loss=1.5259 loss_span=1.1406 loss_node=3.8532 p=39.29 r=23.91 f=29.73 
lr=7.68e-06 gn=2.74 time=11s. 

2023-07-12 17:51:24 | INFO | train | saving log: valid_32_256.json
2023-07-12 17:51:26 | INFO | train | saving log: test_32_256.json
2023-07-12 17:51:26 | INFO | jlogger | Epoch=32 upd=256/400 
[train] loss=4.0820 loss_span=1.6290 loss_node=24.5305 
[valid] loss=1.3310 loss_span=0.9214 loss_node=4.0967 p=48.28 r=35.90 f=41.18 
[test]  loss=1.5045 loss_span=1.1233 loss_node=3.8124 p=34.78 r=17.39 f=23.19 
lr=7.27e-06 gn=1.94 time=11s. 

2023-07-12 17:51:36 | INFO | train | saving log: valid_33_264.json
2023-07-12 17:51:38 | INFO | train | saving log: test_33_264.json
2023-07-12 17:51:38 | INFO | jlogger | Epoch=33 upd=264/400 
[train] loss=4.1025 loss_span=1.4982 loss_node=26.0435 
[valid] loss=1.2785 loss_span=0.8693 loss_node=4.0914 p=46.88 r=38.46 f=42.25 
[test]  loss=1.5243 loss_span=1.1430 loss_node=3.8130 p=40.62 r=28.26 f=33.33 
lr=6.87e-06 gn=1.45 time=12s. 

2023-07-12 17:51:47 | INFO | train | saving log: valid_34_272.json
2023-07-12 17:51:50 | INFO | train | saving log: test_34_272.json
2023-07-12 17:51:50 | INFO | jlogger | Epoch=34 upd=272/400 
[train] loss=4.0002 loss_span=1.5052 loss_node=24.9500 
[valid] loss=1.3308 loss_span=0.9200 loss_node=4.1086 p=51.72 r=38.46 f=44.12 
[test]  loss=1.5606 loss_span=1.1769 loss_node=3.8370 p=26.92 r=15.22 f=19.44 
lr=6.46e-06 gn=1.81 time=11s. 

2023-07-12 17:51:59 | INFO | train | saving log: valid_35_280.json
2023-07-12 17:52:01 | INFO | train | saving log: test_35_280.json
2023-07-12 17:52:01 | INFO | jlogger | Epoch=35 upd=280/400 
[train] loss=3.9494 loss_span=1.4161 loss_node=25.3323 
[valid] loss=1.2552 loss_span=0.8429 loss_node=4.1227 p=53.57 r=38.46 f=44.78 
[test]  loss=1.5094 loss_span=1.1238 loss_node=3.8564 p=38.71 r=26.09 f=31.17 
lr=6.06e-06 gn=1.44 time=11s. 

2023-07-12 17:52:10 | INFO | train | saving log: valid_36_288.json
2023-07-12 17:52:13 | INFO | train | saving log: test_36_288.json
2023-07-12 17:52:13 | INFO | jlogger | Epoch=36 upd=288/400 
[train] loss=3.9310 loss_span=1.4344 loss_node=24.9666 
[valid] loss=1.3179 loss_span=0.9061 loss_node=4.1180 p=53.57 r=38.46 f=44.78 
[test]  loss=1.5505 loss_span=1.1639 loss_node=3.8659 p=31.03 r=19.57 f=24.00 
lr=5.66e-06 gn=1.77 time=11s. 

2023-07-12 17:52:22 | INFO | train | saving log: valid_37_296.json
2023-07-12 17:52:24 | INFO | train | saving log: test_37_296.json
2023-07-12 17:52:24 | INFO | jlogger | Epoch=37 upd=296/400 
[train] loss=3.8585 loss_span=1.4437 loss_node=24.1480 
[valid] loss=1.3181 loss_span=0.9071 loss_node=4.1103 p=55.56 r=38.46 f=45.45 
[test]  loss=1.5283 loss_span=1.1413 loss_node=3.8705 p=31.25 r=21.74 f=25.64 
lr=5.25e-06 gn=4.24 time=11s. 

2023-07-12 17:52:34 | INFO | train | saving log: valid_38_304.json
2023-07-12 17:52:36 | INFO | train | saving log: test_38_304.json
2023-07-12 17:52:36 | INFO | jlogger | Epoch=38 upd=304/400 
[train] loss=3.7804 loss_span=1.3458 loss_node=24.3458 
[valid] loss=1.3248 loss_span=0.9157 loss_node=4.0905 p=53.57 r=38.46 f=44.78 
[test]  loss=1.4669 loss_span=1.0803 loss_node=3.8652 p=35.71 r=21.74 f=27.03 
lr=4.85e-06 gn=1.93 time=12s. 

2023-07-12 17:52:45 | INFO | train | saving log: valid_39_312.json
2023-07-12 17:52:48 | INFO | train | saving log: test_39_312.json
2023-07-12 17:52:48 | INFO | jlogger | Epoch=39 upd=312/400 
[train] loss=3.8428 loss_span=1.3395 loss_node=25.0331 
[valid] loss=1.3291 loss_span=0.9211 loss_node=4.0798 p=60.00 r=38.46 f=46.88 
[test]  loss=1.5128 loss_span=1.1260 loss_node=3.8685 p=37.04 r=21.74 f=27.40 
lr=4.44e-06 gn=2.32 time=11s. 

2023-07-12 17:52:57 | INFO | train | saving log: valid_40_320.json
2023-07-12 17:53:00 | INFO | train | saving log: test_40_320.json
2023-07-12 17:53:00 | INFO | jlogger | Epoch=40 upd=320/400 
[train] loss=3.7756 loss_span=1.3466 loss_node=24.2904 
[valid] loss=1.2920 loss_span=0.8859 loss_node=4.0612 p=50.00 r=38.46 f=43.48 
[test]  loss=1.4801 loss_span=1.0933 loss_node=3.8682 p=37.84 r=30.43 f=33.73 
lr=4.04e-06 gn=1.84 time=12s. 

2023-07-12 17:53:09 | INFO | train | saving log: valid_41_328.json
2023-07-12 17:53:11 | INFO | train | saving log: test_41_328.json
2023-07-12 17:53:11 | INFO | jlogger | Epoch=41 upd=328/400 
[train] loss=3.7668 loss_span=1.3005 loss_node=24.6635 
[valid] loss=1.3167 loss_span=0.9129 loss_node=4.0384 p=53.57 r=38.46 f=44.78 
[test]  loss=1.4738 loss_span=1.0884 loss_node=3.8535 p=40.74 r=23.91 f=30.14 
lr=3.64e-06 gn=2.07 time=12s. 

2023-07-12 17:53:21 | INFO | train | saving log: valid_42_336.json
2023-07-12 17:53:23 | INFO | train | saving log: test_42_336.json
2023-07-12 17:53:23 | INFO | jlogger | Epoch=42 upd=336/400 
[train] loss=3.9380 loss_span=1.3318 loss_node=26.0624 
[valid] loss=1.2749 loss_span=0.8732 loss_node=4.0174 p=53.57 r=38.46 f=44.78 
[test]  loss=1.4266 loss_span=1.0436 loss_node=3.8301 p=44.83 r=28.26 f=34.67 
lr=3.23e-06 gn=2.43 time=11s. 

2023-07-12 17:53:32 | INFO | train | saving log: valid_43_344.json
2023-07-12 17:53:35 | INFO | train | saving log: test_43_344.json
2023-07-12 17:53:35 | INFO | jlogger | Epoch=43 upd=344/400 
[train] loss=3.7801 loss_span=1.2952 loss_node=24.8485 
[valid] loss=1.3283 loss_span=0.9280 loss_node=4.0037 p=53.57 r=38.46 f=44.78 
[test]  loss=1.4845 loss_span=1.1034 loss_node=3.8108 p=36.00 r=19.57 f=25.35 
lr=2.83e-06 gn=1.35 time=11s. 

2023-07-12 17:53:43 | INFO | train | saving log: valid_44_352.json
2023-07-12 17:53:46 | INFO | train | saving log: test_44_352.json
2023-07-12 17:53:46 | INFO | jlogger | Epoch=44 upd=352/400 
[train] loss=3.6565 loss_span=1.2187 loss_node=24.3788 
[valid] loss=1.2882 loss_span=0.8888 loss_node=3.9938 p=53.57 r=38.46 f=44.78 
[test]  loss=1.4604 loss_span=1.0803 loss_node=3.8007 p=39.29 r=23.91 f=29.73 
lr=2.42e-06 gn=1.50 time=11s. 

2023-07-12 17:53:54 | INFO | train | saving log: valid_45_360.json
2023-07-12 17:53:56 | INFO | train | saving log: test_45_360.json
2023-07-12 17:53:56 | INFO | jlogger | Epoch=45 upd=360/400 
[train] loss=3.5971 loss_span=1.1877 loss_node=24.0935 
[valid] loss=1.2849 loss_span=0.8866 loss_node=3.9823 p=51.72 r=38.46 f=44.12 
[test]  loss=1.4650 loss_span=1.0853 loss_node=3.7961 p=40.62 r=28.26 f=33.33 
lr=2.02e-06 gn=1.69 time=11s. 

2023-07-12 17:54:05 | INFO | train | saving log: valid_46_368.json
2023-07-12 17:54:08 | INFO | train | saving log: test_46_368.json
2023-07-12 17:54:08 | INFO | jlogger | Epoch=46 upd=368/400 
[train] loss=3.7020 loss_span=1.1933 loss_node=25.0870 
[valid] loss=1.3040 loss_span=0.9053 loss_node=3.9871 p=57.69 r=38.46 f=46.15 
[test]  loss=1.4925 loss_span=1.1124 loss_node=3.8006 p=37.04 r=21.74 f=27.40 
lr=1.62e-06 gn=1.93 time=11s. 

2023-07-12 17:54:17 | INFO | train | saving log: valid_47_376.json
2023-07-12 17:54:19 | INFO | train | saving log: test_47_376.json
2023-07-12 17:54:19 | INFO | jlogger | Epoch=47 upd=376/400 
[train] loss=3.6314 loss_span=1.1771 loss_node=24.5439 
[valid] loss=1.2874 loss_span=0.8879 loss_node=3.9955 p=53.57 r=38.46 f=44.78 
[test]  loss=1.4707 loss_span=1.0901 loss_node=3.8059 p=39.29 r=23.91 f=29.73 
lr=1.21e-06 gn=1.05 time=11s. 

2023-07-12 17:54:28 | INFO | train | saving log: valid_48_384.json
2023-07-12 17:54:31 | INFO | train | saving log: test_48_384.json
2023-07-12 17:54:31 | INFO | jlogger | Epoch=48 upd=384/400 
[train] loss=3.6693 loss_span=1.2231 loss_node=24.4626 
[valid] loss=1.2762 loss_span=0.8766 loss_node=3.9963 p=53.57 r=38.46 f=44.78 
[test]  loss=1.4593 loss_span=1.0789 loss_node=3.8046 p=43.33 r=28.26 f=34.21 
lr=8.08e-07 gn=2.08 time=11s. 

2023-07-12 17:54:39 | INFO | train | saving log: valid_49_392.json
2023-07-12 17:54:42 | INFO | train | saving log: test_49_392.json
2023-07-12 17:54:42 | INFO | jlogger | Epoch=49 upd=392/400 
[train] loss=3.5681 loss_span=1.1634 loss_node=24.0462 
[valid] loss=1.2777 loss_span=0.8783 loss_node=3.9939 p=53.57 r=38.46 f=44.78 
[test]  loss=1.4579 loss_span=1.0777 loss_node=3.8022 p=41.38 r=26.09 f=32.00 
lr=4.04e-07 gn=1.98 time=11s. 

2023-07-12 17:54:51 | INFO | train | saving log: valid_50_400.json
2023-07-12 17:54:53 | INFO | train | saving log: test_50_400.json
2023-07-12 17:54:53 | INFO | jlogger | Epoch=50 upd=400/400 
[train] loss=3.6593 loss_span=1.1586 loss_node=25.0070 
[valid] loss=1.2798 loss_span=0.8804 loss_node=3.9933 p=53.57 r=38.46 f=44.78 
[test]  loss=1.4590 loss_span=1.0789 loss_node=3.8016 p=41.38 r=26.09 f=32.00 
lr=0.00e+00 gn=1.35 time=11s. 

2023-07-12 17:54:53 | INFO | jlogger | 
Best valid scores: p=60.0 r=38.46 f=46.88 
Best test scores by valid: p=37.04 r=21.74 f=27.4 
Best test scores: p=44.83 r=28.26 f=34.67 

2023-07-12 18:12:12 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 18:12:14 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-12 18:12:14 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-12 18:12:14 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-12 18:12:14 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-12 18:14:26 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-12 18:15:59 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-12 18:16:02 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-12 19:29:17 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 19:29:18 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-12 19:29:18 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-12 19:29:18 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-12 19:29:18 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-12 19:30:35 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-12 19:31:58 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-12 19:31:59 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-12 19:33:24 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-12 19:33:24 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-12 19:34:24 | INFO | train | Using char encoder (char ids):   [Train] total=583519 unk=0 ratio=0.0%  [Valid] total=71514 unk=2 ratio=0.0%  [Test] total=79342 unk=0 ratio=0.0%
2023-07-12 19:34:24 | INFO | train | Using word encoder (word ids):   [Train] total=139524 unk=515 ratio=0.37%  [Valid] total=17150 unk=64 ratio=0.37%  [Test] total=18720 unk=69 ratio=0.37%
2023-07-12 19:34:28 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log 2023-07-12 19:34:28
2023-07-12 21:02:20 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 21:02:21 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-12 21:02:21 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-12 21:02:21 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-12 21:02:21 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-12 21:03:42 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-12 21:04:57 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-12 21:04:58 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-12 21:06:40 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-12 21:06:40 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-12 21:07:41 | INFO | train | Using char encoder (char ids):   [Train] total=583519 unk=0 ratio=0.0%  [Valid] total=71514 unk=2 ratio=0.0%  [Test] total=79342 unk=0 ratio=0.0%
2023-07-12 21:07:42 | INFO | train | Using word encoder (word ids):   [Train] total=139524 unk=515 ratio=0.37%  [Valid] total=17150 unk=64 ratio=0.37%  [Test] total=18720 unk=69 ratio=0.37%
2023-07-12 21:07:46 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log 2023-07-12 21:07:46
2023-07-12 21:18:05 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 21:18:06 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-12 21:18:06 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-12 21:18:06 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-12 21:18:06 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-12 21:18:06 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-12 21:18:06 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-12 21:18:06 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-12 21:18:07 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-12 21:18:07 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-12 21:18:23 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-12 21:18:23 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-12 21:18:27 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log 2023-07-12 21:18:27
2023-07-12 21:18:38 | INFO | train | saving log: valid_1_8.json
2023-07-12 21:18:40 | INFO | train | saving log: test_1_8.json
2023-07-12 21:18:40 | INFO | jlogger | Epoch=1 upd=8/400 
[train] loss=60.3628 loss_span=41.8290 loss_node=185.3375 
[valid] loss=10.6378 loss_span=4.1535 loss_node=64.8432 p=58.33 r=17.95 f=27.45 
[test]  loss=6.9205 loss_span=4.6031 loss_node=23.1741 p=28.57 r=4.35 f=7.55 
lr=1.98e-05 gn=5.00 time=13s. 

2023-07-12 21:18:49 | INFO | train | saving log: valid_2_16.json
2023-07-12 21:18:52 | INFO | train | saving log: test_2_16.json
2023-07-12 21:18:52 | INFO | jlogger | Epoch=2 upd=16/400 
[train] loss=34.5214 loss_span=19.4983 loss_node=150.2312 
[valid] loss=7.6125 loss_span=2.2000 loss_node=54.1253 p=58.33 r=17.95 f=27.45 
[test]  loss=3.9613 loss_span=2.0682 loss_node=18.9307 p=25.00 r=4.35 f=7.41 
lr=1.94e-05 gn=5.00 time=11s. 

2023-07-12 21:19:01 | INFO | train | saving log: valid_3_24.json
2023-07-12 21:19:04 | INFO | train | saving log: test_3_24.json
2023-07-12 21:19:04 | INFO | jlogger | Epoch=3 upd=24/400 
[train] loss=23.5262 loss_span=11.1538 loss_node=123.7241 
[valid] loss=6.2305 loss_span=1.8100 loss_node=44.2051 p=58.33 r=17.95 f=27.45 
[test]  loss=3.3432 loss_span=1.8436 loss_node=14.9951 p=28.57 r=4.35 f=7.55 
lr=1.90e-05 gn=5.00 time=12s. 

2023-07-12 21:19:13 | INFO | train | saving log: valid_4_32.json
2023-07-12 21:19:15 | INFO | train | saving log: test_4_32.json
2023-07-12 21:19:15 | INFO | jlogger | Epoch=4 upd=32/400 
[train] loss=20.6159 loss_span=10.0884 loss_node=105.2750 
[valid] loss=5.0695 loss_span=1.7040 loss_node=33.6550 p=50.00 r=15.38 f=23.53 
[test]  loss=2.9918 loss_span=1.8563 loss_node=11.3553 p=28.57 r=4.35 f=7.55 
lr=1.86e-05 gn=1.71 time=11s. 

2023-07-12 21:24:49 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 21:24:50 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-12 21:24:50 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-12 21:24:50 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-12 21:24:50 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-12 21:24:50 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-12 21:24:50 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-12 21:24:50 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-12 21:24:51 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-12 21:24:51 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-12 21:25:05 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-12 21:25:05 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-12 21:25:09 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log 2023-07-12 21:25:09
2023-07-12 21:25:19 | INFO | train | saving log: valid_1_8.json
2023-07-12 21:25:22 | INFO | train | saving log: test_1_8.json
2023-07-12 21:25:22 | INFO | jlogger | Epoch=1 upd=8/400 
[train] loss=59.0989 loss_span=40.1312 loss_node=189.6765 
[valid] loss=10.9078 loss_span=4.2071 loss_node=67.0066 p=58.33 r=17.95 f=27.45 
[test]  loss=6.4372 loss_span=4.0288 loss_node=24.0847 p=28.57 r=4.35 f=7.55 
lr=1.98e-05 gn=5.00 time=13s. 

2023-07-12 21:25:32 | INFO | train | saving log: valid_2_16.json
2023-07-12 21:25:34 | INFO | train | saving log: test_2_16.json
2023-07-12 21:25:34 | INFO | jlogger | Epoch=2 upd=16/400 
[train] loss=32.6174 loss_span=16.9143 loss_node=157.0308 
[valid] loss=7.7930 loss_span=2.1204 loss_node=56.7263 p=58.33 r=17.95 f=27.45 
[test]  loss=4.0079 loss_span=2.0037 loss_node=20.0418 p=28.57 r=4.35 f=7.55 
lr=1.94e-05 gn=5.00 time=12s. 

2023-07-12 21:25:44 | INFO | train | saving log: valid_3_24.json
2023-07-12 21:25:46 | INFO | train | saving log: test_3_24.json
2023-07-12 21:25:46 | INFO | jlogger | Epoch=3 upd=24/400 
[train] loss=23.9710 loss_span=11.0623 loss_node=129.0866 
[valid] loss=6.5940 loss_span=1.9948 loss_node=45.9918 p=58.33 r=17.95 f=27.45 
[test]  loss=3.5590 loss_span=1.9999 loss_node=15.5910 p=28.57 r=4.35 f=7.55 
lr=1.90e-05 gn=3.81 time=12s. 

2023-07-12 21:25:55 | INFO | train | saving log: valid_4_32.json
2023-07-12 21:25:58 | INFO | train | saving log: test_4_32.json
2023-07-12 21:25:58 | INFO | jlogger | Epoch=4 upd=32/400 
[train] loss=20.8927 loss_span=9.9907 loss_node=109.0198 
[valid] loss=5.2574 loss_span=1.7331 loss_node=35.2438 p=50.00 r=15.38 f=23.53 
[test]  loss=3.0278 loss_span=1.8425 loss_node=11.8536 p=28.57 r=4.35 f=7.55 
lr=1.86e-05 gn=2.81 time=11s. 

2023-07-12 21:26:07 | INFO | train | saving log: valid_5_40.json
2023-07-12 21:26:09 | INFO | train | saving log: test_5_40.json
2023-07-12 21:26:09 | INFO | jlogger | Epoch=5 upd=40/400 
[train] loss=16.1745 loss_span=8.6780 loss_node=74.9647 
[valid] loss=4.2347 loss_span=1.5717 loss_node=26.6303 p=50.00 r=15.38 f=23.53 
[test]  loss=2.6167 loss_span=1.7433 loss_node=8.7336 p=28.57 r=4.35 f=7.55 
lr=1.82e-05 gn=1.84 time=12s. 

2023-07-12 21:26:18 | INFO | train | saving log: valid_6_48.json
2023-07-12 21:26:21 | INFO | train | saving log: test_6_48.json
2023-07-12 21:26:21 | INFO | jlogger | Epoch=6 upd=48/400 
[train] loss=14.1771 loss_span=7.6664 loss_node=65.1062 
[valid] loss=3.2918 loss_span=1.4057 loss_node=18.8613 p=66.67 r=20.51 f=31.37 
[test]  loss=2.1776 loss_span=1.5715 loss_node=6.0615 p=37.50 r=6.52 f=11.11 
lr=1.78e-05 gn=2.88 time=11s. 

2023-07-12 21:26:30 | INFO | train | saving log: valid_7_56.json
2023-07-12 21:26:32 | INFO | train | saving log: test_7_56.json
2023-07-12 21:26:32 | INFO | jlogger | Epoch=7 upd=56/400 
[train] loss=11.5514 loss_span=6.9145 loss_node=46.3693 
[valid] loss=2.6165 loss_span=1.2734 loss_node=13.4314 p=66.67 r=20.51 f=31.37 
[test]  loss=1.9103 loss_span=1.4398 loss_node=4.7050 p=37.50 r=6.52 f=11.11 
lr=1.74e-05 gn=1.30 time=11s. 

2023-07-12 21:26:41 | INFO | train | saving log: valid_8_64.json
2023-07-12 21:26:44 | INFO | train | saving log: test_8_64.json
2023-07-12 21:26:44 | INFO | jlogger | Epoch=8 upd=64/400 
[train] loss=9.9419 loss_span=6.2939 loss_node=36.4801 
[valid] loss=2.2276 loss_span=1.1803 loss_node=10.4727 p=60.00 r=15.38 f=24.49 
[test]  loss=1.7941 loss_span=1.3644 loss_node=4.2974 p=37.50 r=6.52 f=11.11 
lr=1.70e-05 gn=1.78 time=12s. 

2023-07-12 21:26:53 | INFO | train | saving log: valid_9_72.json
2023-07-12 21:26:55 | INFO | train | saving log: test_9_72.json
2023-07-12 21:26:55 | INFO | jlogger | Epoch=9 upd=72/400 
[train] loss=9.1813 loss_span=5.6249 loss_node=35.5645 
[valid] loss=1.9867 loss_span=1.1900 loss_node=7.9667 p=50.00 r=10.26 f=17.02 
[test]  loss=1.7316 loss_span=1.3102 loss_node=4.2132 p=37.50 r=6.52 f=11.11 
lr=1.66e-05 gn=2.54 time=11s. 

2023-07-12 21:27:04 | INFO | train | saving log: valid_10_80.json
2023-07-12 21:27:06 | INFO | train | saving log: test_10_80.json
2023-07-12 21:27:06 | INFO | jlogger | Epoch=10 upd=80/400 
[train] loss=7.9190 loss_span=4.9487 loss_node=29.7026 
[valid] loss=1.7062 loss_span=1.0732 loss_node=6.3304 p=42.11 r=20.51 f=27.59 
[test]  loss=1.7762 loss_span=1.3569 loss_node=4.1936 p=22.22 r=8.70 f=12.50 
lr=1.62e-05 gn=2.95 time=11s. 

2023-07-12 21:27:15 | INFO | train | saving log: valid_11_88.json
2023-07-12 21:27:18 | INFO | train | saving log: test_11_88.json
2023-07-12 21:27:18 | INFO | jlogger | Epoch=11 upd=88/400 
[train] loss=7.7061 loss_span=4.7107 loss_node=29.9537 
[valid] loss=1.6742 loss_span=1.1268 loss_node=5.4742 p=36.84 r=17.95 f=24.14 
[test]  loss=1.7340 loss_span=1.3136 loss_node=4.2043 p=33.33 r=6.52 f=10.91 
lr=1.58e-05 gn=2.91 time=11s. 

2023-07-12 21:27:27 | INFO | train | saving log: valid_12_96.json
2023-07-12 21:27:29 | INFO | train | saving log: test_12_96.json
2023-07-12 21:27:29 | INFO | jlogger | Epoch=12 upd=96/400 
[train] loss=7.6205 loss_span=4.6176 loss_node=30.0288 
[valid] loss=1.5142 loss_span=0.9875 loss_node=5.2666 p=30.43 r=17.95 f=22.58 
[test]  loss=1.6812 loss_span=1.2577 loss_node=4.2346 p=13.33 r=4.35 f=6.56 
lr=1.54e-05 gn=2.26 time=11s. 

2023-07-12 21:27:38 | INFO | train | saving log: valid_13_104.json
2023-07-12 21:27:41 | INFO | train | saving log: test_13_104.json
2023-07-12 21:27:41 | INFO | jlogger | Epoch=13 upd=104/400 
[train] loss=7.1848 loss_span=4.2838 loss_node=29.0101 
[valid] loss=1.5010 loss_span=0.9897 loss_node=5.1133 p=47.37 r=23.08 f=31.03 
[test]  loss=1.6523 loss_span=1.2340 loss_node=4.1828 p=16.67 r=4.35 f=6.90 
lr=1.49e-05 gn=4.44 time=11s. 

2023-07-12 21:27:49 | INFO | train | saving log: valid_14_112.json
2023-07-12 21:27:52 | INFO | train | saving log: test_14_112.json
2023-07-12 21:27:52 | INFO | jlogger | Epoch=14 upd=112/400 
[train] loss=7.0511 loss_span=4.1336 loss_node=29.1755 
[valid] loss=1.5736 loss_span=1.0757 loss_node=4.9794 p=75.00 r=15.38 f=25.53 
[test]  loss=1.6401 loss_span=1.2272 loss_node=4.1292 p=25.00 r=2.17 f=4.00 
lr=1.45e-05 gn=3.80 time=11s. 

2023-07-12 21:28:01 | INFO | train | saving log: valid_15_120.json
2023-07-12 21:28:03 | INFO | train | saving log: test_15_120.json
2023-07-12 21:28:03 | INFO | jlogger | Epoch=15 upd=120/400 
[train] loss=6.8302 loss_span=4.1256 loss_node=27.0453 
[valid] loss=1.5371 loss_span=1.0522 loss_node=4.8492 p=61.54 r=20.51 f=30.77 
[test]  loss=1.6678 loss_span=1.2585 loss_node=4.0929 p=0.00 r=0.00 f=0.00 
lr=1.41e-05 gn=2.07 time=11s. 

2023-07-12 21:28:12 | INFO | train | saving log: valid_16_128.json
2023-07-12 21:28:14 | INFO | train | saving log: test_16_128.json
2023-07-12 21:28:14 | INFO | jlogger | Epoch=16 upd=128/400 
[train] loss=6.5755 loss_span=3.7539 loss_node=28.2165 
[valid] loss=1.5905 loss_span=1.1122 loss_node=4.7828 p=81.82 r=23.08 f=36.00 
[test]  loss=1.6225 loss_span=1.2138 loss_node=4.0872 p=40.00 r=4.35 f=7.84 
lr=1.37e-05 gn=2.05 time=11s. 

2023-07-12 21:28:24 | INFO | train | saving log: valid_17_136.json
2023-07-12 21:28:26 | INFO | train | saving log: test_17_136.json
2023-07-12 21:28:26 | INFO | jlogger | Epoch=17 upd=136/400 
[train] loss=6.3987 loss_span=3.6208 loss_node=27.7795 
[valid] loss=1.4062 loss_span=0.9302 loss_node=4.7604 p=45.00 r=23.08 f=30.51 
[test]  loss=1.5671 loss_span=1.1590 loss_node=4.0808 p=25.00 r=6.52 f=10.34 
lr=1.33e-05 gn=1.84 time=11s. 

2023-07-12 21:28:35 | INFO | train | saving log: valid_18_144.json
2023-07-12 21:28:38 | INFO | train | saving log: test_18_144.json
2023-07-12 21:28:38 | INFO | jlogger | Epoch=18 upd=144/400 
[train] loss=6.0317 loss_span=3.4235 loss_node=26.0827 
[valid] loss=1.3681 loss_span=0.9024 loss_node=4.6568 p=41.67 r=25.64 f=31.75 
[test]  loss=1.5357 loss_span=1.1330 loss_node=4.0269 p=21.43 r=6.52 f=10.00 
lr=1.29e-05 gn=2.30 time=12s. 

2023-07-12 21:28:47 | INFO | train | saving log: valid_19_152.json
2023-07-12 21:28:50 | INFO | train | saving log: test_19_152.json
2023-07-12 21:28:50 | INFO | jlogger | Epoch=19 upd=152/400 
[train] loss=5.8041 loss_span=3.0938 loss_node=27.1033 
[valid] loss=1.4076 loss_span=0.9538 loss_node=4.5383 p=50.00 r=23.08 f=31.58 
[test]  loss=1.5308 loss_span=1.1333 loss_node=3.9752 p=33.33 r=4.35 f=7.69 
lr=1.25e-05 gn=3.63 time=11s. 

2023-07-12 21:28:59 | INFO | train | saving log: valid_20_160.json
2023-07-12 21:29:01 | INFO | train | saving log: test_20_160.json
2023-07-12 21:29:01 | INFO | jlogger | Epoch=20 upd=160/400 
[train] loss=5.5497 loss_span=2.9045 loss_node=26.4522 
[valid] loss=1.3701 loss_span=0.9218 loss_node=4.4829 p=76.92 r=25.64 f=38.46 
[test]  loss=1.5060 loss_span=1.1088 loss_node=3.9720 p=16.67 r=2.17 f=3.85 
lr=1.21e-05 gn=1.92 time=11s. 

2023-07-12 21:29:10 | INFO | train | saving log: valid_21_168.json
2023-07-12 21:29:13 | INFO | train | saving log: test_21_168.json
2023-07-12 21:29:13 | INFO | jlogger | Epoch=21 upd=168/400 
[train] loss=5.6026 loss_span=2.7496 loss_node=28.5299 
[valid] loss=1.3763 loss_span=0.9253 loss_node=4.5100 p=43.48 r=25.64 f=32.26 
[test]  loss=1.5636 loss_span=1.1627 loss_node=4.0089 p=35.71 r=10.87 f=16.67 
lr=1.17e-05 gn=1.56 time=11s. 

2023-07-12 21:29:22 | INFO | train | saving log: valid_22_176.json
2023-07-12 21:29:24 | INFO | train | saving log: test_22_176.json
2023-07-12 21:29:24 | INFO | jlogger | Epoch=22 upd=176/400 
[train] loss=5.3019 loss_span=2.6429 loss_node=26.5897 
[valid] loss=1.3357 loss_span=0.8897 loss_node=4.4595 p=48.00 r=30.77 f=37.50 
[test]  loss=1.5001 loss_span=1.1036 loss_node=3.9655 p=26.67 r=8.70 f=13.11 
lr=1.13e-05 gn=2.28 time=11s. 

2023-07-12 21:29:33 | INFO | train | saving log: valid_23_184.json
2023-07-12 21:29:35 | INFO | train | saving log: test_23_184.json
2023-07-12 21:29:35 | INFO | jlogger | Epoch=23 upd=184/400 
[train] loss=5.0899 loss_span=2.4523 loss_node=26.3761 
[valid] loss=1.3291 loss_span=0.8930 loss_node=4.3611 p=40.74 r=28.21 f=33.33 
[test]  loss=1.5483 loss_span=1.1578 loss_node=3.9056 p=31.58 r=13.04 f=18.46 
lr=1.09e-05 gn=2.64 time=11s. 

2023-07-12 21:29:45 | INFO | train | saving log: valid_24_192.json
2023-07-12 21:29:47 | INFO | train | saving log: test_24_192.json
2023-07-12 21:29:47 | INFO | jlogger | Epoch=24 upd=192/400 
[train] loss=4.9512 loss_span=2.3569 loss_node=25.9428 
[valid] loss=1.3573 loss_span=0.9290 loss_node=4.2836 p=71.43 r=25.64 f=37.74 
[test]  loss=1.5137 loss_span=1.1277 loss_node=3.8602 p=14.29 r=2.17 f=3.77 
lr=1.05e-05 gn=2.23 time=12s. 

2023-07-12 21:29:56 | INFO | train | saving log: valid_25_200.json
2023-07-12 21:29:59 | INFO | train | saving log: test_25_200.json
2023-07-12 21:29:59 | INFO | jlogger | Epoch=25 upd=200/400 
[train] loss=4.8866 loss_span=2.2524 loss_node=26.3422 
[valid] loss=1.3281 loss_span=0.8994 loss_node=4.2869 p=43.75 r=35.90 f=39.44 
[test]  loss=1.5255 loss_span=1.1369 loss_node=3.8856 p=33.33 r=19.57 f=24.66 
lr=1.01e-05 gn=1.86 time=11s. 

2023-07-12 21:30:08 | INFO | train | saving log: valid_26_208.json
2023-07-12 21:30:10 | INFO | train | saving log: test_26_208.json
2023-07-12 21:30:10 | INFO | jlogger | Epoch=26 upd=208/400 
[train] loss=4.8376 loss_span=2.1654 loss_node=26.7219 
[valid] loss=1.3282 loss_span=0.8991 loss_node=4.2912 p=48.15 r=33.33 f=39.39 
[test]  loss=1.4873 loss_span=1.0980 loss_node=3.8930 p=40.00 r=13.04 f=19.67 
lr=9.70e-06 gn=3.25 time=11s. 

2023-07-12 21:30:20 | INFO | train | saving log: valid_27_216.json
2023-07-12 21:30:22 | INFO | train | saving log: test_27_216.json
2023-07-12 21:30:22 | INFO | jlogger | Epoch=27 upd=216/400 
[train] loss=4.5879 loss_span=1.9785 loss_node=26.0937 
[valid] loss=1.2834 loss_span=0.8563 loss_node=4.2703 p=44.12 r=38.46 f=41.10 
[test]  loss=1.4833 loss_span=1.0953 loss_node=3.8794 p=40.00 r=21.74 f=28.17 
lr=9.29e-06 gn=1.45 time=12s. 

2023-07-12 21:30:31 | INFO | train | saving log: valid_28_224.json
2023-07-12 21:30:34 | INFO | train | saving log: test_28_224.json
2023-07-12 21:30:34 | INFO | jlogger | Epoch=28 upd=224/400 
[train] loss=4.5618 loss_span=1.9808 loss_node=25.8098 
[valid] loss=1.3057 loss_span=0.8815 loss_node=4.2427 p=48.15 r=33.33 f=39.39 
[test]  loss=1.4703 loss_span=1.0840 loss_node=3.8636 p=40.00 r=13.04 f=19.67 
lr=8.89e-06 gn=2.28 time=12s. 

2023-07-12 21:30:44 | INFO | train | saving log: valid_29_232.json
2023-07-12 21:30:46 | INFO | train | saving log: test_29_232.json
2023-07-12 21:30:46 | INFO | jlogger | Epoch=29 upd=232/400 
[train] loss=4.4277 loss_span=1.9593 loss_node=24.6840 
[valid] loss=1.2456 loss_span=0.8246 loss_node=4.2101 p=46.67 r=35.90 f=40.58 
[test]  loss=1.4800 loss_span=1.0942 loss_node=3.8586 p=50.00 r=23.91 f=32.35 
lr=8.48e-06 gn=2.65 time=12s. 

2023-07-12 21:30:56 | INFO | train | saving log: valid_30_240.json
2023-07-12 21:30:58 | INFO | train | saving log: test_30_240.json
2023-07-12 21:30:58 | INFO | jlogger | Epoch=30 upd=240/400 
[train] loss=4.4988 loss_span=1.8414 loss_node=26.5747 
[valid] loss=1.2844 loss_span=0.8643 loss_node=4.2006 p=43.75 r=35.90 f=39.44 
[test]  loss=1.4715 loss_span=1.0858 loss_node=3.8566 p=39.13 r=19.57 f=26.09 
lr=8.08e-06 gn=1.50 time=12s. 

2023-07-12 21:31:08 | INFO | train | saving log: valid_31_248.json
2023-07-12 21:31:10 | INFO | train | saving log: test_31_248.json
2023-07-12 21:31:10 | INFO | jlogger | Epoch=31 upd=248/400 
[train] loss=4.2897 loss_span=1.7003 loss_node=25.8944 
[valid] loss=1.2792 loss_span=0.8626 loss_node=4.1659 p=48.39 r=38.46 f=42.86 
[test]  loss=1.5054 loss_span=1.1229 loss_node=3.8244 p=45.45 r=21.74 f=29.41 
lr=7.68e-06 gn=1.84 time=12s. 

2023-07-12 21:31:20 | INFO | train | saving log: valid_32_256.json
2023-07-12 21:31:22 | INFO | train | saving log: test_32_256.json
2023-07-12 21:31:22 | INFO | jlogger | Epoch=32 upd=256/400 
[train] loss=4.0760 loss_span=1.6260 loss_node=24.5000 
[valid] loss=1.2680 loss_span=0.8573 loss_node=4.1071 p=48.39 r=38.46 f=42.86 
[test]  loss=1.4849 loss_span=1.1068 loss_node=3.7811 p=39.29 r=23.91 f=29.73 
lr=7.27e-06 gn=2.02 time=12s. 

2023-07-12 21:31:31 | INFO | train | saving log: valid_33_264.json
2023-07-12 21:31:34 | INFO | train | saving log: test_33_264.json
2023-07-12 21:31:34 | INFO | jlogger | Epoch=33 upd=264/400 
[train] loss=4.1413 loss_span=1.5480 loss_node=25.9330 
[valid] loss=1.2862 loss_span=0.8761 loss_node=4.1019 p=48.28 r=35.90 f=41.18 
[test]  loss=1.5073 loss_span=1.1295 loss_node=3.7771 p=33.33 r=21.74 f=26.32 
lr=6.87e-06 gn=2.46 time=12s. 

2023-07-12 21:31:43 | INFO | train | saving log: valid_34_272.json
2023-07-12 21:31:46 | INFO | train | saving log: test_34_272.json
2023-07-12 21:31:46 | INFO | jlogger | Epoch=34 upd=272/400 
[train] loss=4.0784 loss_span=1.5928 loss_node=24.8564 
[valid] loss=1.2530 loss_span=0.8415 loss_node=4.1157 p=51.72 r=38.46 f=44.12 
[test]  loss=1.4938 loss_span=1.1141 loss_node=3.7966 p=40.74 r=23.91 f=30.14 
lr=6.46e-06 gn=1.53 time=11s. 

2023-07-12 21:31:55 | INFO | train | saving log: valid_35_280.json
2023-07-12 21:31:58 | INFO | train | saving log: test_35_280.json
2023-07-12 21:31:58 | INFO | jlogger | Epoch=35 upd=280/400 
[train] loss=3.9855 loss_span=1.4653 loss_node=25.2027 
[valid] loss=1.2623 loss_span=0.8497 loss_node=4.1264 p=50.00 r=41.03 f=45.07 
[test]  loss=1.4964 loss_span=1.1151 loss_node=3.8129 p=37.14 r=28.26 f=32.10 
lr=6.06e-06 gn=2.33 time=12s. 

2023-07-12 21:32:08 | INFO | train | saving log: valid_36_288.json
2023-07-12 21:32:10 | INFO | train | saving log: test_36_288.json
2023-07-12 21:32:10 | INFO | jlogger | Epoch=36 upd=288/400 
[train] loss=4.0100 loss_span=1.5274 loss_node=24.8264 
[valid] loss=1.2370 loss_span=0.8248 loss_node=4.1219 p=56.00 r=35.90 f=43.75 
[test]  loss=1.4545 loss_span=1.0724 loss_node=3.8208 p=39.29 r=23.91 f=29.73 
lr=5.66e-06 gn=1.96 time=12s. 

2023-07-12 21:32:19 | INFO | train | saving log: valid_37_296.json
2023-07-12 21:32:22 | INFO | train | saving log: test_37_296.json
2023-07-12 21:32:22 | INFO | jlogger | Epoch=37 upd=296/400 
[train] loss=3.9084 loss_span=1.5064 loss_node=24.0201 
[valid] loss=1.2877 loss_span=0.8763 loss_node=4.1140 p=51.85 r=35.90 f=42.42 
[test]  loss=1.4725 loss_span=1.0902 loss_node=3.8224 p=28.00 r=15.22 f=19.72 
lr=5.25e-06 gn=2.02 time=11s. 

2023-07-12 21:32:31 | INFO | train | saving log: valid_38_304.json
2023-07-12 21:32:33 | INFO | train | saving log: test_38_304.json
2023-07-12 21:32:33 | INFO | jlogger | Epoch=38 upd=304/400 
[train] loss=3.8224 loss_span=1.3944 loss_node=24.2799 
[valid] loss=1.2377 loss_span=0.8285 loss_node=4.0919 p=56.25 r=46.15 f=50.70 
[test]  loss=1.4819 loss_span=1.1006 loss_node=3.8123 p=37.93 r=23.91 f=29.33 
lr=4.85e-06 gn=1.51 time=11s. 

2023-07-12 21:32:43 | INFO | train | saving log: valid_39_312.json
2023-07-12 21:32:45 | INFO | train | saving log: test_39_312.json
2023-07-12 21:32:45 | INFO | jlogger | Epoch=39 upd=312/400 
[train] loss=3.9127 loss_span=1.4186 loss_node=24.9415 
[valid] loss=1.2162 loss_span=0.8080 loss_node=4.0821 p=58.06 r=46.15 f=51.43 
[test]  loss=1.5189 loss_span=1.1377 loss_node=3.8119 p=35.48 r=23.91 f=28.57 
lr=4.44e-06 gn=2.14 time=11s. 

2023-07-12 21:32:54 | INFO | train | saving log: valid_40_320.json
2023-07-12 21:32:56 | INFO | train | saving log: test_40_320.json
2023-07-12 21:32:56 | INFO | jlogger | Epoch=40 upd=320/400 
[train] loss=3.8126 loss_span=1.3970 loss_node=24.1564 
[valid] loss=1.2565 loss_span=0.8504 loss_node=4.0608 p=57.69 r=38.46 f=46.15 
[test]  loss=1.5203 loss_span=1.1396 loss_node=3.8072 p=40.00 r=17.39 f=24.24 
lr=4.04e-06 gn=1.70 time=11s. 

2023-07-12 21:33:05 | INFO | train | saving log: valid_41_328.json
2023-07-12 21:33:08 | INFO | train | saving log: test_41_328.json
2023-07-12 21:33:08 | INFO | jlogger | Epoch=41 upd=328/400 
[train] loss=3.7939 loss_span=1.3401 loss_node=24.5379 
[valid] loss=1.2416 loss_span=0.8383 loss_node=4.0326 p=55.17 r=41.03 f=47.06 
[test]  loss=1.5196 loss_span=1.1407 loss_node=3.7891 p=37.93 r=23.91 f=29.33 
lr=3.64e-06 gn=1.17 time=11s. 

2023-07-12 21:33:16 | INFO | train | saving log: valid_42_336.json
2023-07-12 21:33:19 | INFO | train | saving log: test_42_336.json
2023-07-12 21:33:19 | INFO | jlogger | Epoch=42 upd=336/400 
[train] loss=3.8719 loss_span=1.2829 loss_node=25.8895 
[valid] loss=1.2034 loss_span=0.8026 loss_node=4.0081 p=60.71 r=43.59 f=50.75 
[test]  loss=1.5252 loss_span=1.1488 loss_node=3.7640 p=37.50 r=26.09 f=30.77 
lr=3.23e-06 gn=2.14 time=11s. 

2023-07-12 21:33:28 | INFO | train | saving log: valid_43_344.json
2023-07-12 21:33:31 | INFO | train | saving log: test_43_344.json
2023-07-12 21:33:31 | INFO | jlogger | Epoch=43 upd=344/400 
[train] loss=3.7894 loss_span=1.3228 loss_node=24.6664 
[valid] loss=1.2032 loss_span=0.8041 loss_node=3.9907 p=59.26 r=41.03 f=48.48 
[test]  loss=1.5027 loss_span=1.1284 loss_node=3.7434 p=36.36 r=26.09 f=30.38 
lr=2.83e-06 gn=2.03 time=12s. 

2023-07-12 21:33:40 | INFO | train | saving log: valid_44_352.json
2023-07-12 21:33:42 | INFO | train | saving log: test_44_352.json
2023-07-12 21:33:42 | INFO | jlogger | Epoch=44 upd=352/400 
[train] loss=3.6804 loss_span=1.2605 loss_node=24.1984 
[valid] loss=1.2199 loss_span=0.8220 loss_node=3.9791 p=60.00 r=38.46 f=46.88 
[test]  loss=1.4942 loss_span=1.1209 loss_node=3.7335 p=42.31 r=23.91 f=30.56 
lr=2.42e-06 gn=2.44 time=11s. 

2023-07-12 21:33:51 | INFO | train | saving log: valid_45_360.json
2023-07-12 21:33:53 | INFO | train | saving log: test_45_360.json
2023-07-12 21:33:53 | INFO | jlogger | Epoch=45 upd=360/400 
[train] loss=3.5569 loss_span=1.1658 loss_node=23.9111 
[valid] loss=1.2028 loss_span=0.8062 loss_node=3.9664 p=61.54 r=41.03 f=49.23 
[test]  loss=1.4908 loss_span=1.1179 loss_node=3.7290 p=42.31 r=23.91 f=30.56 
lr=2.02e-06 gn=1.76 time=11s. 

2023-07-12 21:34:03 | INFO | train | saving log: valid_46_368.json
2023-07-12 21:34:05 | INFO | train | saving log: test_46_368.json
2023-07-12 21:34:05 | INFO | jlogger | Epoch=46 upd=368/400 
[train] loss=3.7628 loss_span=1.2705 loss_node=24.9238 
[valid] loss=1.2118 loss_span=0.8149 loss_node=3.9691 p=61.54 r=41.03 f=49.23 
[test]  loss=1.4909 loss_span=1.1176 loss_node=3.7326 p=45.83 r=23.91 f=31.43 
lr=1.62e-06 gn=1.46 time=12s. 

2023-07-12 21:34:14 | INFO | train | saving log: valid_47_376.json
2023-07-12 21:34:16 | INFO | train | saving log: test_47_376.json
2023-07-12 21:34:16 | INFO | jlogger | Epoch=47 upd=376/400 
[train] loss=3.6314 loss_span=1.1972 loss_node=24.3412 
[valid] loss=1.2124 loss_span=0.8148 loss_node=3.9761 p=65.38 r=43.59 f=52.31 
[test]  loss=1.4847 loss_span=1.1111 loss_node=3.7367 p=37.04 r=21.74 f=27.40 
lr=1.21e-06 gn=1.06 time=11s. 

2023-07-12 21:34:26 | INFO | train | saving log: valid_48_384.json
2023-07-12 21:34:28 | INFO | train | saving log: test_48_384.json
2023-07-12 21:34:28 | INFO | jlogger | Epoch=48 upd=384/400 
[train] loss=3.6741 loss_span=1.2413 loss_node=24.3279 
[valid] loss=1.2099 loss_span=0.8123 loss_node=3.9762 p=65.38 r=43.59 f=52.31 
[test]  loss=1.4814 loss_span=1.1079 loss_node=3.7351 p=39.29 r=23.91 f=29.73 
lr=8.08e-07 gn=1.31 time=12s. 

2023-07-12 21:34:37 | INFO | train | saving log: valid_49_392.json
2023-07-12 21:34:40 | INFO | train | saving log: test_49_392.json
2023-07-12 21:34:40 | INFO | jlogger | Epoch=49 upd=392/400 
[train] loss=3.6070 loss_span=1.2189 loss_node=23.8814 
[valid] loss=1.2091 loss_span=0.8118 loss_node=3.9733 p=65.38 r=43.59 f=52.31 
[test]  loss=1.4845 loss_span=1.1112 loss_node=3.7327 p=39.29 r=23.91 f=29.73 
lr=4.04e-07 gn=1.59 time=11s. 

2023-07-12 21:34:49 | INFO | train | saving log: valid_50_400.json
2023-07-12 21:34:51 | INFO | train | saving log: test_50_400.json
2023-07-12 21:34:51 | INFO | jlogger | Epoch=50 upd=400/400 
[train] loss=3.6882 loss_span=1.2097 loss_node=24.7851 
[valid] loss=1.2093 loss_span=0.8121 loss_node=3.9724 p=65.38 r=43.59 f=52.31 
[test]  loss=1.4866 loss_span=1.1134 loss_node=3.7320 p=39.29 r=23.91 f=29.73 
lr=0.00e+00 gn=1.27 time=11s. 

2023-07-12 21:34:51 | INFO | jlogger | 
Best valid scores: p=65.38 r=43.59 f=52.31 
Best test scores by valid: p=37.04 r=21.74 f=27.4 
Best test scores: p=50.0 r=23.91 f=32.35 

2023-07-12 21:58:50 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 21:58:52 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-12 21:58:52 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-12 21:58:52 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-12 21:58:52 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-12 21:58:52 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-12 21:58:52 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-12 21:58:52 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-12 21:58:53 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-12 21:58:53 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-12 21:59:16 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-12 21:59:16 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-12 21:59:20 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-12 21:59:20
2023-07-12 21:59:31 | INFO | train | saving log: valid_1_8.json
2023-07-12 21:59:33 | INFO | train | saving log: test_1_8.json
2023-07-12 21:59:33 | INFO | jlogger | Epoch=1 upd=8/400 
[train] loss=57.9877 loss_span=39.5153 loss_node=184.7234 
[valid] loss=10.1179 loss_span=3.6280 loss_node=64.8994 p=58.33 r=17.95 f=27.45 
[test]  loss=5.6314 loss_span=3.2996 loss_node=23.3178 p=28.57 r=4.35 f=7.55 
lr=1.98e-05 gn=5.00 time=13s. 

2023-07-12 21:59:42 | INFO | train | saving log: valid_2_16.json
2023-07-12 21:59:45 | INFO | train | saving log: test_2_16.json
2023-07-12 21:59:45 | INFO | jlogger | Epoch=2 upd=16/400 
[train] loss=30.8471 loss_span=15.7582 loss_node=150.8891 
[valid] loss=7.6230 loss_span=2.2147 loss_node=54.0836 p=58.33 r=17.95 f=27.45 
[test]  loss=3.9276 loss_span=2.0132 loss_node=19.1443 p=28.57 r=4.35 f=7.55 
lr=1.94e-05 gn=5.00 time=11s. 

2023-07-12 21:59:54 | INFO | train | saving log: valid_3_24.json
2023-07-12 21:59:57 | INFO | train | saving log: test_3_24.json
2023-07-12 21:59:57 | INFO | jlogger | Epoch=3 upd=24/400 
[train] loss=23.0347 loss_span=10.7989 loss_node=122.3574 
[valid] loss=6.1596 loss_span=1.8590 loss_node=43.0067 p=58.33 r=17.95 f=27.45 
[test]  loss=3.3524 loss_span=1.8767 loss_node=14.7568 p=25.00 r=4.35 f=7.41 
lr=1.90e-05 gn=5.00 time=12s. 

2023-07-12 22:00:06 | INFO | train | saving log: valid_4_32.json
2023-07-12 22:00:08 | INFO | train | saving log: test_4_32.json
2023-07-12 22:00:08 | INFO | jlogger | Epoch=4 upd=32/400 
[train] loss=20.1730 loss_span=9.9316 loss_node=102.4143 
[valid] loss=4.9160 loss_span=1.6509 loss_node=32.6511 p=50.00 r=15.38 f=23.53 
[test]  loss=2.8852 loss_span=1.7736 loss_node=11.1161 p=28.57 r=4.35 f=7.55 
lr=1.86e-05 gn=2.29 time=11s. 

2023-07-12 22:00:17 | INFO | train | saving log: valid_5_40.json
2023-07-12 22:00:20 | INFO | train | saving log: test_5_40.json
2023-07-12 22:00:20 | INFO | jlogger | Epoch=5 upd=40/400 
[train] loss=15.5797 loss_span=8.5020 loss_node=70.7762 
[valid] loss=4.0526 loss_span=1.5848 loss_node=24.6778 p=50.00 r=15.38 f=23.53 
[test]  loss=2.5420 loss_span=1.7210 loss_node=8.2098 p=28.57 r=4.35 f=7.55 
lr=1.82e-05 gn=2.22 time=12s. 

2023-07-12 22:00:29 | INFO | train | saving log: valid_6_48.json
2023-07-12 22:00:32 | INFO | train | saving log: test_6_48.json
2023-07-12 22:00:32 | INFO | jlogger | Epoch=6 upd=48/400 
[train] loss=13.8164 loss_span=7.6086 loss_node=62.0780 
[valid] loss=3.1838 loss_span=1.4053 loss_node=17.7848 p=66.67 r=20.51 f=31.37 
[test]  loss=2.1073 loss_span=1.5151 loss_node=5.9224 p=37.50 r=6.52 f=11.11 
lr=1.78e-05 gn=1.99 time=12s. 

2023-07-12 22:00:41 | INFO | train | saving log: valid_7_56.json
2023-07-12 22:00:43 | INFO | train | saving log: test_7_56.json
2023-07-12 22:00:43 | INFO | jlogger | Epoch=7 upd=56/400 
[train] loss=11.6133 loss_span=7.0502 loss_node=45.6311 
[valid] loss=2.6235 loss_span=1.3209 loss_node=13.0256 p=66.67 r=20.51 f=31.37 
[test]  loss=1.9811 loss_span=1.5085 loss_node=4.7265 p=37.50 r=6.52 f=11.11 
lr=1.74e-05 gn=5.00 time=12s. 

2023-07-12 22:00:52 | INFO | train | saving log: valid_8_64.json
2023-07-12 22:00:55 | INFO | train | saving log: test_8_64.json
2023-07-12 22:00:55 | INFO | jlogger | Epoch=8 upd=64/400 
[train] loss=10.0816 loss_span=6.4188 loss_node=36.6281 
[valid] loss=2.3138 loss_span=1.2752 loss_node=10.3868 p=63.64 r=17.95 f=28.00 
[test]  loss=1.8370 loss_span=1.4059 loss_node=4.3110 p=37.50 r=6.52 f=11.11 
lr=1.70e-05 gn=1.52 time=12s. 

2023-07-12 22:01:04 | INFO | train | saving log: valid_9_72.json
2023-07-12 22:01:07 | INFO | train | saving log: test_9_72.json
2023-07-12 22:01:07 | INFO | jlogger | Epoch=9 upd=72/400 
[train] loss=9.7058 loss_span=6.1167 loss_node=35.8911 
[valid] loss=2.0281 loss_span=1.2196 loss_node=8.0850 p=60.00 r=15.38 f=24.49 
[test]  loss=1.8031 loss_span=1.3825 loss_node=4.2060 p=28.57 r=4.35 f=7.55 
lr=1.66e-05 gn=1.69 time=11s. 

2023-07-12 22:01:16 | INFO | train | saving log: valid_10_80.json
2023-07-12 22:01:19 | INFO | train | saving log: test_10_80.json
2023-07-12 22:01:19 | INFO | jlogger | Epoch=10 upd=80/400 
[train] loss=8.6042 loss_span=5.6126 loss_node=29.9159 
[valid] loss=1.9417 loss_span=1.2794 loss_node=6.6232 p=66.67 r=20.51 f=31.37 
[test]  loss=1.9677 loss_span=1.5486 loss_node=4.1911 p=25.00 r=4.35 f=7.41 
lr=1.62e-05 gn=1.78 time=12s. 

2023-07-12 22:01:28 | INFO | train | saving log: valid_11_88.json
2023-07-12 22:01:30 | INFO | train | saving log: test_11_88.json
2023-07-12 22:01:30 | INFO | jlogger | Epoch=11 upd=88/400 
[train] loss=8.5561 loss_span=5.5362 loss_node=30.1989 
[valid] loss=1.6675 loss_span=1.0865 loss_node=5.8101 p=58.33 r=17.95 f=27.45 
[test]  loss=1.6801 loss_span=1.2589 loss_node=4.2115 p=14.29 r=2.17 f=3.77 
lr=1.58e-05 gn=2.44 time=11s. 

2023-07-12 22:01:40 | INFO | train | saving log: valid_12_96.json
2023-07-12 22:01:42 | INFO | train | saving log: test_12_96.json
2023-07-12 22:01:42 | INFO | jlogger | Epoch=12 upd=96/400 
[train] loss=8.3993 loss_span=5.3904 loss_node=30.0891 
[valid] loss=1.7217 loss_span=1.1704 loss_node=5.5125 p=42.86 r=7.69 f=13.04 
[test]  loss=1.7280 loss_span=1.3036 loss_node=4.2444 p=100.00 r=2.17 f=4.26 
lr=1.54e-05 gn=3.13 time=12s. 

2023-07-12 22:01:52 | INFO | train | saving log: valid_13_104.json
2023-07-12 22:01:55 | INFO | train | saving log: test_13_104.json
2023-07-12 22:01:55 | INFO | jlogger | Epoch=13 upd=104/400 
[train] loss=7.9040 loss_span=4.9916 loss_node=29.1235 
[valid] loss=1.7434 loss_span=1.2152 loss_node=5.2825 p=42.86 r=7.69 f=13.04 
[test]  loss=1.7102 loss_span=1.2906 loss_node=4.1956 p=50.00 r=2.17 f=4.17 
lr=1.49e-05 gn=3.48 time=12s. 

2023-07-12 22:02:04 | INFO | train | saving log: valid_14_112.json
2023-07-12 22:02:06 | INFO | train | saving log: test_14_112.json
2023-07-12 22:02:06 | INFO | jlogger | Epoch=14 upd=112/400 
[train] loss=7.4890 loss_span=4.5646 loss_node=29.2434 
[valid] loss=1.5247 loss_span=1.0147 loss_node=5.1004 p=53.33 r=20.51 f=29.63 
[test]  loss=1.7086 loss_span=1.2945 loss_node=4.1409 p=7.69 r=2.17 f=3.39 
lr=1.45e-05 gn=2.90 time=11s. 

2023-07-12 22:02:15 | INFO | train | saving log: valid_15_120.json
2023-07-12 22:02:18 | INFO | train | saving log: test_15_120.json
2023-07-12 22:02:18 | INFO | jlogger | Epoch=15 upd=120/400 
[train] loss=7.0730 loss_span=4.3571 loss_node=27.1588 
[valid] loss=1.4319 loss_span=0.9391 loss_node=4.9275 p=66.67 r=20.51 f=31.37 
[test]  loss=1.6035 loss_span=1.1928 loss_node=4.1070 p=33.33 r=4.35 f=7.69 
lr=1.41e-05 gn=1.69 time=11s. 

2023-07-12 22:02:27 | INFO | train | saving log: valid_16_128.json
2023-07-12 22:02:30 | INFO | train | saving log: test_16_128.json
2023-07-12 22:02:30 | INFO | jlogger | Epoch=16 upd=128/400 
[train] loss=6.6687 loss_span=3.8520 loss_node=28.1673 
[valid] loss=1.4818 loss_span=0.9980 loss_node=4.8372 p=80.00 r=20.51 f=32.65 
[test]  loss=1.6502 loss_span=1.2394 loss_node=4.1087 p=25.00 r=2.17 f=4.00 
lr=1.37e-05 gn=1.62 time=12s. 

2023-07-12 22:02:39 | INFO | train | saving log: valid_17_136.json
2023-07-12 22:02:41 | INFO | train | saving log: test_17_136.json
2023-07-12 22:02:41 | INFO | jlogger | Epoch=17 upd=136/400 
[train] loss=6.4866 loss_span=3.7065 loss_node=27.8010 
[valid] loss=1.5015 loss_span=1.0217 loss_node=4.7982 p=80.00 r=20.51 f=32.65 
[test]  loss=1.6303 loss_span=1.2210 loss_node=4.0927 p=25.00 r=2.17 f=4.00 
lr=1.33e-05 gn=2.18 time=11s. 

2023-07-12 22:02:50 | INFO | train | saving log: valid_18_144.json
2023-07-12 22:02:53 | INFO | train | saving log: test_18_144.json
2023-07-12 22:02:53 | INFO | jlogger | Epoch=18 upd=144/400 
[train] loss=6.1939 loss_span=3.5852 loss_node=26.0868 
[valid] loss=1.4154 loss_span=0.9460 loss_node=4.6940 p=62.50 r=25.64 f=36.36 
[test]  loss=1.5708 loss_span=1.1669 loss_node=4.0385 p=18.18 r=4.35 f=7.02 
lr=1.29e-05 gn=3.24 time=11s. 

2023-07-12 22:03:02 | INFO | train | saving log: valid_19_152.json
2023-07-12 22:03:04 | INFO | train | saving log: test_19_152.json
2023-07-12 22:03:04 | INFO | jlogger | Epoch=19 upd=152/400 
[train] loss=6.0724 loss_span=3.3554 loss_node=27.1698 
[valid] loss=1.3230 loss_span=0.8659 loss_node=4.5713 p=47.62 r=25.64 f=33.33 
[test]  loss=1.5632 loss_span=1.1640 loss_node=3.9917 p=18.75 r=6.52 f=9.68 
lr=1.25e-05 gn=2.02 time=11s. 

2023-07-12 22:03:13 | INFO | train | saving log: valid_20_160.json
2023-07-12 22:03:16 | INFO | train | saving log: test_20_160.json
2023-07-12 22:03:16 | INFO | jlogger | Epoch=20 upd=160/400 
[train] loss=5.8613 loss_span=3.2135 loss_node=26.4777 
[valid] loss=1.3943 loss_span=0.9424 loss_node=4.5188 p=83.33 r=25.64 f=39.22 
[test]  loss=1.5656 loss_span=1.1666 loss_node=3.9906 p=0.00 r=0.00 f=0.00 
lr=1.21e-05 gn=1.81 time=11s. 

2023-07-12 22:03:25 | INFO | train | saving log: valid_21_168.json
2023-07-12 22:03:27 | INFO | train | saving log: test_21_168.json
2023-07-12 22:03:27 | INFO | jlogger | Epoch=21 upd=168/400 
[train] loss=5.8452 loss_span=2.9921 loss_node=28.5304 
[valid] loss=1.3229 loss_span=0.8687 loss_node=4.5415 p=54.55 r=30.77 f=39.34 
[test]  loss=1.5999 loss_span=1.1975 loss_node=4.0244 p=29.41 r=10.87 f=15.87 
lr=1.17e-05 gn=1.99 time=11s. 

2023-07-12 22:03:36 | INFO | train | saving log: valid_22_176.json
2023-07-12 22:03:39 | INFO | train | saving log: test_22_176.json
2023-07-12 22:03:39 | INFO | jlogger | Epoch=22 upd=176/400 
[train] loss=5.5375 loss_span=2.8767 loss_node=26.6074 
[valid] loss=1.3627 loss_span=0.9146 loss_node=4.4813 p=62.50 r=25.64 f=36.36 
[test]  loss=1.4909 loss_span=1.0929 loss_node=3.9801 p=37.50 r=6.52 f=11.11 
lr=1.13e-05 gn=1.95 time=11s. 

2023-07-12 22:03:48 | INFO | train | saving log: valid_23_184.json
2023-07-12 22:03:50 | INFO | train | saving log: test_23_184.json
2023-07-12 22:03:50 | INFO | jlogger | Epoch=23 upd=184/400 
[train] loss=5.3561 loss_span=2.7117 loss_node=26.4434 
[valid] loss=1.3008 loss_span=0.8636 loss_node=4.3720 p=55.56 r=25.64 f=35.09 
[test]  loss=1.5253 loss_span=1.1334 loss_node=3.9191 p=26.67 r=8.70 f=13.11 
lr=1.09e-05 gn=2.19 time=11s. 

2023-07-12 22:03:59 | INFO | train | saving log: valid_24_192.json
2023-07-12 22:04:01 | INFO | train | saving log: test_24_192.json
2023-07-12 22:04:01 | INFO | jlogger | Epoch=24 upd=192/400 
[train] loss=5.2950 loss_span=2.6974 loss_node=25.9758 
[valid] loss=1.3294 loss_span=0.8996 loss_node=4.2975 p=62.50 r=25.64 f=36.36 
[test]  loss=1.5134 loss_span=1.1257 loss_node=3.8773 p=22.22 r=4.35 f=7.27 
lr=1.05e-05 gn=1.32 time=11s. 

2023-07-12 22:04:11 | INFO | train | saving log: valid_25_200.json
2023-07-12 22:04:13 | INFO | train | saving log: test_25_200.json
2023-07-12 22:04:13 | INFO | jlogger | Epoch=25 upd=200/400 
[train] loss=5.1626 loss_span=2.5197 loss_node=26.4293 
[valid] loss=1.2975 loss_span=0.8666 loss_node=4.3094 p=58.82 r=25.64 f=35.71 
[test]  loss=1.4966 loss_span=1.1058 loss_node=3.9079 p=27.27 r=6.52 f=10.53 
lr=1.01e-05 gn=1.60 time=12s. 

2023-07-12 22:04:22 | INFO | train | saving log: valid_26_208.json
2023-07-12 22:04:25 | INFO | train | saving log: test_26_208.json
2023-07-12 22:04:25 | INFO | jlogger | Epoch=26 upd=208/400 
[train] loss=5.0105 loss_span=2.3296 loss_node=26.8082 
[valid] loss=1.2435 loss_span=0.8121 loss_node=4.3134 p=60.00 r=30.77 f=40.68 
[test]  loss=1.5018 loss_span=1.1102 loss_node=3.9153 p=35.00 r=15.22 f=21.21 
lr=9.70e-06 gn=1.49 time=11s. 

2023-07-12 22:04:33 | INFO | train | saving log: valid_27_216.json
2023-07-12 22:04:36 | INFO | train | saving log: test_27_216.json
2023-07-12 22:04:36 | INFO | jlogger | Epoch=27 upd=216/400 
[train] loss=4.9196 loss_span=2.3041 loss_node=26.1550 
[valid] loss=1.2564 loss_span=0.8269 loss_node=4.2955 p=60.00 r=30.77 f=40.68 
[test]  loss=1.5040 loss_span=1.1136 loss_node=3.9036 p=36.84 r=15.22 f=21.54 
lr=9.29e-06 gn=1.83 time=11s. 

2023-07-12 22:04:45 | INFO | train | saving log: valid_28_224.json
2023-07-12 22:04:47 | INFO | train | saving log: test_28_224.json
2023-07-12 22:04:47 | INFO | jlogger | Epoch=28 upd=224/400 
[train] loss=4.8392 loss_span=2.2545 loss_node=25.8463 
[valid] loss=1.2588 loss_span=0.8312 loss_node=4.2761 p=61.90 r=33.33 f=43.33 
[test]  loss=1.5116 loss_span=1.1225 loss_node=3.8909 p=36.84 r=15.22 f=21.54 
lr=8.89e-06 gn=1.65 time=11s. 

2023-07-12 22:04:57 | INFO | train | saving log: valid_29_232.json
2023-07-12 22:04:59 | INFO | train | saving log: test_29_232.json
2023-07-12 22:04:59 | INFO | jlogger | Epoch=29 upd=232/400 
[train] loss=4.5901 loss_span=2.1142 loss_node=24.7590 
[valid] loss=1.2344 loss_span=0.8093 loss_node=4.2511 p=54.55 r=30.77 f=39.34 
[test]  loss=1.4670 loss_span=1.0780 loss_node=3.8901 p=37.50 r=19.57 f=25.71 
lr=8.48e-06 gn=1.66 time=12s. 

2023-07-12 22:05:08 | INFO | train | saving log: valid_30_240.json
2023-07-12 22:05:10 | INFO | train | saving log: test_30_240.json
2023-07-12 22:05:10 | INFO | jlogger | Epoch=30 upd=240/400 
[train] loss=4.7100 loss_span=2.0497 loss_node=26.6027 
[valid] loss=1.2503 loss_span=0.8259 loss_node=4.2441 p=50.00 r=33.33 f=40.00 
[test]  loss=1.5020 loss_span=1.1130 loss_node=3.8897 p=37.50 r=19.57 f=25.71 
lr=8.08e-06 gn=2.91 time=11s. 

2023-07-12 22:05:20 | INFO | train | saving log: valid_31_248.json
2023-07-12 22:05:22 | INFO | train | saving log: test_31_248.json
2023-07-12 22:05:22 | INFO | jlogger | Epoch=31 upd=248/400 
[train] loss=4.5314 loss_span=1.9416 loss_node=25.8988 
[valid] loss=1.2565 loss_span=0.8357 loss_node=4.2084 p=65.00 r=33.33 f=44.07 
[test]  loss=1.4753 loss_span=1.0895 loss_node=3.8581 p=43.48 r=21.74 f=28.99 
lr=7.68e-06 gn=1.48 time=12s. 

2023-07-12 22:05:31 | INFO | train | saving log: valid_32_256.json
2023-07-12 22:05:34 | INFO | train | saving log: test_32_256.json
2023-07-12 22:05:34 | INFO | jlogger | Epoch=32 upd=256/400 
[train] loss=4.3545 loss_span=1.8989 loss_node=24.5566 
[valid] loss=1.2217 loss_span=0.8073 loss_node=4.1441 p=58.33 r=35.90 f=44.44 
[test]  loss=1.4567 loss_span=1.0749 loss_node=3.8172 p=41.67 r=21.74 f=28.57 
lr=7.27e-06 gn=1.37 time=11s. 

2023-07-12 22:05:43 | INFO | train | saving log: valid_33_264.json
2023-07-12 22:05:45 | INFO | train | saving log: test_33_264.json
2023-07-12 22:05:45 | INFO | jlogger | Epoch=33 upd=264/400 
[train] loss=4.4025 loss_span=1.7999 loss_node=26.0267 
[valid] loss=1.2333 loss_span=0.8201 loss_node=4.1321 p=53.85 r=35.90 f=43.08 
[test]  loss=1.4884 loss_span=1.1069 loss_node=3.8146 p=41.67 r=21.74 f=28.57 
lr=6.87e-06 gn=1.30 time=12s. 

2023-07-12 22:05:54 | INFO | train | saving log: valid_34_272.json
2023-07-12 22:05:57 | INFO | train | saving log: test_34_272.json
2023-07-12 22:05:57 | INFO | jlogger | Epoch=34 upd=272/400 
[train] loss=4.2766 loss_span=1.7833 loss_node=24.9334 
[valid] loss=1.2251 loss_span=0.8111 loss_node=4.1401 p=56.00 r=35.90 f=43.75 
[test]  loss=1.5162 loss_span=1.1329 loss_node=3.8331 p=39.29 r=23.91 f=29.73 
lr=6.46e-06 gn=2.05 time=12s. 

2023-07-12 22:06:06 | INFO | train | saving log: valid_35_280.json
2023-07-12 22:06:09 | INFO | train | saving log: test_35_280.json
2023-07-12 22:06:09 | INFO | jlogger | Epoch=35 upd=280/400 
[train] loss=4.2336 loss_span=1.7037 loss_node=25.2993 
[valid] loss=1.2153 loss_span=0.8005 loss_node=4.1481 p=59.09 r=33.33 f=42.62 
[test]  loss=1.4500 loss_span=1.0651 loss_node=3.8489 p=43.48 r=21.74 f=28.99 
lr=6.06e-06 gn=1.64 time=11s. 

2023-07-12 22:06:18 | INFO | train | saving log: valid_36_288.json
2023-07-12 22:06:20 | INFO | train | saving log: test_36_288.json
2023-07-12 22:06:20 | INFO | jlogger | Epoch=36 upd=288/400 
[train] loss=4.1888 loss_span=1.6980 loss_node=24.9077 
[valid] loss=1.2308 loss_span=0.8169 loss_node=4.1392 p=60.00 r=38.46 f=46.88 
[test]  loss=1.4715 loss_span=1.0858 loss_node=3.8568 p=45.83 r=23.91 f=31.43 
lr=5.66e-06 gn=1.54 time=12s. 

2023-07-12 22:06:29 | INFO | train | saving log: valid_37_296.json
2023-07-12 22:06:32 | INFO | train | saving log: test_37_296.json
2023-07-12 22:06:32 | INFO | jlogger | Epoch=37 upd=296/400 
[train] loss=4.0904 loss_span=1.6854 loss_node=24.0493 
[valid] loss=1.2326 loss_span=0.8198 loss_node=4.1278 p=65.22 r=38.46 f=48.39 
[test]  loss=1.4652 loss_span=1.0792 loss_node=3.8596 p=37.50 r=19.57 f=25.71 
lr=5.25e-06 gn=2.03 time=11s. 

2023-07-12 22:06:41 | INFO | train | saving log: valid_38_304.json
2023-07-12 22:06:44 | INFO | train | saving log: test_38_304.json
2023-07-12 22:06:44 | INFO | jlogger | Epoch=38 upd=304/400 
[train] loss=4.0934 loss_span=1.6531 loss_node=24.4026 
[valid] loss=1.1945 loss_span=0.7837 loss_node=4.1079 p=59.09 r=33.33 f=42.62 
[test]  loss=1.4463 loss_span=1.0608 loss_node=3.8548 p=37.50 r=19.57 f=25.71 
lr=4.85e-06 gn=1.47 time=12s. 

2023-07-12 22:06:53 | INFO | train | saving log: valid_39_312.json
2023-07-12 22:06:56 | INFO | train | saving log: test_39_312.json
2023-07-12 22:06:56 | INFO | jlogger | Epoch=39 upd=312/400 
[train] loss=4.1366 loss_span=1.6364 loss_node=25.0018 
[valid] loss=1.2060 loss_span=0.7960 loss_node=4.0993 p=73.68 r=35.90 f=48.28 
[test]  loss=1.4847 loss_span=1.0987 loss_node=3.8592 p=44.44 r=17.39 f=25.00 
lr=4.44e-06 gn=2.20 time=12s. 

2023-07-12 22:07:06 | INFO | train | saving log: valid_40_320.json
2023-07-12 22:07:08 | INFO | train | saving log: test_40_320.json
2023-07-12 22:07:08 | INFO | jlogger | Epoch=40 upd=320/400 
[train] loss=4.0020 loss_span=1.5777 loss_node=24.2429 
[valid] loss=1.1699 loss_span=0.7621 loss_node=4.0777 p=68.18 r=38.46 f=49.18 
[test]  loss=1.4427 loss_span=1.0570 loss_node=3.8568 p=37.50 r=19.57 f=25.71 
lr=4.04e-06 gn=1.43 time=11s. 

2023-07-12 22:07:17 | INFO | train | saving log: valid_41_328.json
2023-07-12 22:07:20 | INFO | train | saving log: test_41_328.json
2023-07-12 22:07:20 | INFO | jlogger | Epoch=41 upd=328/400 
[train] loss=3.9946 loss_span=1.5336 loss_node=24.6099 
[valid] loss=1.1655 loss_span=0.7608 loss_node=4.0475 p=68.18 r=38.46 f=49.18 
[test]  loss=1.4599 loss_span=1.0762 loss_node=3.8367 p=39.13 r=19.57 f=26.09 
lr=3.64e-06 gn=1.10 time=12s. 

2023-07-12 22:07:29 | INFO | train | saving log: valid_42_336.json
2023-07-12 22:07:31 | INFO | train | saving log: test_42_336.json
2023-07-12 22:07:31 | INFO | jlogger | Epoch=42 upd=336/400 
[train] loss=4.1384 loss_span=1.5390 loss_node=25.9945 
[valid] loss=1.1652 loss_span=0.7629 loss_node=4.0232 p=68.18 r=38.46 f=49.18 
[test]  loss=1.4765 loss_span=1.0954 loss_node=3.8109 p=40.91 r=19.57 f=26.47 
lr=3.23e-06 gn=1.37 time=11s. 

2023-07-12 22:07:41 | INFO | train | saving log: valid_43_344.json
2023-07-12 22:07:43 | INFO | train | saving log: test_43_344.json
2023-07-12 22:07:43 | INFO | jlogger | Epoch=43 upd=344/400 
[train] loss=3.9996 loss_span=1.5259 loss_node=24.7367 
[valid] loss=1.1476 loss_span=0.7469 loss_node=4.0066 p=62.50 r=38.46 f=47.62 
[test]  loss=1.4734 loss_span=1.0943 loss_node=3.7909 p=36.00 r=19.57 f=25.35 
lr=2.83e-06 gn=0.92 time=12s. 

2023-07-12 22:07:52 | INFO | train | saving log: valid_44_352.json
2023-07-12 22:07:55 | INFO | train | saving log: test_44_352.json
2023-07-12 22:07:55 | INFO | jlogger | Epoch=44 upd=352/400 
[train] loss=3.8910 loss_span=1.4625 loss_node=24.2845 
[valid] loss=1.1668 loss_span=0.7672 loss_node=3.9955 p=68.18 r=38.46 f=49.18 
[test]  loss=1.4961 loss_span=1.1179 loss_node=3.7817 p=36.36 r=17.39 f=23.53 
lr=2.42e-06 gn=1.15 time=12s. 

2023-07-12 22:08:04 | INFO | train | saving log: valid_45_360.json
2023-07-12 22:08:07 | INFO | train | saving log: test_45_360.json
2023-07-12 22:08:07 | INFO | jlogger | Epoch=45 upd=360/400 
[train] loss=3.8341 loss_span=1.4348 loss_node=23.9930 
[valid] loss=1.1718 loss_span=0.7735 loss_node=3.9822 p=68.18 r=38.46 f=49.18 
[test]  loss=1.4916 loss_span=1.1138 loss_node=3.7776 p=36.36 r=17.39 f=23.53 
lr=2.02e-06 gn=1.36 time=11s. 

2023-07-12 22:08:16 | INFO | train | saving log: valid_46_368.json
2023-07-12 22:08:19 | INFO | train | saving log: test_46_368.json
2023-07-12 22:08:19 | INFO | jlogger | Epoch=46 upd=368/400 
[train] loss=4.0370 loss_span=1.5279 loss_node=25.0907 
[valid] loss=1.1718 loss_span=0.7733 loss_node=3.9845 p=71.43 r=38.46 f=50.00 
[test]  loss=1.4875 loss_span=1.1093 loss_node=3.7817 p=34.78 r=17.39 f=23.19 
lr=1.62e-06 gn=1.49 time=12s. 

2023-07-12 22:08:29 | INFO | train | saving log: valid_47_376.json
2023-07-12 22:08:31 | INFO | train | saving log: test_47_376.json
2023-07-12 22:08:31 | INFO | jlogger | Epoch=47 upd=376/400 
[train] loss=3.8529 loss_span=1.4111 loss_node=24.4182 
[valid] loss=1.1724 loss_span=0.7732 loss_node=3.9921 p=68.18 r=38.46 f=49.18 
[test]  loss=1.4839 loss_span=1.1052 loss_node=3.7864 p=39.13 r=19.57 f=26.09 
lr=1.21e-06 gn=1.05 time=12s. 

2023-07-12 22:08:40 | INFO | train | saving log: valid_48_384.json
2023-07-12 22:08:43 | INFO | train | saving log: test_48_384.json
2023-07-12 22:08:43 | INFO | jlogger | Epoch=48 upd=384/400 
[train] loss=3.9145 loss_span=1.4742 loss_node=24.4025 
[valid] loss=1.1627 loss_span=0.7635 loss_node=3.9926 p=65.22 r=38.46 f=48.39 
[test]  loss=1.4693 loss_span=1.0909 loss_node=3.7849 p=37.04 r=21.74 f=27.40 
lr=8.08e-07 gn=0.95 time=12s. 

2023-07-12 22:08:52 | INFO | train | saving log: valid_49_392.json
2023-07-12 22:08:55 | INFO | train | saving log: test_49_392.json
2023-07-12 22:08:55 | INFO | jlogger | Epoch=49 upd=392/400 
[train] loss=3.8336 loss_span=1.4381 loss_node=23.9545 
[valid] loss=1.1661 loss_span=0.7671 loss_node=3.9902 p=65.22 r=38.46 f=48.39 
[test]  loss=1.4710 loss_span=1.0927 loss_node=3.7825 p=40.00 r=21.74 f=28.17 
lr=4.04e-07 gn=1.07 time=12s. 

2023-07-12 22:09:04 | INFO | train | saving log: valid_50_400.json
2023-07-12 22:09:07 | INFO | train | saving log: test_50_400.json
2023-07-12 22:09:07 | INFO | jlogger | Epoch=50 upd=400/400 
[train] loss=3.8980 loss_span=1.4023 loss_node=24.9569 
[valid] loss=1.1689 loss_span=0.7700 loss_node=3.9895 p=65.22 r=38.46 f=48.39 
[test]  loss=1.4732 loss_span=1.0950 loss_node=3.7818 p=39.13 r=19.57 f=26.09 
lr=0.00e+00 gn=1.21 time=12s. 

2023-07-12 22:09:07 | INFO | jlogger | 
Best valid scores: p=71.43 r=38.46 f=50.0 
Best test scores by valid: p=34.78 r=17.39 f=23.19 
Best test scores: p=45.83 r=23.91 f=31.43 

2023-07-12 22:44:38 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/disk/fmxuxu-disk/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/disk/fmxuxu-disk/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/disk/fmxuxu-disk/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-12 22:44:39 | INFO | train | [Graph] loading nodes from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-12 22:44:39 | INFO | train | [Graph] saving nodes to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-12 22:44:39 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-12 22:44:39 | INFO | train | [Graph] loading edges from /disk/fmxuxu-disk/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-12 22:45:55 | INFO | train | [Graph] saving edges to /disk/fmxuxu-disk/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-12 22:47:16 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-12 22:47:18 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-12 22:48:48 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-12 22:48:48 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-12 22:49:52 | INFO | train | Using char encoder (char ids):   [Train] total=583519 unk=0 ratio=0.0%  [Valid] total=71514 unk=2 ratio=0.0%  [Test] total=79342 unk=0 ratio=0.0%
2023-07-12 22:49:52 | INFO | train | Using word encoder (word ids):   [Train] total=139524 unk=515 ratio=0.37%  [Valid] total=17150 unk=64 ratio=0.37%  [Test] total=18720 unk=69 ratio=0.37%
2023-07-12 22:49:56 | INFO | train | Saving dir: /disk/fmxuxu-disk/spanCL/__results/ace04/nner_slg/41_18 2023-07-12 22:49:56
2023-07-13 15:06:53 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/mnt/LJH/XFM/NERProject/spanCL__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/mnt/LJH/XFM/NERProject/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-13 16:30:03 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/mnt/LJH/XFM/NERProject/spanCL__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/mnt/LJH/XFM/NERProject/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-13 16:30:04 | INFO | train | [Graph] loading nodes from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-13 16:30:04 | INFO | train | [Graph] saving nodes to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-13 16:30:04 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-13 16:30:04 | INFO | train | [Graph] loading edges from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-13 16:30:04 | INFO | train | [Graph] saving edges to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-13 16:30:04 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-13 16:30:04 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-13 16:30:05 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-13 16:30:05 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-13 16:30:06 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-13 16:30:06 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-13 16:30:09 | INFO | train | Saving dir: /mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18 2023-07-13 16:30:09
2023-07-13 16:30:27 | INFO | train | saving log: valid_1_8.json
2023-07-13 16:30:29 | INFO | train | saving log: test_1_8.json
2023-07-13 16:30:29 | INFO | jlogger | Epoch=1 upd=8/400 
[train] loss=60.8123 loss_span=41.5900 loss_node=192.2232 
[valid] loss=10.9422 loss_span=4.1336 loss_node=68.0862 p=58.33 r=17.95 f=27.45 
[test]  loss=6.3761 loss_span=3.9441 loss_node=24.3209 p=28.57 r=4.35 f=7.55 
lr=1.98e-05 gn=5.00 time=19s. 

2023-07-13 16:30:37 | INFO | train | saving log: valid_2_16.json
2023-07-13 16:30:40 | INFO | train | saving log: test_2_16.json
2023-07-13 16:30:40 | INFO | jlogger | Epoch=2 upd=16/400 
[train] loss=34.4739 loss_span=18.6353 loss_node=158.3852 
[valid] loss=8.3144 loss_span=2.5274 loss_node=57.8694 p=58.33 r=17.95 f=27.45 
[test]  loss=4.4522 loss_span=2.4281 loss_node=20.2409 p=28.57 r=4.35 f=7.55 
lr=1.94e-05 gn=5.00 time=11s. 

2023-07-13 16:30:48 | INFO | train | saving log: valid_3_24.json
2023-07-13 16:30:51 | INFO | train | saving log: test_3_24.json
2023-07-13 16:30:51 | INFO | jlogger | Epoch=3 upd=24/400 
[train] loss=25.1439 loss_span=11.9487 loss_node=131.9519 
[valid] loss=6.9190 loss_span=2.1131 loss_node=48.0598 p=58.33 r=17.95 f=27.45 
[test]  loss=3.6583 loss_span=2.0291 loss_node=16.2918 p=28.57 r=4.35 f=7.55 
lr=1.90e-05 gn=5.00 time=11s. 

2023-07-13 16:30:59 | INFO | train | saving log: valid_4_32.json
2023-07-13 16:31:01 | INFO | train | saving log: test_4_32.json
2023-07-13 16:31:01 | INFO | jlogger | Epoch=4 upd=32/400 
[train] loss=21.5661 loss_span=10.1241 loss_node=114.4197 
[valid] loss=5.4860 loss_span=1.7467 loss_node=37.3931 p=50.00 r=15.38 f=23.53 
[test]  loss=3.0981 loss_span=1.8434 loss_node=12.5469 p=28.57 r=4.35 f=7.55 
lr=1.86e-05 gn=4.48 time=11s. 

2023-07-13 16:31:10 | INFO | train | saving log: valid_5_40.json
2023-07-13 16:31:10 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/mnt/LJH/XFM/NERProject/spanCL__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/mnt/LJH/XFM/NERProject/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-13 16:31:11 | INFO | train | [Graph] loading nodes from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-13 16:31:11 | INFO | train | [Graph] saving nodes to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-13 16:31:11 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-13 16:31:11 | INFO | train | [Graph] loading edges from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-13 16:31:12 | INFO | train | saving log: test_5_40.json
2023-07-13 16:31:12 | INFO | jlogger | Epoch=5 upd=40/400 
[train] loss=16.4232 loss_span=8.5107 loss_node=79.1256 
[valid] loss=4.4420 loss_span=1.6549 loss_node=27.8708 p=50.00 r=15.38 f=23.53 
[test]  loss=2.6795 loss_span=1.7636 loss_node=9.1588 p=28.57 r=4.35 f=7.55 
lr=1.82e-05 gn=5.00 time=11s. 

2023-07-13 16:31:21 | INFO | train | saving log: valid_6_48.json
2023-07-13 16:31:23 | INFO | train | saving log: test_6_48.json
2023-07-13 16:31:23 | INFO | jlogger | Epoch=6 upd=48/400 
[train] loss=14.3507 loss_span=7.5656 loss_node=67.8510 
[valid] loss=3.4436 loss_span=1.4705 loss_node=19.7312 p=66.67 r=20.51 f=31.37 
[test]  loss=2.2098 loss_span=1.5743 loss_node=6.3546 p=28.57 r=4.35 f=7.55 
lr=1.78e-05 gn=1.66 time=11s. 

2023-07-13 16:31:32 | INFO | train | saving log: valid_7_56.json
2023-07-13 16:31:34 | INFO | train | saving log: test_7_56.json
2023-07-13 16:31:34 | INFO | jlogger | Epoch=7 upd=56/400 
[train] loss=11.7066 loss_span=6.9039 loss_node=48.0267 
[valid] loss=3.0153 loss_span=1.6018 loss_node=14.1344 p=60.00 r=15.38 f=24.49 
[test]  loss=2.1376 loss_span=1.6479 loss_node=4.8979 p=33.33 r=4.35 f=7.69 
lr=1.74e-05 gn=2.25 time=11s. 

2023-07-13 16:31:43 | INFO | train | saving log: valid_8_64.json
2023-07-13 16:31:45 | INFO | train | saving log: test_8_64.json
2023-07-13 16:31:45 | INFO | jlogger | Epoch=8 upd=64/400 
[train] loss=9.9699 loss_span=6.2313 loss_node=37.3863 
[valid] loss=2.5986 loss_span=1.5123 loss_node=10.8630 p=55.56 r=12.82 f=20.83 
[test]  loss=1.9781 loss_span=1.5436 loss_node=4.3452 p=33.33 r=2.17 f=4.08 
lr=1.70e-05 gn=1.60 time=11s. 

2023-07-13 16:31:54 | INFO | train | saving log: valid_9_72.json
2023-07-13 16:31:56 | INFO | train | saving log: test_9_72.json
2023-07-13 16:31:56 | INFO | jlogger | Epoch=9 upd=72/400 
[train] loss=9.3861 loss_span=5.7576 loss_node=36.2850 
[valid] loss=2.2970 loss_span=1.4785 loss_node=8.1845 p=42.86 r=7.69 f=13.04 
[test]  loss=1.9265 loss_span=1.5048 loss_node=4.2169 p=50.00 r=2.17 f=4.17 
lr=1.66e-05 gn=3.02 time=11s. 

2023-07-13 16:32:05 | INFO | train | saving log: valid_10_80.json
2023-07-13 16:32:07 | INFO | train | saving log: test_10_80.json
2023-07-13 16:32:07 | INFO | jlogger | Epoch=10 upd=80/400 
[train] loss=8.3972 loss_span=5.4089 loss_node=29.8824 
[valid] loss=1.9349 loss_span=1.2865 loss_node=6.4843 p=44.44 r=10.26 f=16.67 
[test]  loss=1.7797 loss_span=1.3586 loss_node=4.2111 p=20.00 r=2.17 f=3.92 
lr=1.62e-05 gn=5.00 time=11s. 

2023-07-13 16:32:16 | INFO | train | saving log: valid_11_88.json
2023-07-13 16:32:19 | INFO | train | saving log: test_11_88.json
2023-07-13 16:32:19 | INFO | jlogger | Epoch=11 upd=88/400 
[train] loss=8.1362 loss_span=5.1282 loss_node=30.0797 
[valid] loss=1.8669 loss_span=1.3073 loss_node=5.5956 p=50.00 r=10.26 f=17.02 
[test]  loss=1.7963 loss_span=1.3725 loss_node=4.2380 p=33.33 r=2.17 f=4.08 
lr=1.58e-05 gn=3.65 time=11s. 

2023-07-13 16:32:26 | INFO | train | [Graph] saving edges to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-13 16:32:27 | INFO | train | saving log: valid_12_96.json
2023-07-13 16:32:30 | INFO | train | saving log: test_12_96.json
2023-07-13 16:32:30 | INFO | jlogger | Epoch=12 upd=96/400 
[train] loss=7.7008 loss_span=4.6966 loss_node=30.0424 
[valid] loss=1.7372 loss_span=1.2022 loss_node=5.3493 p=55.56 r=12.82 f=20.83 
[test]  loss=1.7665 loss_span=1.3380 loss_node=4.2847 p=40.00 r=4.35 f=7.84 
lr=1.54e-05 gn=1.79 time=11s. 

2023-07-13 16:32:38 | INFO | train | saving log: valid_13_104.json
2023-07-13 16:32:41 | INFO | train | saving log: test_13_104.json
2023-07-13 16:32:41 | INFO | jlogger | Epoch=13 upd=104/400 
[train] loss=7.4710 loss_span=4.5731 loss_node=28.9781 
[valid] loss=1.8439 loss_span=1.3295 loss_node=5.1440 p=25.64 r=25.64 f=25.64 
[test]  loss=2.2015 loss_span=1.7797 loss_node=4.2174 p=11.36 r=10.87 f=11.11 
lr=1.49e-05 gn=5.00 time=11s. 

2023-07-13 16:32:49 | INFO | train | saving log: valid_14_112.json
2023-07-13 16:32:52 | INFO | train | saving log: test_14_112.json
2023-07-13 16:32:52 | INFO | jlogger | Epoch=14 upd=112/400 
[train] loss=8.2823 loss_span=5.3835 loss_node=28.9875 
[valid] loss=1.6548 loss_span=1.1598 loss_node=4.9504 p=77.78 r=17.95 f=29.17 
[test]  loss=1.7750 loss_span=1.3630 loss_node=4.1207 p=33.33 r=2.17 f=4.08 
lr=1.45e-05 gn=5.00 time=11s. 

2023-07-13 16:33:00 | INFO | train | saving log: valid_15_120.json
2023-07-13 16:33:03 | INFO | train | saving log: test_15_120.json
2023-07-13 16:33:03 | INFO | jlogger | Epoch=15 upd=120/400 
[train] loss=7.1043 loss_span=4.4078 loss_node=26.9643 
[valid] loss=1.5746 loss_span=1.0960 loss_node=4.7867 p=77.78 r=17.95 f=29.17 
[test]  loss=1.6524 loss_span=1.2460 loss_node=4.0644 p=25.00 r=2.17 f=4.00 
lr=1.41e-05 gn=5.00 time=11s. 

2023-07-13 16:33:11 | INFO | train | saving log: valid_16_128.json
2023-07-13 16:33:14 | INFO | train | saving log: test_16_128.json
2023-07-13 16:33:14 | INFO | jlogger | Epoch=16 upd=128/400 
[train] loss=6.6419 loss_span=3.8217 loss_node=28.2020 
[valid] loss=1.6285 loss_span=1.1556 loss_node=4.7289 p=66.67 r=20.51 f=31.37 
[test]  loss=1.6650 loss_span=1.2590 loss_node=4.0592 p=25.00 r=2.17 f=4.00 
lr=1.37e-05 gn=4.43 time=11s. 

2023-07-13 16:33:14 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-13 16:33:15 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-13 16:33:22 | INFO | train | saving log: valid_17_136.json
2023-07-13 16:33:25 | INFO | train | saving log: test_17_136.json
2023-07-13 16:33:25 | INFO | jlogger | Epoch=17 upd=136/400 
[train] loss=6.3169 loss_span=3.5383 loss_node=27.7856 
[valid] loss=1.6125 loss_span=1.1391 loss_node=4.7335 p=63.64 r=17.95 f=28.00 
[test]  loss=1.6406 loss_span=1.2345 loss_node=4.0608 p=25.00 r=4.35 f=7.41 
lr=1.33e-05 gn=3.89 time=11s. 

2023-07-13 16:33:33 | INFO | train | saving log: valid_18_144.json
2023-07-13 16:33:36 | INFO | train | saving log: test_18_144.json
2023-07-13 16:33:36 | INFO | jlogger | Epoch=18 upd=144/400 
[train] loss=5.8797 loss_span=3.2781 loss_node=26.0164 
[valid] loss=1.5353 loss_span=1.0705 loss_node=4.6482 p=44.44 r=20.51 f=28.07 
[test]  loss=1.5764 loss_span=1.1740 loss_node=4.0237 p=14.29 r=2.17 f=3.77 
lr=1.29e-05 gn=2.77 time=11s. 

2023-07-13 16:33:44 | INFO | train | saving log: valid_19_152.json
2023-07-13 16:33:47 | INFO | train | saving log: test_19_152.json
2023-07-13 16:33:47 | INFO | jlogger | Epoch=19 upd=152/400 
[train] loss=5.6313 loss_span=2.9179 loss_node=27.1342 
[valid] loss=1.4978 loss_span=1.0453 loss_node=4.5250 p=34.38 r=28.21 f=30.99 
[test]  loss=1.5983 loss_span=1.2002 loss_node=3.9810 p=30.43 r=15.22 f=20.29 
lr=1.25e-05 gn=3.56 time=11s. 

2023-07-13 16:33:55 | INFO | train | saving log: valid_20_160.json
2023-07-13 16:33:58 | INFO | train | saving log: test_20_160.json
2023-07-13 16:33:58 | INFO | jlogger | Epoch=20 upd=160/400 
[train] loss=5.5136 loss_span=2.8741 loss_node=26.3953 
[valid] loss=1.4954 loss_span=1.0491 loss_node=4.4636 p=34.48 r=25.64 f=29.41 
[test]  loss=1.5605 loss_span=1.1637 loss_node=3.9686 p=25.00 r=10.87 f=15.15 
lr=1.21e-05 gn=2.80 time=11s. 

2023-07-13 16:34:07 | INFO | train | saving log: valid_21_168.json
2023-07-13 16:34:09 | INFO | train | saving log: test_21_168.json
2023-07-13 16:34:09 | INFO | jlogger | Epoch=21 upd=168/400 
[train] loss=5.6735 loss_span=2.8178 loss_node=28.5567 
[valid] loss=1.5576 loss_span=1.1101 loss_node=4.4742 p=33.33 r=25.64 f=28.99 
[test]  loss=1.5901 loss_span=1.1917 loss_node=3.9842 p=20.00 r=10.87 f=14.08 
lr=1.17e-05 gn=5.00 time=11s. 

2023-07-13 16:34:13 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-13 16:34:13 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-13 16:34:18 | INFO | train | saving log: valid_22_176.json
2023-07-13 16:34:20 | INFO | train | saving log: test_22_176.json
2023-07-13 16:34:20 | INFO | jlogger | Epoch=22 upd=176/400 
[train] loss=5.2536 loss_span=2.5915 loss_node=26.6203 
[valid] loss=1.5091 loss_span=1.0666 loss_node=4.4248 p=40.00 r=20.51 f=27.12 
[test]  loss=1.5575 loss_span=1.1635 loss_node=3.9407 p=11.11 r=2.17 f=3.64 
lr=1.13e-05 gn=3.13 time=11s. 

2023-07-13 16:34:29 | INFO | train | saving log: valid_23_184.json
2023-07-13 16:34:31 | INFO | train | saving log: test_23_184.json
2023-07-13 16:34:31 | INFO | jlogger | Epoch=23 upd=184/400 
[train] loss=5.0594 loss_span=2.4161 loss_node=26.4327 
[valid] loss=1.4702 loss_span=1.0373 loss_node=4.3288 p=32.14 r=23.08 f=26.87 
[test]  loss=1.6401 loss_span=1.2506 loss_node=3.8944 p=21.05 r=8.70 f=12.31 
lr=1.09e-05 gn=2.57 time=11s. 

2023-07-13 16:35:03 | INFO | train | Using char encoder (char ids):   [Train] total=583519 unk=0 ratio=0.0%  [Valid] total=71514 unk=2 ratio=0.0%  [Test] total=79342 unk=0 ratio=0.0%
2023-07-13 16:35:04 | INFO | train | Using word encoder (word ids):   [Train] total=139524 unk=515 ratio=0.37%  [Valid] total=17150 unk=64 ratio=0.37%  [Test] total=18720 unk=69 ratio=0.37%
2023-07-13 16:35:07 | INFO | train | Saving dir: /mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18 2023-07-13 16:35:07
2023-07-13 16:37:21 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/mnt/LJH/XFM/NERProject/spanCL__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/mnt/LJH/XFM/NERProject/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-13 16:37:22 | INFO | train | [Graph] loading nodes from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-13 16:37:22 | INFO | train | [Graph] saving nodes to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-13 16:37:22 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-13 16:37:22 | INFO | train | [Graph] loading edges from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-13 16:38:35 | INFO | train | [Graph] saving edges to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-13 16:39:21 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-13 16:39:22 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-13 16:40:18 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-13 16:40:18 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-13 16:41:07 | INFO | train | Using char encoder (char ids):   [Train] total=583519 unk=0 ratio=0.0%  [Valid] total=71514 unk=2 ratio=0.0%  [Test] total=79342 unk=0 ratio=0.0%
2023-07-13 16:41:08 | INFO | train | Using word encoder (word ids):   [Train] total=139524 unk=515 ratio=0.37%  [Valid] total=17150 unk=64 ratio=0.37%  [Test] total=18720 unk=69 ratio=0.37%
2023-07-13 16:41:11 | INFO | train | Saving dir: /mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18 2023-07-13 16:41:11
2023-07-13 16:43:10 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/mnt/LJH/XFM/NERProject/spanCL__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=30000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/mnt/LJH/XFM/NERProject/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-13 16:43:11 | INFO | train | [Graph] loading nodes from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-13 16:43:11 | INFO | train | [Graph] saving nodes to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-13 16:43:11 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-13 16:43:11 | INFO | train | [Graph] loading edges from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-13 16:44:23 | INFO | train | [Graph] saving edges to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-13 16:45:09 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-13 16:45:10 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-13 16:46:05 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-13 16:46:05 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-13 16:46:53 | INFO | train | Using char encoder (char ids):   [Train] total=583519 unk=0 ratio=0.0%  [Valid] total=71514 unk=2 ratio=0.0%  [Test] total=79342 unk=0 ratio=0.0%
2023-07-13 16:46:54 | INFO | train | Using word encoder (word ids):   [Train] total=139524 unk=515 ratio=0.37%  [Valid] total=17150 unk=64 ratio=0.37%  [Test] total=18720 unk=69 ratio=0.37%
2023-07-13 16:46:57 | INFO | train | Saving dir: /mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18 2023-07-13 16:46:57
2023-07-13 16:50:59 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/mnt/LJH/XFM/NERProject/spanCL__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=8, eval_max_sentences=1, max_length=250, sampling_processes=4, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/mnt/LJH/XFM/NERProject/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-13 16:50:59 | INFO | train | [Graph] loading nodes from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-13 16:50:59 | INFO | train | [Graph] saving nodes to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-13 16:50:59 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-13 16:50:59 | INFO | train | [Graph] loading edges from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-13 16:52:13 | INFO | train | [Graph] saving edges to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-13 16:53:00 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-13 16:53:01 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-13 16:53:59 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-13 16:53:59 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-13 16:54:50 | INFO | train | Using char encoder (char ids):   [Train] total=583519 unk=0 ratio=0.0%  [Valid] total=71514 unk=2 ratio=0.0%  [Test] total=79342 unk=0 ratio=0.0%
2023-07-13 16:54:51 | INFO | train | Using word encoder (word ids):   [Train] total=139524 unk=515 ratio=0.37%  [Valid] total=17150 unk=64 ratio=0.37%  [Test] total=18720 unk=69 ratio=0.37%
2023-07-13 16:54:54 | INFO | train | Saving dir: /mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18 2023-07-13 16:54:54
2023-07-13 16:56:45 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/mnt/LJH/XFM/NERProject/spanCL__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=8, eval_max_sentences=1, max_length=250, sampling_processes=2, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/mnt/LJH/XFM/NERProject/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-13 16:56:45 | INFO | train | [Graph] loading nodes from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-13 16:56:45 | INFO | train | [Graph] saving nodes to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-13 16:56:45 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-13 16:56:45 | INFO | train | [Graph] loading edges from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-13 16:58:00 | INFO | train | [Graph] saving edges to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-13 16:58:46 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-13 16:58:47 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-13 16:59:45 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-13 16:59:45 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-13 17:00:36 | INFO | train | Using char encoder (char ids):   [Train] total=583519 unk=0 ratio=0.0%  [Valid] total=71514 unk=2 ratio=0.0%  [Test] total=79342 unk=0 ratio=0.0%
2023-07-13 17:00:36 | INFO | train | Using word encoder (word ids):   [Train] total=139524 unk=515 ratio=0.37%  [Valid] total=17150 unk=64 ratio=0.37%  [Test] total=18720 unk=69 ratio=0.37%
2023-07-13 17:00:40 | INFO | train | Saving dir: /mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18 2023-07-13 17:00:40
2023-07-13 17:01:28 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/mnt/LJH/XFM/NERProject/spanCL__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=1, eval_max_sentences=1, max_length=250, sampling_processes=2, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/mnt/LJH/XFM/NERProject/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-13 17:01:29 | INFO | train | [Graph] loading nodes from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-13 17:01:29 | INFO | train | [Graph] saving nodes to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-13 17:01:29 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-13 17:01:29 | INFO | train | [Graph] loading edges from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-13 17:02:40 | INFO | train | [Graph] saving edges to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-13 17:03:26 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-13 17:03:27 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-13 17:04:22 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-13 17:04:22 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-13 17:05:12 | INFO | train | Using char encoder (char ids):   [Train] total=583519 unk=0 ratio=0.0%  [Valid] total=71514 unk=2 ratio=0.0%  [Test] total=79342 unk=0 ratio=0.0%
2023-07-13 17:05:12 | INFO | train | Using word encoder (word ids):   [Train] total=139524 unk=515 ratio=0.37%  [Valid] total=17150 unk=64 ratio=0.37%  [Test] total=18720 unk=69 ratio=0.37%
2023-07-13 17:05:15 | INFO | train | Saving dir: /mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18 2023-07-13 17:05:15
2023-07-13 17:27:03 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/mnt/LJH/XFM/NERProject/spanCL__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=2, eval_max_sentences=1, max_length=250, sampling_processes=2, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/mnt/LJH/XFM/NERProject/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-13 17:27:04 | INFO | train | [Graph] loading nodes from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-13 17:27:04 | INFO | train | [Graph] saving nodes to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-13 17:27:04 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-13 17:27:04 | INFO | train | [Graph] loading edges from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-13 17:28:15 | INFO | train | [Graph] saving edges to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-13 17:29:03 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-13 17:29:04 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-13 17:30:00 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-13 17:30:00 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-13 17:30:53 | INFO | train | Using char encoder (char ids):   [Train] total=583519 unk=0 ratio=0.0%  [Valid] total=71514 unk=2 ratio=0.0%  [Test] total=79342 unk=0 ratio=0.0%
2023-07-13 17:30:53 | INFO | train | Using word encoder (word ids):   [Train] total=139524 unk=515 ratio=0.37%  [Valid] total=17150 unk=64 ratio=0.37%  [Test] total=18720 unk=69 ratio=0.37%
2023-07-13 17:30:56 | INFO | train | Saving dir: /mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18 2023-07-13 17:30:56
2023-07-13 17:34:53 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/mnt/LJH/XFM/NERProject/spanCL__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=1, eval_max_sentences=1, max_length=250, sampling_processes=2, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=0, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/mnt/LJH/XFM/NERProject/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-13 17:34:53 | INFO | train | [Graph] loading nodes from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/nodes.json ...
2023-07-13 17:34:54 | INFO | train | [Graph] saving nodes to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/nodes.pkl ...
2023-07-13 17:34:54 | INFO | train | [Graph] entity-entity graph loads 10317 nodes.
2023-07-13 17:34:54 | INFO | train | [Graph] loading edges from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph/edges.json ...
2023-07-13 17:36:05 | INFO | train | [Graph] saving edges to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache/edges.pkl ...
2023-07-13 17:36:51 | INFO | train | [Graph] entity-entity graph loads 5629752 (one-way) edges.
2023-07-13 17:36:52 | INFO | train | [Graph] entity-entity graph keeps 30648 (bi-way) edges.
2023-07-13 17:37:49 | INFO | train | [Graph] span-entity graph loads 13842789 (one-way) edges.
2023-07-13 17:37:49 | INFO | train | [Graph] span-entity graph keeps 69420 (one-way) edges.
2023-07-13 17:38:40 | INFO | train | Using char encoder (char ids):   [Train] total=583519 unk=0 ratio=0.0%  [Valid] total=71514 unk=2 ratio=0.0%  [Test] total=79342 unk=0 ratio=0.0%
2023-07-13 17:38:40 | INFO | train | Using word encoder (word ids):   [Train] total=139524 unk=515 ratio=0.37%  [Valid] total=17150 unk=64 ratio=0.37%  [Test] total=18720 unk=69 ratio=0.37%
2023-07-13 17:38:44 | INFO | train | Saving dir: /mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18 2023-07-13 17:38:44
2023-07-13 17:44:27 | INFO | train | Namespace(seed=1, use_cpu=False, save_log_file='/mnt/LJH/XFM/NERProject/spanCL__results/ace04/nner_slg/trnn_41_18.pkl', save_best_result_file='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/best_results.txt', evaluate_per_update=-1, do_extra_eval=1, save_pred_dir='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18', LOGFILENAME='/mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18.log', LOGLEVEL='INFO', CUDA_VISIBLE_DEVICES=1, data_dir='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04', shuffle=0, max_tokens=99999, max_sentences=1, eval_max_sentences=1, max_length=250, sampling_processes=2, load_cache=0, save_cache=1, train_ratio=1, valid_ratio=1, test_ratio=1, max_n_word=122, max_ent_n_word=58, max_word_len=68, archi='nner_slg_ace04', use_char_encoder=1, use_word_encoder=1, use_lm_embed=1, use_size=1, char_embed_dim=30, char_hid_dim=50, word_embed_dim=100, cls_embed_dim=768, wc_lstm_hid_dim=200, sent_enc_dropout=0.1, lm_dim=768, wv_file='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.glove.6B.100d.txt', lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.bert_base_cased_flair.emb.pkl', ent_lm_emb_path='/mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/ACE04.ent_bert_base_cased_flair.emb.pkl', cased_char=0, cased_word=0, cased_lm=1, use_gcn=1, use_cls=0, debug=1, show_infer_speed=0, data_name='ace04', edge_weight_threshold=1.0, graph_neighbors=[3, 2], max_batch_nodes=3000, max_batch_edges=40000, concat_span_hid=1, use_graph_weight=False, graph_emb_method='mean', alpha=0.1, criterion='cross_entropy', lr_scheduler='linear_with_warmup', optimizer='adam', lr=2e-05, other_lr=0.001, clip_norm=5, clip_value=-1, sentence_average=True, update_freq=4, min_lr=1e-10, max_epoch=50, max_update=100000, max_no_incre_on_valid=50, print_at_update=False, load_checkpoint=False, checkpoint_path='checkpoints', save_dir='/mnt/LJH/XFM/NERProject/spanCL/__models/ace04/nner_slg', keep_last_epochs=-1, keep_last_updates=-1, dropout=0.01, neg_entity_count=100, max_span_size=8, size_embed_dim=25, gcn_dropout=0.1, gcn_norm_method='right', weight_decay=1e-08, adam_betas='(0.9, 0.999)', adam_eps=1e-08, warmup_steps=0.01, pretrained_model='bert-base-cased', do_lower_case=False, max_n_bpe=137, wc_lstm_layers=1, test_n_words=17822, num_rnn_layers=0, rnn_dropout=0, rnn_hidden_dim=0, bidirectional=False, rnn_type='lstm', gcn_layers=[425, 384], n_hop=2, n_neighbor=3, max_ee_graph_neighbors=2)
2023-07-13 17:44:28 | INFO | train | [Graph] loading nodes from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph-debug/nodes.json ...
2023-07-13 17:44:28 | INFO | train | [Graph] saving nodes to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache-debug/nodes.pkl ...
2023-07-13 17:44:28 | INFO | train | [Graph] entity-entity graph loads 182 nodes.
2023-07-13 17:44:28 | INFO | train | [Graph] loading edges from /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/Graph-debug/edges.json ...
2023-07-13 17:44:28 | INFO | train | [Graph] saving edges to /mnt/LJH/XFM/NERProject/spanCL/data/datasets/ace04/cache-debug/edges.pkl ...
2023-07-13 17:44:28 | INFO | train | [Graph] entity-entity graph loads 1848 (one-way) edges.
2023-07-13 17:44:28 | INFO | train | [Graph] entity-entity graph keeps 154 (bi-way) edges.
2023-07-13 17:44:28 | INFO | train | [Graph] span-entity graph loads 150399 (one-way) edges.
2023-07-13 17:44:28 | INFO | train | [Graph] span-entity graph keeps 277 (one-way) edges.
2023-07-13 17:44:39 | INFO | train | Using char encoder (char ids):   [Train] total=8149 unk=0 ratio=0.0%  [Valid] total=852 unk=0 ratio=0.0%  [Test] total=1186 unk=0 ratio=0.0%
2023-07-13 17:44:40 | INFO | train | Using word encoder (word ids):   [Train] total=1771 unk=20 ratio=1.13%  [Valid] total=169 unk=2 ratio=1.18%  [Test] total=255 unk=7 ratio=2.75%
2023-07-13 17:44:43 | INFO | train | Saving dir: /mnt/LJH/XFM/NERProject/spanCL/__results/ace04/nner_slg/41_18 2023-07-13 17:44:43
2023-07-13 17:44:53 | INFO | train | saving log: valid_1_16.json
2023-07-13 17:44:55 | INFO | train | saving log: test_1_16.json
2023-07-13 17:44:55 | INFO | jlogger | Epoch=1 upd=16/800 
[train] loss=116.5084 loss_span=71.0846 loss_node=454.2377 
[valid] loss=9.9196 loss_span=3.6624 loss_node=62.5717 p=43.75 r=17.95 f=25.45 
[test]  loss=4.8374 loss_span=3.0776 loss_node=17.5980 p=16.67 r=4.35 f=6.90 
lr=1.98e-05 gn=5.00 time=13s. 

2023-07-13 17:45:05 | INFO | train | saving log: valid_2_32.json
2023-07-13 17:45:07 | INFO | train | saving log: test_2_32.json
2023-07-13 17:45:07 | INFO | jlogger | Epoch=2 upd=32/800 
[train] loss=62.8972 loss_span=33.6540 loss_node=292.4315 
[valid] loss=8.1779 loss_span=3.1481 loss_node=50.2982 p=58.33 r=17.95 f=27.45 
[test]  loss=3.6732 loss_span=2.1560 loss_node=15.1722 p=25.00 r=4.35 f=7.41 
lr=1.94e-05 gn=5.00 time=11s. 

2023-07-13 17:45:17 | INFO | train | saving log: valid_3_48.json
2023-07-13 17:45:19 | INFO | train | saving log: test_3_48.json
2023-07-13 17:45:19 | INFO | jlogger | Epoch=3 upd=48/800 
[train] loss=47.4720 loss_span=24.3182 loss_node=231.5373 
[valid] loss=5.7777 loss_span=2.3111 loss_node=34.6661 p=58.33 r=17.95 f=27.45 
[test]  loss=2.8803 loss_span=1.8590 loss_node=10.2134 p=28.57 r=4.35 f=7.55 
lr=1.90e-05 gn=5.00 time=12s. 

2023-07-13 17:45:28 | INFO | train | saving log: valid_4_64.json
2023-07-13 17:45:30 | INFO | train | saving log: test_4_64.json
2023-07-13 17:45:30 | INFO | jlogger | Epoch=4 upd=64/800 
[train] loss=31.9429 loss_span=17.9545 loss_node=139.8838 
[valid] loss=4.2335 loss_span=2.1335 loss_node=20.9995 p=58.33 r=17.95 f=27.45 
[test]  loss=2.5296 loss_span=1.8747 loss_node=6.5490 p=28.57 r=4.35 f=7.55 
lr=1.86e-05 gn=5.00 time=11s. 

2023-07-13 17:45:39 | INFO | train | saving log: valid_5_80.json
2023-07-13 17:45:41 | INFO | train | saving log: test_5_80.json
2023-07-13 17:45:41 | INFO | jlogger | Epoch=5 upd=80/800 
[train] loss=22.8646 loss_span=14.2402 loss_node=86.2450 
[valid] loss=3.1579 loss_span=1.7768 loss_node=13.8104 p=58.33 r=17.95 f=27.45 
[test]  loss=2.2879 loss_span=1.7819 loss_node=5.0606 p=25.00 r=2.17 f=4.00 
lr=1.82e-05 gn=3.65 time=11s. 

2023-07-13 17:45:50 | INFO | train | saving log: valid_6_96.json
2023-07-13 17:45:53 | INFO | train | saving log: test_6_96.json
2023-07-13 17:45:53 | INFO | jlogger | Epoch=6 upd=96/800 
[train] loss=19.3605 loss_span=12.4896 loss_node=68.7082 
[valid] loss=2.5997 loss_span=1.6484 loss_node=9.5136 p=50.00 r=12.82 f=20.41 
[test]  loss=2.0750 loss_span=1.6577 loss_node=4.1738 p=50.00 r=4.35 f=8.00 
lr=1.78e-05 gn=2.89 time=11s. 

2023-07-13 17:46:02 | INFO | train | saving log: valid_7_112.json
2023-07-13 17:46:04 | INFO | train | saving log: test_7_112.json
2023-07-13 17:46:04 | INFO | jlogger | Epoch=7 upd=112/800 
[train] loss=16.0844 loss_span=10.6015 loss_node=54.8284 
[valid] loss=2.1377 loss_span=1.3755 loss_node=7.6220 p=54.55 r=15.38 f=24.00 
[test]  loss=1.9358 loss_span=1.5414 loss_node=3.9446 p=40.00 r=4.35 f=7.84 
lr=1.74e-05 gn=4.29 time=11s. 

2023-07-13 17:46:13 | INFO | train | saving log: valid_8_128.json
2023-07-13 17:46:16 | INFO | train | saving log: test_8_128.json
2023-07-13 17:46:16 | INFO | jlogger | Epoch=8 upd=128/800 
[train] loss=14.5288 loss_span=9.1389 loss_node=53.8991 
[valid] loss=1.8379 loss_span=1.1930 loss_node=6.4485 p=63.64 r=17.95 f=28.00 
[test]  loss=1.8112 loss_span=1.4267 loss_node=3.8453 p=25.00 r=4.35 f=7.41 
lr=1.70e-05 gn=2.66 time=12s. 

2023-07-13 17:46:25 | INFO | train | saving log: valid_9_144.json
2023-07-13 17:46:27 | INFO | train | saving log: test_9_144.json
2023-07-13 17:46:27 | INFO | jlogger | Epoch=9 upd=144/800 
[train] loss=13.8155 loss_span=8.5786 loss_node=52.3684 
[valid] loss=1.7954 loss_span=1.2221 loss_node=5.7337 p=85.71 r=15.38 f=26.09 
[test]  loss=1.8771 loss_span=1.5102 loss_node=3.6688 p=33.33 r=2.17 f=4.08 
lr=1.66e-05 gn=5.00 time=11s. 

2023-07-13 17:46:37 | INFO | train | saving log: valid_10_160.json
2023-07-13 17:46:39 | INFO | train | saving log: test_10_160.json
2023-07-13 17:46:39 | INFO | jlogger | Epoch=10 upd=160/800 
[train] loss=11.8673 loss_span=7.1015 loss_node=47.6579 
[valid] loss=1.5884 loss_span=1.0386 loss_node=5.4975 p=57.14 r=20.51 f=30.19 
[test]  loss=1.6528 loss_span=1.2720 loss_node=3.8079 p=20.00 r=2.17 f=3.92 
lr=1.62e-05 gn=2.81 time=12s. 

2023-07-13 17:46:48 | INFO | train | saving log: valid_11_176.json
2023-07-13 17:46:50 | INFO | train | saving log: test_11_176.json
2023-07-13 17:46:50 | INFO | jlogger | Epoch=11 upd=176/800 
[train] loss=11.2894 loss_span=6.3287 loss_node=49.6072 
[valid] loss=1.6666 loss_span=1.1890 loss_node=4.7759 p=44.00 r=28.21 f=34.38 
[test]  loss=1.7451 loss_span=1.3815 loss_node=3.6359 p=23.08 r=6.52 f=10.17 
lr=1.58e-05 gn=3.51 time=11s. 

2023-07-13 17:47:00 | INFO | train | saving log: valid_12_192.json
2023-07-13 17:47:02 | INFO | train | saving log: test_12_192.json
2023-07-13 17:47:02 | INFO | jlogger | Epoch=12 upd=192/800 
[train] loss=10.1395 loss_span=5.6843 loss_node=44.5516 
[valid] loss=1.6472 loss_span=1.2113 loss_node=4.3591 p=27.91 r=30.77 f=29.27 
[test]  loss=1.6702 loss_span=1.3003 loss_node=3.6994 p=17.24 r=10.87 f=13.33 
lr=1.54e-05 gn=3.32 time=11s. 

2023-07-13 17:47:11 | INFO | train | saving log: valid_13_208.json
2023-07-13 17:47:13 | INFO | train | saving log: test_13_208.json
2023-07-13 17:47:13 | INFO | jlogger | Epoch=13 upd=208/800 
[train] loss=9.9438 loss_span=5.5838 loss_node=43.6003 
[valid] loss=1.5040 loss_span=1.0947 loss_node=4.0929 p=44.83 r=33.33 f=38.24 
[test]  loss=1.5945 loss_span=1.2281 loss_node=3.6641 p=41.67 r=10.87 f=17.24 
lr=1.49e-05 gn=2.13 time=11s. 

2023-07-13 17:47:23 | INFO | train | saving log: valid_14_224.json
2023-07-13 17:47:25 | INFO | train | saving log: test_14_224.json
2023-07-13 17:47:25 | INFO | jlogger | Epoch=14 upd=224/800 
[train] loss=9.2567 loss_span=4.9438 loss_node=43.1286 
[valid] loss=1.4250 loss_span=1.0377 loss_node=3.8731 p=41.18 r=35.90 f=38.36 
[test]  loss=1.6267 loss_span=1.2678 loss_node=3.5890 p=33.33 r=13.04 f=18.75 
lr=1.45e-05 gn=2.25 time=11s. 

2023-07-13 17:47:34 | INFO | train | saving log: valid_15_240.json
2023-07-13 17:47:36 | INFO | train | saving log: test_15_240.json
2023-07-13 17:47:36 | INFO | jlogger | Epoch=15 upd=240/800 
[train] loss=8.6418 loss_span=4.4812 loss_node=41.6057 
[valid] loss=1.4648 loss_span=1.0938 loss_node=3.7103 p=25.42 r=38.46 f=30.61 
[test]  loss=1.6563 loss_span=1.3054 loss_node=3.5088 p=25.93 r=30.43 f=28.00 
lr=1.41e-05 gn=4.76 time=11s. 

2023-07-13 17:47:45 | INFO | train | saving log: valid_16_256.json
2023-07-13 17:47:47 | INFO | train | saving log: test_16_256.json
2023-07-13 17:47:47 | INFO | jlogger | Epoch=16 upd=256/800 
[train] loss=8.1029 loss_span=4.1664 loss_node=39.3651 
[valid] loss=1.4609 loss_span=1.0987 loss_node=3.6225 p=23.88 r=41.03 f=30.19 
[test]  loss=1.7281 loss_span=1.3759 loss_node=3.5218 p=23.53 r=34.78 f=28.07 
lr=1.37e-05 gn=3.42 time=11s. 

2023-07-13 17:47:57 | INFO | train | saving log: valid_17_272.json
2023-07-13 17:47:59 | INFO | train | saving log: test_17_272.json
2023-07-13 17:47:59 | INFO | jlogger | Epoch=17 upd=272/800 
[train] loss=8.9433 loss_span=5.1104 loss_node=38.3285 
[valid] loss=1.2410 loss_span=0.8781 loss_node=3.6295 p=42.11 r=41.03 f=41.56 
[test]  loss=1.5314 loss_span=1.1755 loss_node=3.5596 p=51.72 r=32.61 f=40.00 
lr=1.33e-05 gn=2.52 time=11s. 

2023-07-13 17:48:07 | INFO | train | saving log: valid_18_288.json
2023-07-13 17:48:10 | INFO | train | saving log: test_18_288.json
2023-07-13 17:48:10 | INFO | jlogger | Epoch=18 upd=288/800 
[train] loss=8.6840 loss_span=4.3499 loss_node=43.3417 
[valid] loss=1.2162 loss_span=0.8690 loss_node=3.4721 p=66.67 r=35.90 f=46.67 
[test]  loss=1.5552 loss_span=1.2122 loss_node=3.4296 p=30.00 r=6.52 f=10.71 
lr=1.29e-05 gn=3.26 time=10s. 

2023-07-13 17:48:19 | INFO | train | saving log: valid_19_304.json
2023-07-13 17:48:21 | INFO | train | saving log: test_19_304.json
2023-07-13 17:48:21 | INFO | jlogger | Epoch=19 upd=304/800 
[train] loss=8.2935 loss_span=4.2621 loss_node=40.3135 
[valid] loss=1.2897 loss_span=0.9505 loss_node=3.3920 p=75.00 r=30.77 f=43.64 
[test]  loss=1.6861 loss_span=1.3427 loss_node=3.4340 p=37.50 r=6.52 f=11.11 
lr=1.25e-05 gn=1.97 time=12s. 

2023-07-13 17:48:30 | INFO | train | saving log: valid_20_320.json
2023-07-13 17:48:33 | INFO | train | saving log: test_20_320.json
2023-07-13 17:48:33 | INFO | jlogger | Epoch=20 upd=320/800 
[train] loss=7.7931 loss_span=3.9959 loss_node=37.9723 
[valid] loss=1.1314 loss_span=0.8047 loss_node=3.2670 p=73.68 r=35.90 f=48.28 
[test]  loss=1.7172 loss_span=1.3788 loss_node=3.3845 p=46.15 r=13.04 f=20.34 
lr=1.21e-05 gn=2.90 time=11s. 

2023-07-13 17:48:42 | INFO | train | saving log: valid_21_336.json
2023-07-13 17:48:44 | INFO | train | saving log: test_21_336.json
2023-07-13 17:48:44 | INFO | jlogger | Epoch=21 upd=336/800 
[train] loss=7.2525 loss_span=3.4231 loss_node=38.2938 
[valid] loss=1.1924 loss_span=0.8738 loss_node=3.1852 p=65.00 r=33.33 f=44.07 
[test]  loss=1.5989 loss_span=1.2601 loss_node=3.3884 p=58.33 r=15.22 f=24.14 
lr=1.17e-05 gn=2.50 time=11s. 

2023-07-13 17:48:53 | INFO | train | saving log: valid_22_352.json
2023-07-13 17:48:55 | INFO | train | saving log: test_22_352.json
2023-07-13 17:48:55 | INFO | jlogger | Epoch=22 upd=352/800 
[train] loss=6.6416 loss_span=2.9387 loss_node=37.0285 
[valid] loss=1.1028 loss_span=0.7941 loss_node=3.0864 p=50.00 r=38.46 f=43.48 
[test]  loss=1.5449 loss_span=1.2112 loss_node=3.3373 p=42.31 r=23.91 f=30.56 
lr=1.13e-05 gn=1.10 time=11s. 

2023-07-13 17:49:05 | INFO | train | saving log: valid_23_368.json
2023-07-13 17:49:07 | INFO | train | saving log: test_23_368.json
2023-07-13 17:49:07 | INFO | jlogger | Epoch=23 upd=368/800 
[train] loss=6.4568 loss_span=2.7180 loss_node=37.3885 
[valid] loss=1.1417 loss_span=0.8367 loss_node=3.0497 p=43.75 r=35.90 f=39.44 
[test]  loss=1.5451 loss_span=1.2151 loss_node=3.2993 p=43.48 r=21.74 f=28.99 
lr=1.09e-05 gn=1.56 time=11s. 

2023-07-13 17:49:16 | INFO | train | saving log: valid_24_384.json
2023-07-13 17:49:18 | INFO | train | saving log: test_24_384.json
2023-07-13 17:49:18 | INFO | jlogger | Epoch=24 upd=384/800 
[train] loss=6.1713 loss_span=2.4789 loss_node=36.9234 
[valid] loss=1.0935 loss_span=0.7960 loss_node=2.9757 p=51.72 r=38.46 f=44.12 
[test]  loss=1.6396 loss_span=1.3132 loss_node=3.2644 p=47.62 r=21.74 f=29.85 
lr=1.05e-05 gn=1.93 time=11s. 

2023-07-13 17:49:28 | INFO | train | saving log: valid_25_400.json
2023-07-13 17:49:30 | INFO | train | saving log: test_25_400.json
2023-07-13 17:49:30 | INFO | jlogger | Epoch=25 upd=400/800 
[train] loss=5.9458 loss_span=2.5220 loss_node=34.2377 
[valid] loss=1.1450 loss_span=0.8515 loss_node=2.9352 p=71.43 r=38.46 f=50.00 
[test]  loss=1.6881 loss_span=1.3590 loss_node=3.2910 p=40.00 r=8.70 f=14.29 
lr=1.01e-05 gn=2.05 time=11s. 

2023-07-13 17:49:39 | INFO | train | saving log: valid_26_416.json
2023-07-13 17:49:41 | INFO | train | saving log: test_26_416.json
2023-07-13 17:49:41 | INFO | jlogger | Epoch=26 upd=416/800 
[train] loss=5.9459 loss_span=2.4646 loss_node=34.8136 
[valid] loss=0.9797 loss_span=0.6987 loss_node=2.8102 p=64.00 r=41.03 f=50.00 
[test]  loss=1.5488 loss_span=1.2323 loss_node=3.1651 p=50.00 r=19.57 f=28.12 
lr=9.70e-06 gn=1.35 time=11s. 

2023-07-13 17:49:51 | INFO | train | saving log: valid_27_432.json
2023-07-13 17:49:53 | INFO | train | saving log: test_27_432.json
2023-07-13 17:49:53 | INFO | jlogger | Epoch=27 upd=432/800 
[train] loss=5.6778 loss_span=2.3099 loss_node=33.6788 
[valid] loss=1.0006 loss_span=0.7258 loss_node=2.7486 p=55.17 r=41.03 f=47.06 
[test]  loss=1.5616 loss_span=1.2463 loss_node=3.1533 p=37.50 r=26.09 f=30.77 
lr=9.29e-06 gn=2.81 time=11s. 

2023-07-13 17:50:02 | INFO | train | saving log: valid_28_448.json
2023-07-13 17:50:04 | INFO | train | saving log: test_28_448.json
2023-07-13 17:50:04 | INFO | jlogger | Epoch=28 upd=448/800 
[train] loss=5.4825 loss_span=2.0471 loss_node=34.3542 
[valid] loss=0.9635 loss_span=0.6910 loss_node=2.7253 p=59.26 r=41.03 f=48.48 
[test]  loss=1.5611 loss_span=1.2436 loss_node=3.1756 p=45.83 r=23.91 f=31.43 
lr=8.89e-06 gn=1.67 time=11s. 

2023-07-13 17:50:14 | INFO | train | saving log: valid_29_464.json
2023-07-13 17:50:16 | INFO | train | saving log: test_29_464.json
2023-07-13 17:50:16 | INFO | jlogger | Epoch=29 upd=464/800 
[train] loss=5.2013 loss_span=1.9382 loss_node=32.6312 
[valid] loss=1.0010 loss_span=0.7339 loss_node=2.6710 p=72.73 r=41.03 f=52.46 
[test]  loss=1.6278 loss_span=1.3113 loss_node=3.1653 p=52.17 r=26.09 f=34.78 
lr=8.48e-06 gn=1.26 time=11s. 

2023-07-13 17:50:25 | INFO | train | saving log: valid_30_480.json
2023-07-13 17:50:27 | INFO | train | saving log: test_30_480.json
2023-07-13 17:50:27 | INFO | jlogger | Epoch=30 upd=480/800 
[train] loss=5.1526 loss_span=1.9567 loss_node=31.9590 
[valid] loss=0.9774 loss_span=0.7148 loss_node=2.6256 p=64.00 r=41.03 f=50.00 
[test]  loss=1.5860 loss_span=1.2689 loss_node=3.1704 p=45.45 r=21.74 f=29.41 
lr=8.08e-06 gn=1.78 time=11s. 

2023-07-13 17:50:36 | INFO | train | saving log: valid_31_496.json
2023-07-13 17:50:38 | INFO | train | saving log: test_31_496.json
2023-07-13 17:50:38 | INFO | jlogger | Epoch=31 upd=496/800 
[train] loss=4.9991 loss_span=1.8119 loss_node=31.8717 
[valid] loss=0.9839 loss_span=0.7279 loss_node=2.5601 p=57.14 r=41.03 f=47.76 
[test]  loss=1.6089 loss_span=1.2978 loss_node=3.1108 p=46.15 r=26.09 f=33.33 
lr=7.68e-06 gn=1.56 time=11s. 

2023-07-13 17:50:48 | INFO | train | saving log: valid_32_512.json
2023-07-13 17:50:50 | INFO | train | saving log: test_32_512.json
2023-07-13 17:50:50 | INFO | jlogger | Epoch=32 upd=512/800 
[train] loss=4.9991 loss_span=1.7661 loss_node=32.3299 
[valid] loss=0.9733 loss_span=0.7248 loss_node=2.4856 p=55.56 r=38.46 f=45.45 
[test]  loss=1.5130 loss_span=1.2101 loss_node=3.0291 p=47.62 r=21.74 f=29.85 
lr=7.27e-06 gn=1.30 time=11s. 

2023-07-13 17:50:59 | INFO | train | saving log: valid_33_528.json
2023-07-13 17:51:01 | INFO | train | saving log: test_33_528.json
2023-07-13 17:51:01 | INFO | jlogger | Epoch=33 upd=528/800 
[train] loss=4.9272 loss_span=1.7644 loss_node=31.6277 
[valid] loss=0.9412 loss_span=0.6990 loss_node=2.4227 p=65.22 r=38.46 f=48.39 
[test]  loss=1.5925 loss_span=1.2933 loss_node=2.9913 p=45.45 r=21.74 f=29.41 
lr=6.87e-06 gn=1.44 time=11s. 

2023-07-13 17:51:11 | INFO | train | saving log: valid_34_544.json
2023-07-13 17:51:13 | INFO | train | saving log: test_34_544.json
2023-07-13 17:51:13 | INFO | jlogger | Epoch=34 upd=544/800 
[train] loss=4.8564 loss_span=1.6669 loss_node=31.8949 
[valid] loss=0.8881 loss_span=0.6455 loss_node=2.4260 p=56.67 r=43.59 f=49.28 
[test]  loss=1.5741 loss_span=1.2722 loss_node=3.0194 p=46.15 r=26.09 f=33.33 
lr=6.46e-06 gn=1.32 time=11s. 

2023-07-13 17:51:22 | INFO | train | saving log: valid_35_560.json
2023-07-13 17:51:24 | INFO | train | saving log: test_35_560.json
2023-07-13 17:51:24 | INFO | jlogger | Epoch=35 upd=560/800 
[train] loss=4.4076 loss_span=1.5346 loss_node=28.7304 
[valid] loss=0.9096 loss_span=0.6667 loss_node=2.4287 p=58.62 r=43.59 f=50.00 
[test]  loss=1.5625 loss_span=1.2581 loss_node=3.0439 p=54.17 r=28.26 f=37.14 
lr=6.06e-06 gn=1.21 time=11s. 

2023-07-13 17:51:34 | INFO | train | saving log: valid_36_576.json
2023-07-13 17:51:36 | INFO | train | saving log: test_36_576.json
2023-07-13 17:51:36 | INFO | jlogger | Epoch=36 upd=576/800 
[train] loss=4.4874 loss_span=1.4808 loss_node=30.0653 
[valid] loss=0.8764 loss_span=0.6399 loss_node=2.3655 p=60.00 r=46.15 f=52.17 
[test]  loss=1.5283 loss_span=1.2321 loss_node=2.9623 p=50.00 r=28.26 f=36.11 
lr=5.66e-06 gn=0.99 time=11s. 

2023-07-13 17:51:45 | INFO | train | saving log: valid_37_592.json
2023-07-13 17:51:47 | INFO | train | saving log: test_37_592.json
2023-07-13 17:51:47 | INFO | jlogger | Epoch=37 upd=592/800 
[train] loss=4.4520 loss_span=1.4484 loss_node=30.0361 
[valid] loss=0.8996 loss_span=0.6667 loss_node=2.3282 p=62.50 r=38.46 f=47.62 
[test]  loss=1.5770 loss_span=1.2824 loss_node=2.9462 p=50.00 r=23.91 f=32.35 
lr=5.25e-06 gn=1.83 time=11s. 

2023-07-13 17:51:56 | INFO | train | saving log: valid_38_608.json
2023-07-13 17:51:59 | INFO | train | saving log: test_38_608.json
2023-07-13 17:51:59 | INFO | jlogger | Epoch=38 upd=608/800 
[train] loss=4.3904 loss_span=1.4178 loss_node=29.7257 
[valid] loss=0.8645 loss_span=0.6345 loss_node=2.2999 p=65.38 r=43.59 f=52.31 
[test]  loss=1.5401 loss_span=1.2502 loss_node=2.8993 p=47.62 r=21.74 f=29.85 
lr=4.85e-06 gn=1.16 time=11s. 

2023-07-13 17:52:08 | INFO | train | saving log: valid_39_624.json
2023-07-13 17:52:10 | INFO | train | saving log: test_39_624.json
2023-07-13 17:52:10 | INFO | jlogger | Epoch=39 upd=624/800 
[train] loss=4.2909 loss_span=1.3369 loss_node=29.5401 
[valid] loss=0.8512 loss_span=0.6232 loss_node=2.2796 p=70.83 r=43.59 f=53.97 
[test]  loss=1.5708 loss_span=1.2827 loss_node=2.8813 p=45.45 r=21.74 f=29.41 
lr=4.44e-06 gn=1.32 time=11s. 

2023-07-13 17:52:19 | INFO | train | saving log: valid_40_640.json
2023-07-13 17:52:21 | INFO | train | saving log: test_40_640.json
2023-07-13 17:52:21 | INFO | jlogger | Epoch=40 upd=640/800 
[train] loss=4.2779 loss_span=1.3445 loss_node=29.3346 
[valid] loss=0.8473 loss_span=0.6213 loss_node=2.2591 p=70.83 r=43.59 f=53.97 
[test]  loss=1.5825 loss_span=1.2954 loss_node=2.8707 p=47.62 r=21.74 f=29.85 
lr=4.04e-06 gn=1.12 time=11s. 

2023-07-13 17:52:31 | INFO | train | saving log: valid_41_656.json
2023-07-13 17:52:33 | INFO | train | saving log: test_41_656.json
2023-07-13 17:52:33 | INFO | jlogger | Epoch=41 upd=656/800 
[train] loss=4.2049 loss_span=1.2993 loss_node=29.0566 
[valid] loss=0.8970 loss_span=0.6743 loss_node=2.2266 p=76.19 r=41.03 f=53.33 
[test]  loss=1.6235 loss_span=1.3395 loss_node=2.8400 p=50.00 r=19.57 f=28.12 
lr=3.64e-06 gn=1.15 time=11s. 

2023-07-13 17:52:42 | INFO | train | saving log: valid_42_672.json
2023-07-13 17:52:45 | INFO | train | saving log: test_42_672.json
2023-07-13 17:52:45 | INFO | jlogger | Epoch=42 upd=672/800 
[train] loss=3.9550 loss_span=1.2540 loss_node=27.0109 
[valid] loss=0.8513 loss_span=0.6305 loss_node=2.2082 p=73.91 r=43.59 f=54.84 
[test]  loss=1.6275 loss_span=1.3419 loss_node=2.8562 p=50.00 r=23.91 f=32.35 
lr=3.23e-06 gn=0.96 time=11s. 

2023-07-13 17:52:54 | INFO | train | saving log: valid_43_688.json
2023-07-13 17:52:56 | INFO | train | saving log: test_43_688.json
2023-07-13 17:52:56 | INFO | jlogger | Epoch=43 upd=688/800 
[train] loss=3.7927 loss_span=1.2089 loss_node=25.8373 
[valid] loss=0.8495 loss_span=0.6291 loss_node=2.2041 p=78.26 r=46.15 f=58.06 
[test]  loss=1.6674 loss_span=1.3798 loss_node=2.8761 p=47.62 r=21.74 f=29.85 
lr=2.83e-06 gn=1.15 time=11s. 

2023-07-13 17:53:05 | INFO | train | saving log: valid_44_704.json
2023-07-13 17:53:07 | INFO | train | saving log: test_44_704.json
2023-07-13 17:53:07 | INFO | jlogger | Epoch=44 upd=704/800 
[train] loss=3.9503 loss_span=1.1511 loss_node=27.9921 
[valid] loss=0.8363 loss_span=0.6167 loss_node=2.1952 p=75.00 r=46.15 f=57.14 
[test]  loss=1.6673 loss_span=1.3809 loss_node=2.8641 p=48.00 r=26.09 f=33.80 
lr=2.42e-06 gn=1.61 time=11s. 

2023-07-13 17:53:17 | INFO | train | saving log: valid_45_720.json
2023-07-13 17:53:19 | INFO | train | saving log: test_45_720.json
2023-07-13 17:53:19 | INFO | jlogger | Epoch=45 upd=720/800 
[train] loss=4.0014 loss_span=1.2189 loss_node=27.8245 
[valid] loss=0.8471 loss_span=0.6291 loss_node=2.1797 p=75.00 r=46.15 f=57.14 
[test]  loss=1.6218 loss_span=1.3375 loss_node=2.8429 p=50.00 r=26.09 f=34.29 
lr=2.02e-06 gn=1.07 time=11s. 

2023-07-13 17:53:28 | INFO | train | saving log: valid_46_736.json
2023-07-13 17:53:31 | INFO | train | saving log: test_46_736.json
2023-07-13 17:53:31 | INFO | jlogger | Epoch=46 upd=736/800 
[train] loss=3.9181 loss_span=1.1901 loss_node=27.2805 
[valid] loss=0.8388 loss_span=0.6226 loss_node=2.1626 p=78.26 r=46.15 f=58.06 
[test]  loss=1.6184 loss_span=1.3356 loss_node=2.8286 p=47.83 r=23.91 f=31.88 
lr=1.62e-06 gn=1.96 time=11s. 

2023-07-13 17:53:40 | INFO | train | saving log: valid_47_752.json
2023-07-13 17:53:42 | INFO | train | saving log: test_47_752.json
2023-07-13 17:53:42 | INFO | jlogger | Epoch=47 upd=752/800 
[train] loss=3.7792 loss_span=1.1871 loss_node=25.9207 
[valid] loss=0.8433 loss_span=0.6281 loss_node=2.1519 p=78.26 r=46.15 f=58.06 
[test]  loss=1.6241 loss_span=1.3423 loss_node=2.8177 p=47.83 r=23.91 f=31.88 
lr=1.21e-06 gn=1.82 time=11s. 

2023-07-13 17:53:51 | INFO | train | saving log: valid_48_768.json
2023-07-13 17:53:53 | INFO | train | saving log: test_48_768.json
2023-07-13 17:53:53 | INFO | jlogger | Epoch=48 upd=768/800 
[train] loss=3.8726 loss_span=1.1549 loss_node=27.1767 
[valid] loss=0.8550 loss_span=0.6397 loss_node=2.1524 p=81.82 r=46.15 f=59.02 
[test]  loss=1.6618 loss_span=1.3793 loss_node=2.8256 p=47.37 r=19.57 f=27.69 
lr=8.08e-07 gn=1.35 time=11s. 

2023-07-13 17:54:03 | INFO | train | saving log: valid_49_784.json
2023-07-13 17:54:05 | INFO | train | saving log: test_49_784.json
2023-07-13 17:54:05 | INFO | jlogger | Epoch=49 upd=784/800 
[train] loss=3.9963 loss_span=1.1858 loss_node=28.1048 
[valid] loss=0.8477 loss_span=0.6326 loss_node=2.1516 p=78.26 r=46.15 f=58.06 
[test]  loss=1.6582 loss_span=1.3755 loss_node=2.8265 p=52.38 r=23.91 f=32.84 
lr=4.04e-07 gn=1.34 time=11s. 

2023-07-13 17:54:14 | INFO | train | saving log: valid_50_800.json
2023-07-13 17:54:16 | INFO | train | saving log: test_50_800.json
2023-07-13 17:54:16 | INFO | jlogger | Epoch=50 upd=800/800 
[train] loss=4.0435 loss_span=1.2133 loss_node=28.3023 
[valid] loss=0.8440 loss_span=0.6290 loss_node=2.1500 p=78.26 r=46.15 f=58.06 
[test]  loss=1.6496 loss_span=1.3674 loss_node=2.8221 p=45.83 r=23.91 f=31.43 
lr=0.00e+00 gn=2.08 time=11s. 

2023-07-13 17:54:16 | INFO | jlogger | 
Best valid scores: p=81.82 r=46.15 f=59.02 
Best test scores by valid: p=47.37 r=19.57 f=27.69 
Best test scores: p=51.72 r=32.61 f=40.0 

